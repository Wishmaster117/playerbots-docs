{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Playerbots Documentation","text":"<p>This site hosts the architecture documentation for the <code>mod-playerbots</code> module. The content is built progressively to keep it approachable for new contributors.</p>"},{"location":"#start-here","title":"Start here","text":"<ul> <li>Module map &amp; glossary</li> <li>High-level architecture</li> <li>Major execution flows</li> <li>AI architecture</li> <li>Gameplay-specific systems</li> <li>Data &amp; configuration architecture</li> <li>Azerothcore Integration</li> <li>Azerothcore Changelogs</li> <li>Azerothcore Dev Only</li> <li>DIFF 2026/02/05</li> <li>Roadmap</li> </ul>"},{"location":"ai-architecture/","title":"3 \u2014 AI architecture","text":"<p>This page focuses on the AI building blocks used across the module: context, engine, strategies, actions, triggers, and values.</p>"},{"location":"ai-architecture/#31-context-engine","title":"3.1 \u2014 Context &amp; Engine","text":"<p>Role - The AI context (<code>AiObjectContext</code>) is the registry/factory for strategies, actions, triggers, and values. - The engine (<code>Engine</code>) owns the strategy set, builds trigger/action queues, and executes the next action.</p> <p>Key APIs / classes - <code>AiFactory::createAiObjectContext</code> selects a class\u2011specific context (e.g., warrior, priest) or the base context. - <code>Engine</code> exposes <code>addStrategy</code>, <code>ChangeStrategy</code>, <code>DoNextAction</code>, and executes actions from the queue. - Contexts and factories live under <code>src/Bot/Engine/</code> and <code>src/Bot/Factory/</code>.</p> <p>Managed data - Shared context lists for strategies/actions/triggers/values inside <code>AiObjectContext</code>. - Runtime engine state: strategies, triggers, multipliers, action queue, last action.</p> <p>Extension points - Add a new strategy class and register it in the appropriate <code>AiObjectContext</code> or a class\u2011specific context. - Add a new action/trigger/value and expose it via the context creators. - Override or customize default strategy composition via <code>AiFactory</code> (combat/non\u2011combat/dead engines).</p> <pre><code>flowchart TD\n  A[\"AiFactory::createAiObjectContext\"] --&gt; B[\"AiObjectContext\"]\n  B --&gt; C[\"Strategy / Trigger / Action / Value creators\"]\n  A --&gt; D[\"Engine (combat / non-combat / dead)\"]\n  D --&gt; E[\"Strategy set\"]\n  E --&gt; F[\"TriggerNodes -&gt; NextAction\"]\n  F --&gt; G[\"ActionNode -&gt; Action::Execute\"]</code></pre>"},{"location":"ai-architecture/#32-strategies","title":"3.2 \u2014 Strategies","text":"<p>Role - A strategy is a bundle of triggers, default actions, and multipliers that define behavior in a context (combat, non\u2011combat, raid, etc.).</p> <p>Key APIs / classes - <code>Strategy</code> defines <code>getDefaultActions</code>, <code>InitTriggers</code>, <code>InitMultipliers</code>, and <code>getName</code>. - Strategies have a type mask (e.g., combat, tank, heal) and can inject action node factories.</p> <p>Managed data - The strategy\u2019s own <code>actionNodeFactories</code> list. - Trigger lists populated at init time by <code>InitTriggers</code>.</p> <p>Extension points - Create a new <code>Strategy</code> subclass and register it in a context. - Add action node factories for composite actions (prerequisites, alternatives, continuers).</p>"},{"location":"ai-architecture/#33-actions","title":"3.3 \u2014 Actions","text":"<p>Role - Actions are executable behaviors (cast, move, attack, loot, travel, etc.). - ActionNode links an action name to prerequisites, alternatives, and continuers.</p> <p>Key APIs / classes - <code>Action::Execute</code>, <code>isPossible</code>, <code>isUseful</code>, and relevance metadata. - <code>ActionNode</code> holds a name and lists of <code>NextAction</code> entries. - <code>NextAction</code> is the engine\u2019s action candidate with a relevance score.</p> <p>Managed data - Action relevance and the action node dependencies (prereq/alt/continue).</p> <p>Extension points - Add a new <code>Action</code> subclass and register it in the context. - Use <code>ActionNode</code> factories to provide fallback paths and preconditions.</p>"},{"location":"ai-architecture/#34-triggers","title":"3.4 \u2014 Triggers","text":"<p>Role - Triggers are conditions that decide when actions should be queued. - TriggerNode wraps a trigger name and a list of <code>NextAction</code> handlers.</p> <p>Key APIs / classes - <code>Trigger::IsActive</code> + optional <code>getHandlers</code>. - <code>TriggerNode</code> merges static handlers with <code>trigger-&gt;getHandlers()</code>.</p> <p>Managed data - Trigger check interval and last check time (for throttling).</p> <p>Extension points - Implement a new <code>Trigger</code> and register it in the context. - Add trigger nodes in a strategy\u2019s <code>InitTriggers</code> method.</p>"},{"location":"ai-architecture/#35-values","title":"3.5 \u2014 Values","text":"<p>Role - Values are cached data providers used by triggers/actions (targets, distances, statuses, etc.).</p> <p>Key APIs / classes - <code>Value&lt;T&gt;</code> interface and <code>CalculatedValue&lt;T&gt;</code> with a check interval. - <code>UntypedValue</code> base for context storage and serialization.</p> <p>Managed data - Cached value + last check time, which reduces recomputation.</p> <p>Extension points - Implement a new <code>CalculatedValue&lt;T&gt;</code> and register it in the context. - Use existing values in triggers/actions before creating new ones.</p>"},{"location":"ai-architecture/#36-concrete-example-fury-warrior-combat-behavior","title":"3.6 \u2014 Concrete example (Fury warrior combat behavior)","text":"<p>Below is a real example showing how a strategy assembles behavior using actions, triggers, and priorities.</p> <p>1) Strategy provides action nodes - <code>FuryWarriorStrategy</code> adds an action\u2011node factory that defines composite actions like <code>charge</code>, <code>pummel</code>, and <code>intercept</code> with alternatives/prerequisites.</p> <p>2) Strategy defines default actions - The default action list includes <code>bloodthirst</code>, <code>whirlwind</code>, <code>sunder armor</code>, <code>execute</code>, and <code>melee</code> with descending relevance.</p> <p>3) Strategy registers triggers - Triggers like enemy out of melee enqueue <code>charge</code>, and pummel triggers enqueue interrupts with <code>ACTION_INTERRUPT</code> relevance.</p> <p>4) Engine executes - The engine merges trigger handlers + default actions and executes the highest\u2011relevance action.</p> <pre><code>sequenceDiagram\n  participant Strat as \"FuryWarriorStrategy\"\n  participant Trig as \"TriggerNode\"\n  participant Eng as \"Engine\"\n  participant Act as \"Action\"\n\n  Strat-&gt;&gt;Eng: \"InitTriggers + getDefaultActions\"\n  Trig--&gt;&gt;Eng: \"NextAction(\\\"charge\\\", ACTION_MOVE + 9)\"\n  Eng-&gt;&gt;Act: \"Execute(\\\"charge\\\")\"</code></pre> <p>Relevant code references - Strategy base: <code>Strategy</code> class and action priorities. - Action primitives: <code>Action</code>, <code>ActionNode</code>, <code>NextAction</code>. - Trigger primitives: <code>Trigger</code>, <code>TriggerNode</code>. - Example strategy: <code>FuryWarriorStrategy</code> (action nodes, default actions, triggers).</p>"},{"location":"core-changes-playerbots-changelog/","title":"Core changes for mod\u2011playerbots (Changelog)","text":"<p>This is a compact changelog of AzerothCore core modifications required by the <code>Playerbot</code> core branch to support mod\u2011playerbots.</p>"},{"location":"core-changes-playerbots-changelog/#build-cmake","title":"Build / CMake","text":"<ul> <li>Detect <code>mod-playerbots</code> module and define <code>MOD_PLAYERBOTS</code> for relevant targets.</li> <li>Link <code>modules</code> with <code>mysql</code> when playerbots is present.</li> </ul>"},{"location":"core-changes-playerbots-changelog/#databases","title":"Databases","text":"<ul> <li>Add a new DB pool (guarded by <code>MOD_PLAYERBOTS</code>):</li> <li><code>DatabaseWorkerPool&lt;PlayerbotsDatabaseConnection&gt; PlayerbotsDatabase</code></li> <li>Extend DB forward declarations and alias types for prepared statements/transactions/query holders.</li> <li>Extend <code>DatabaseLoader</code>:</li> <li>new flag <code>DATABASE_PLAYERBOTS</code></li> <li><code>DATABASE_MASK_ALL</code> includes playerbots (when enabled)</li> <li>add <code>SetUpdateFlags()</code> to OR\u2011in flags</li> <li>add template instantiation for <code>AddDatabase&lt;PlayerbotsDatabaseConnection&gt;()</code></li> </ul>"},{"location":"core-changes-playerbots-changelog/#db-lifecycle-hooks-databasescript","title":"DB lifecycle hooks (DatabaseScript)","text":"<p>Add new <code>DatabaseScript</code> hook points + <code>ScriptMgr</code> forwarders:</p> <ul> <li><code>OnDatabasesLoading()</code> (bool gate)</li> <li><code>OnDatabasesKeepAlive()</code></li> <li><code>OnDatabasesClosing()</code></li> <li><code>OnDatabaseWarnAboutSyncQueries(bool)</code></li> <li><code>OnDatabaseSelectIndexLogout(Player*, uint32&amp;, uint32&amp;)</code></li> <li><code>OnDatabaseGetDBRevision(std::string&amp;)</code></li> </ul> <p>Integrate in worldserver:</p> <ul> <li>Call <code>OnDatabasesLoading()</code> after DB loader load and abort startup on failure.</li> <li>Call <code>OnDatabasesClosing()</code> on shutdown.</li> <li>Forward sync\u2011query warning toggles into scripts.</li> </ul>"},{"location":"core-changes-playerbots-changelog/#logging","title":"Logging","text":"<ul> <li>Add <code>Appender.Playerbots</code> and <code>Logger.playerbots</code> (dedicated <code>Playerbots.log</code>).</li> </ul>"},{"location":"core-changes-playerbots-changelog/#scripting-playerbotscript-family","title":"Scripting: PlayerbotScript family","text":"<ul> <li>Add <code>PlayerbotScript</code> type and registration.</li> <li>Add <code>ScriptMgr</code> dispatch methods:</li> <li>LFG queue check, kill task check, petition account check</li> <li>bot update cadence, per\u2011session update</li> <li>bot logout (single + all)</li> <li>packet\u2011sent callback</li> </ul>"},{"location":"core-changes-playerbots-changelog/#networking-sessions","title":"Networking / Sessions","text":"<ul> <li><code>WorldSession</code>:</li> <li>add <code>isBot</code> constructor parameter + <code>_isBot</code> flag</li> <li>set address to <code>\"bot\"</code> for bot sessions without real socket address</li> <li>add <code>IsBot()</code>, <code>SetAddress(...)</code>, expose packet queue accessor</li> <li>guard against <code>NULL_OPCODE</code> in <code>SendPacket()</code> (log + return)</li> <li>call <code>OnPlayerbotPacketSent(...)</code> on outgoing packets</li> <li><code>WorldSession::Update()</code>:</li> <li>call <code>ScriptMgr::OnPacketReceived(...)</code> for inbound packets behind <code>MOD_PLAYERBOTS</code></li> <li><code>WorldSessionMgr::KickAll()</code>:</li> <li>call <code>OnPlayerbotLogoutBots()</code> behind <code>MOD_PLAYERBOTS</code></li> </ul>"},{"location":"core-changes-playerbots-changelog/#player-hooks","title":"Player hooks","text":"<ul> <li>Add <code>PlayerScript::OnPlayerAfterUpdate(...)</code></li> <li>Add additional chat hook enums:</li> <li><code>OnChat</code>, <code>OnChatWithReceiver</code>, <code>OnChatWithGroup</code>, <code>OnChatWithGuild</code>, <code>OnChatWithChannel</code></li> </ul>"},{"location":"core-changes-playerbots-changelog/#movement","title":"Movement","text":"<ul> <li><code>PointMovementGenerator</code>:</li> <li>support inverted spline orientation via <code>SetOrientationInversed()</code> when <code>_reverseOrientation</code> is set</li> </ul>"},{"location":"core-changes-playerbots-developer/","title":"Core integration notes (Developer-only)","text":"<p>This page is aimed at developers maintaining the Playerbot core fork or working on low\u2011level integration between AzerothCore and mod\u2011playerbots.</p> <p>It focuses on entry points, contracts, and gotchas.</p>"},{"location":"core-changes-playerbots-developer/#compiletime-contract-mod_playerbots","title":"Compile\u2011time contract: <code>MOD_PLAYERBOTS</code>","text":"<p>All core changes are intended to be behind a single feature gate:</p> <ul> <li><code>#ifdef MOD_PLAYERBOTS</code></li> </ul> <p>The build system defines it automatically when the <code>mod-playerbots</code> module is detected during module configuration, and propagates it to the targets the module depends on.</p> <p>Rule: do not introduce additional compile flags for playerbots unless strictly necessary\u2014keep the fork easy to rebase.</p>"},{"location":"core-changes-playerbots-developer/#database-contract","title":"Database contract","text":""},{"location":"core-changes-playerbots-developer/#global-accessor","title":"Global accessor","text":"<p>When <code>MOD_PLAYERBOTS</code> is enabled, core exposes:</p> <ul> <li><code>PlayerbotsDatabase</code> (<code>DatabaseWorkerPool&lt;PlayerbotsDatabaseConnection&gt;</code>)</li> </ul> <p>The module expects the usual AzerothCore DB patterns to work: - prepared statements - transactions - async query holders - update flags / revision reporting</p>"},{"location":"core-changes-playerbots-developer/#loader-contract","title":"Loader contract","text":"<p><code>DatabaseLoader</code> is extended to allow adding a new DB \u201ckind\u201d:</p> <ul> <li><code>DATABASE_PLAYERBOTS</code> flag</li> <li><code>DATABASE_MASK_ALL</code> includes it when enabled</li> <li><code>SetUpdateFlags()</code> allows OR\u2011ing flags (instead of requiring const at ctor)</li> </ul> <p>Implementation guideline: keep all playerbots database behavior module\u2011driven via scripts (see DatabaseScript hooks), avoid hardcoding playerbots SQL logic in core.</p>"},{"location":"core-changes-playerbots-developer/#db-lifecycle-hooks-databasescript","title":"DB lifecycle hooks: <code>DatabaseScript</code>","text":""},{"location":"core-changes-playerbots-developer/#startup-gating","title":"Startup gating","text":"<p><code>bool DatabaseScript::OnDatabasesLoading()</code> allows the module to refuse startup (e.g., missing schema, incompatible revision).</p> <p>Core calls it right after DB loader <code>Load()</code> succeeds: - If it returns <code>false</code>, worldserver startup aborts.</p>"},{"location":"core-changes-playerbots-developer/#shutdown-keepalive","title":"Shutdown / keepalive","text":"<ul> <li><code>OnDatabasesClosing()</code> is called during <code>StopDB()</code>.</li> <li><code>OnDatabasesKeepAlive()</code> exists as an extension point (module can implement ping/maintenance if needed).</li> </ul>"},{"location":"core-changes-playerbots-developer/#sync-query-warnings-bridging","title":"Sync query warnings bridging","text":"<p>Core forwards <code>WarnAboutSyncQueries(true/false)</code> toggles into: - <code>OnDatabaseWarnAboutSyncQueries(bool apply)</code></p> <p>This keeps \u201cDB warning mode\u201d consistent if the module does DB work during the world loop.</p>"},{"location":"core-changes-playerbots-developer/#playerbotscript-moduleside-control-plane","title":"PlayerbotScript: module\u2011side control plane","text":"<p>A new <code>PlayerbotScript</code> family exists specifically so playerbots logic stays in the module.</p> <p>Key dispatch points in <code>ScriptMgr</code>:</p> <ul> <li><code>OnPlayerbotUpdate(diff)</code> and <code>OnPlayerbotUpdateSessions(player)</code></li> <li><code>OnPlayerbotLogout(player)</code> and <code>OnPlayerbotLogoutBots()</code></li> <li><code>OnPlayerbotPacketSent(player, packet)</code></li> <li>Sanity checks: LFG queue, kill tasks, petitions, \u201cupdates to send\u201d gating</li> </ul> <p>Design intent: core provides event timing + minimal plumbing; module owns behavior.</p>"},{"location":"core-changes-playerbots-developer/#packet-visibility-serverscriptonpacketreceived","title":"Packet visibility: <code>ServerScript::OnPacketReceived</code>","text":"<p>Core adds:</p> <ul> <li><code>virtual void ServerScript::OnPacketReceived(WorldSession*, WorldPacket const&amp;)</code></li> </ul> <p>and calls it from <code>WorldSession::Update()</code> behind <code>MOD_PLAYERBOTS</code>, after handlers run.</p> <p>Important behavior: - ScriptMgr makes a copy of the packet for dispatch. - This is a \u201ctap\u201d for observability and module logic; do not mutate session queue inside this callback unless you fully understand ordering.</p>"},{"location":"core-changes-playerbots-developer/#worldsession-bot-sessions","title":"WorldSession bot sessions","text":""},{"location":"core-changes-playerbots-developer/#bot-flag-and-address-semantics","title":"Bot flag and address semantics","text":"<p><code>WorldSession</code> ctor adds <code>isBot</code>: - stored in <code>_isBot</code> - if <code>isBot</code> and no standard address, <code>m_Address = \"bot\"</code></p> <p>Added API: - <code>bool IsBot() const</code> - <code>void SetAddress(std::string const&amp;)</code> - <code>LockedQueue&lt;WorldPacket*&gt;&amp; GetPacketQueue()</code></p> <p>Why it matters: the module can run sessions that are not backed by a normal socket, while still participating in the update loop.</p>"},{"location":"core-changes-playerbots-developer/#outgoing-packet-hook-null-opcode-safety","title":"Outgoing packet hook + NULL opcode safety","text":"<p><code>WorldSession::SendPacket()</code> now: - refuses <code>NULL_OPCODE</code> (logs and returns) - calls <code>ScriptMgr::OnPlayerbotPacketSent(GetPlayer(), packet)</code> before sending</p> <p>This is useful for: - bot client emulation / state sync - debugging bot\u2011visible opcodes</p>"},{"location":"core-changes-playerbots-developer/#worldsessionmgr-shutdown-hook","title":"WorldSessionMgr shutdown hook","text":"<p><code>WorldSessionMgr::KickAll()</code> calls: - <code>ScriptMgr::OnPlayerbotLogoutBots()</code> (behind <code>MOD_PLAYERBOTS</code>)</p> <p>This ensures bot cleanup happens on global kicks / shutdown sequences.</p>"},{"location":"core-changes-playerbots-developer/#playerscript-additions","title":"PlayerScript additions","text":"<ul> <li><code>OnPlayerAfterUpdate(Player*, uint32)</code> hook</li> <li>chat hook enums:</li> <li><code>OnChat</code></li> <li><code>OnChatWithReceiver</code></li> <li><code>OnChatWithGroup</code></li> <li><code>OnChatWithGuild</code></li> <li><code>OnChatWithChannel</code></li> </ul> <p>Typical use in playerbots: - parse/route chat commands - update bot AI after core player update</p>"},{"location":"core-changes-playerbots-developer/#movement-integration-reverse-spline-orientation","title":"Movement integration: reverse spline orientation","text":"<p><code>PointMovementGenerator::DoInitialize()</code>: - if <code>_reverseOrientation</code> is set, call <code>MoveSplineInit::SetOrientationInversed()</code></p> <p>This is intentionally surgical: no rewrite of pathing, just an extra orientation mode used by bots.</p>"},{"location":"core-changes-playerbots-developer/#rebase-discipline-recommended","title":"Rebase discipline (recommended)","text":"<p>To keep the fork maintainable:</p> <ol> <li>Keep all playerbots\u2011specific core changes either:</li> <li>behind <code>MOD_PLAYERBOTS</code>, or</li> <li>in new minimal hook functions that are no\u2011ops by default.</li> <li>Avoid touching unrelated gameplay logic.</li> <li>Prefer adding hook points (ScriptMgr / ScriptDefines) over embedding module logic into core.</li> <li>When adding new entry points, document:</li> <li>call site</li> <li>expected invariants (thread, timing, player existence)</li> <li>failure behavior (abort startup, ignore, etc.)</li> </ol>"},{"location":"core-changes-playerbots-developer/#quick-reference-core-touchpoints","title":"Quick reference: core touchpoints","text":"<ul> <li>Build:</li> <li>module detection \u2192 <code>MOD_PLAYERBOTS</code> define</li> <li><code>modules</code> links against <code>mysql</code></li> <li>DB:</li> <li><code>PlayerbotsDatabase</code> pool</li> <li><code>DatabaseLoader</code> flags + <code>SetUpdateFlags</code></li> <li>Scripts:</li> <li><code>DatabaseScript</code> lifecycle extensions</li> <li><code>PlayerbotScript</code> family</li> <li><code>ServerScript::OnPacketReceived</code></li> <li><code>PlayerScript</code> after\u2011update + chat hooks</li> <li>Sessions:</li> <li><code>WorldSession</code> bot flag / packet hooks</li> <li><code>WorldSessionMgr::KickAll()</code> logout\u2011bots hook</li> <li>Movement:</li> <li>reversed orientation in <code>PointMovementGenerator</code></li> </ul>"},{"location":"core-changes-playerbots/","title":"AzerothCore core changes required by mod\u2011playerbots","text":"<p>This page documents the AzerothCore (WotLK 3.3.5a) changes that were introduced in the <code>Playerbot</code> core branch to support mod\u2011playerbots.</p> <p>Scope: this is not a full playerbots feature doc. It only covers the core\u2011level integration points the module relies on.</p>"},{"location":"core-changes-playerbots/#why-a-core-fork-is-needed","title":"Why a core fork is needed","text":"<p>AzerothCore modules usually integrate cleanly using the public API surface (scripts, hooks, DB, etc.). mod\u2011playerbots needs additional integration points that are not available in upstream core:</p> <ul> <li>A dedicated Playerbots database pool (separate connection, prepared statements, updates, revision reporting).</li> <li>Extra ScriptMgr hook points (database lifecycle, bot session lifecycle, packet visibility).</li> <li>A way to tag sessions as \u201cbot\u201d and intercept packets for bots without breaking normal players.</li> <li>Minor movement/spline adjustments used by bot movement logic.</li> </ul>"},{"location":"core-changes-playerbots/#highlevel-architecture","title":"High\u2011level architecture","text":"<pre><code>flowchart LR\n  subgraph Worldserver\n    A[StartDB / StopDB] --&gt; B[ScriptMgr: DatabaseScript hooks]\n    C[WorldUpdateLoop] --&gt; B\n    D[WorldSession::Update] --&gt; E[ServerScript::OnPacketReceived]\n    F[WorldSession::SendPacket] --&gt; G[PlayerbotScript::OnPlayerbotPacketSent]\n  end\n\n  subgraph Databases\n    L[(Login DB)]\n    CH[(Character DB)]\n    W[(World DB)]\n    PB[(Playerbots DB)]\n  end\n\n  A --&gt; L\n  A --&gt; CH\n  A --&gt; W\n  A --&gt; PB</code></pre>"},{"location":"core-changes-playerbots/#build-system-integration-mod_playerbots","title":"Build system integration (MOD_PLAYERBOTS)","text":"<p>The core build is extended so that when the mod\u2011playerbots module is present, the build defines <code>MOD_PLAYERBOTS</code> and links the mysql target into modules.</p> <p>What changes - Detect presence of mod\u2011playerbots in the module list. - Add <code>-DMOD_PLAYERBOTS</code> compile option to relevant targets. - Ensure modules link against mysql (needed by additional DB wiring).</p> <p>This means core code can safely compile the playerbots\u2011specific additions behind <code>#ifdef MOD_PLAYERBOTS</code> without impacting vanilla setups.</p>"},{"location":"core-changes-playerbots/#playerbots-database-new-db-pool-and-loader-support","title":"Playerbots database: new DB pool and loader support","text":"<p>mod\u2011playerbots uses its own schema (commonly <code>acore_playerbots</code>) and needs an independent connection pool.</p> <p>What changes - Add <code>DatabaseWorkerPool&lt;PlayerbotsDatabaseConnection&gt; PlayerbotsDatabase</code> (guarded by <code>MOD_PLAYERBOTS</code>). - Forward declarations, aliases, and helpers for:   - <code>PlayerbotsDatabasePreparedStatement</code>   - <code>PlayerbotsDatabaseTransaction</code>   - <code>PlayerbotsDatabaseQueryHolder</code> - Extend <code>DatabaseLoader</code> with:   - a new update flag <code>DATABASE_PLAYERBOTS</code>   - <code>DATABASE_MASK_ALL</code> including playerbots when enabled   - <code>SetUpdateFlags()</code> to allow extending flags dynamically   - explicit template instantiation for <code>AddDatabase&lt;PlayerbotsDatabaseConnection&gt;()</code></p> <pre><code>classDiagram\n  class DatabaseWorkerPool~T~ {\n    +Open()\n    +Close()\n    +PrepareStatements()\n  }\n\n  class PlayerbotsDatabaseConnection\n  class WorldDatabaseConnection\n  class CharacterDatabaseConnection\n  class LoginDatabaseConnection\n\n  DatabaseWorkerPool~PlayerbotsDatabaseConnection~ --&gt; PlayerbotsDatabaseConnection\n  DatabaseWorkerPool~WorldDatabaseConnection~ --&gt; WorldDatabaseConnection\n  DatabaseWorkerPool~CharacterDatabaseConnection~ --&gt; CharacterDatabaseConnection\n  DatabaseWorkerPool~LoginDatabaseConnection~ --&gt; LoginDatabaseConnection</code></pre> <p>Developer note All playerbots DB wiring is compiled only when <code>MOD_PLAYERBOTS</code> is defined, so upstream behavior stays unchanged.</p>"},{"location":"core-changes-playerbots/#database-lifecycle-hooks-new-databasescript-api","title":"Database lifecycle hooks (new DatabaseScript API)","text":"<p>To integrate the extra DB and keep DB lifecycle logic module\u2011driven, new hooks are added:</p> <p>New DatabaseScript virtual methods - <code>bool OnDatabasesLoading()</code> (gate startup; return false to abort) - <code>void OnDatabasesKeepAlive()</code> - <code>void OnDatabasesClosing()</code> - <code>void OnDatabaseWarnAboutSyncQueries(bool apply)</code> - <code>void OnDatabaseSelectIndexLogout(Player* player, uint32&amp; statementIndex, uint32&amp; statementParam)</code> - <code>void OnDatabaseGetDBRevision(std::string&amp; revision)</code></p> <p>Worldserver integration - After <code>loader.Load()</code> succeeds, call <code>sScriptMgr-&gt;OnDatabasesLoading()</code> and abort startup if it returns false. - On shutdown (<code>StopDB()</code>), call <code>sScriptMgr-&gt;OnDatabasesClosing()</code>. - When toggling sync\u2011query warnings in the world loop, forward <code>apply=true/false</code> to scripts.</p> <pre><code>sequenceDiagram\n  participant WS as worldserver\n  participant DL as DatabaseLoader\n  participant SM as ScriptMgr\n  participant DS as DatabaseScript (module)\n\n  WS-&gt;&gt;DL: Load()\n  DL--&gt;&gt;WS: success\n  WS-&gt;&gt;SM: OnDatabasesLoading()\n  SM-&gt;&gt;DS: OnDatabasesLoading()\n  DS--&gt;&gt;SM: true/false\n  SM--&gt;&gt;WS: true/false\n  alt false\n    WS--&gt;&gt;WS: abort startup\n  else true\n    WS--&gt;&gt;WS: continue normal startup\n  end</code></pre>"},{"location":"core-changes-playerbots/#logging-dedicated-playerbots-logger","title":"Logging: dedicated playerbots logger","text":"<p><code>worldserver.conf.dist</code> is extended to provide: - <code>Appender.Playerbots=... Playerbots.log</code> - <code>Logger.playerbots=... Console Playerbots</code></p> <p>This allows the module to emit high\u2011volume bot logs without polluting <code>Server.log</code>.</p>"},{"location":"core-changes-playerbots/#new-playerbotscript-hook-family","title":"New PlayerbotScript hook family","text":"<p>A dedicated script type is added for playerbots lifecycle and checks:</p> <p>ScriptMgr additions (PlayerbotScript) - <code>bool OnPlayerbotCheckLFGQueue(lfg::Lfg5Guids const&amp; guidsList)</code> - <code>void OnPlayerbotCheckKillTask(Player* player, Unit* victim)</code> - <code>void OnPlayerbotCheckPetitionAccount(Player* player, bool&amp; found)</code> - <code>bool OnPlayerbotCheckUpdatesToSend(Player* player)</code> - <code>void OnPlayerbotPacketSent(Player* player, WorldPacket const* packet)</code> - <code>void OnPlayerbotUpdate(uint32 diff)</code> - <code>void OnPlayerbotUpdateSessions(Player* player)</code> - <code>void OnPlayerbotLogout(Player* player)</code> - <code>void OnPlayerbotLogoutBots()</code></p> <p>A new file introduces the script registration boilerplate: - <code>src/server/game/Scripting/ScriptDefines/PlayerbotsScript.cpp</code></p> <pre><code>flowchart TB\n  P[Playerbot module] --&gt;|implements| S[PlayerbotScript]\n  S --&gt; M[ScriptMgr]\n  M --&gt;|called from core loop / session / sendpacket| C[Core integration points]</code></pre>"},{"location":"core-changes-playerbots/#serverscript-packet-visibility-onpacketreceived","title":"ServerScript: packet visibility (OnPacketReceived)","text":"<p>To let modules observe inbound packets (for bot control, debug, filtering, etc.), <code>ServerScript</code> is extended:</p> <p>What changes - New virtual: <code>void OnPacketReceived(WorldSession* session, WorldPacket const&amp; packet)</code> - <code>ScriptMgr::OnPacketReceived()</code> copies the packet and forwards to scripts. - <code>WorldSession::Update()</code> calls <code>sScriptMgr-&gt;OnPacketReceived(this, *packet)</code> behind <code>#ifdef MOD_PLAYERBOTS</code>.</p> <p>This stays opt\u2011in for modules and avoids changing the existing <code>CanPacketReceive()</code> contract.</p>"},{"location":"core-changes-playerbots/#worldsession-changes-botaware-sessions-extra-safety","title":"WorldSession changes: bot\u2011aware sessions + extra safety","text":"<p>Bot flag - <code>WorldSession</code> constructor gains a <code>bool isBot</code> parameter and stores it in <code>_isBot</code>. - If the session is a bot and not a real socket session, address is set to <code>\"bot\"</code>. - Added:   - <code>bool IsBot() const</code>   - <code>void SetAddress(std::string const&amp; address)</code>   - <code>LockedQueue&lt;WorldPacket*&gt;&amp; GetPacketQueue()</code> (exposed for module\u2011side session control)</p> <p>SendPacket instrumentation &amp; safety - If <code>packet-&gt;GetOpcode() == NULL_OPCODE</code>, log an error and return (prevents silent bad packets). - Call <code>sScriptMgr-&gt;OnPlayerbotPacketSent(GetPlayer(), packet)</code> before sending.</p>"},{"location":"core-changes-playerbots/#worldsessionmgr-shutdown-hook","title":"WorldSessionMgr shutdown hook","text":"<p>On <code>KickAll()</code> (including offline sessions), call: - <code>sScriptMgr-&gt;OnPlayerbotLogoutBots()</code> behind <code>#ifdef MOD_PLAYERBOTS</code>.</p>"},{"location":"core-changes-playerbots/#player-update-and-chat-hooks-playerscript","title":"Player update and chat hooks (PlayerScript)","text":"<p>Additional <code>PlayerScript</code> hooks are introduced: - <code>OnPlayerAfterUpdate(Player*, uint32)</code> - Chat\u2011related hooks:   - <code>OnChat</code>   - <code>OnChatWithReceiver</code>   - <code>OnChatWithGroup</code>   - <code>OnChatWithGuild</code>   - <code>OnChatWithChannel</code></p> <p>These allow bots to integrate with chat parsing / command routing and post\u2011update logic.</p>"},{"location":"core-changes-playerbots/#movement-reverse-spline-orientation-support","title":"Movement: reverse spline orientation support","text":"<p><code>PointMovementGenerator&lt;T&gt;::DoInitialize()</code> is extended: - If <code>_reverseOrientation</code> is set, <code>MoveSplineInit::SetOrientationInversed()</code> is called.</p> <p>This is used by playerbots movement behaviors that must invert orientation without rewriting spline logic.</p>"},{"location":"core-changes-playerbots/#quick-what-depends-on-what-map","title":"Quick \u201cWhat depends on what?\u201d map","text":"<pre><code>graph LR\n  A[MOD_PLAYERBOTS define] --&gt; B[Playerbots DB pool]\n  A --&gt; C[PlayerbotScript hooks]\n  A --&gt; D[WorldSession bot flag]\n  A --&gt; E[OnPacketReceived plumbing]\n  B --&gt; F[Module DB updates &amp; revision]\n  C --&gt; G[Bot lifecycle, updates, logout]\n  D --&gt; H[Bot sessions &amp; packet queues]</code></pre>"},{"location":"core-changes-playerbots/#operational-checklist-server-owner","title":"Operational checklist (server owner)","text":"<ul> <li>Use the Playerbot core branch (or apply the equivalent patch\u2011set).</li> <li>Build with the module enabled so <code>MOD_PLAYERBOTS</code> gets defined.</li> <li>Configure the playerbots DB connection (commonly <code>acore_playerbots</code>).</li> <li>Ensure <code>Logger.playerbots</code> and <code>Appender.Playerbots</code> are present (or add them).</li> <li>Apply playerbots DB updates (module provides SQL updates).</li> <li>Start worldserver and confirm:</li> <li>Playerbots DB loads and revision is reported (if implemented by the module).</li> <li>Playerbots log file is created.</li> </ul>"},{"location":"data-configs-architecture/","title":"5 \u2014 Data &amp; configuration architecture","text":"<p>Deliverable: a complete mapping of configs &amp; data (config file, DB tables, runtime caches/state).</p> <p>This page describes where data lives and how it is loaded for the playerbots module.</p>"},{"location":"data-configs-architecture/#51-playerbotsconf-and-key-variables","title":"5.1 \u2014 <code>playerbots.conf</code> and key variables","text":"<p>Primary file - <code>conf/playerbots.conf.dist</code> (copied to <code>playerbots.conf</code> by the server admin).</p> <p>Key configuration areas (high\u2011level) - Enablement &amp; random bots   - <code>AiPlayerbot.Enabled</code>   - <code>AiPlayerbot.RandomBotAutologin</code>   - <code>AiPlayerbot.MinRandomBots</code> / <code>AiPlayerbot.MaxRandomBots</code>   - <code>AiPlayerbot.DisabledWithoutRealPlayer</code> + login/logout delays - Player\u2011controlled bots   - <code>AiPlayerbot.MaxAddedBots</code>   - <code>AiPlayerbot.AllowAccountBots</code>, <code>AiPlayerbot.AllowGuildBots</code>, <code>AiPlayerbot.AllowTrustedAccountBots</code>   - <code>AiPlayerbot.AddClassCommand</code> + <code>AiPlayerbot.AddClassAccountPoolSize</code> - Behavior &amp; timing   - Timers, distances, thresholds, combat and strategy sections   - Random bot strategies, RPG strategy, and teleport sections</p> <p>Notes - The file is large and categorized; keep edits within the correct section. - Configuration is loaded once on world initialization (<code>PlayerbotAIConfig</code>).</p>"},{"location":"data-configs-architecture/#52-database-tables-used-by-the-module","title":"5.2 \u2014 Database tables used by the module","text":"<p>Tables are shipped in <code>data/sql/*/base/</code> and updated in <code>data/sql/playerbots/updates/</code>.</p>"},{"location":"data-configs-architecture/#playerbots-module-database-datasqlplayerbotsbase","title":"Playerbots module database (<code>data/sql/playerbots/base/</code>)","text":"<p>Core data &amp; state - <code>playerbots_random_bots</code> - <code>playerbots_db_store</code> - <code>playerbots_custom_strategy</code></p> <p>Accounts &amp; permissions - <code>playerbots_account_type</code> - <code>playerbots_account_keys</code> - <code>playerbots_account_links</code></p> <p>Speech / text - <code>ai_playerbot_texts</code> - <code>ai_playerbot_texts_chance</code> - <code>playerbots_speech</code> - <code>playerbots_speech_probability</code></p> <p>Travel &amp; movement - <code>playerbots_travelnode</code> - <code>playerbots_travelnode_path</code> - <code>playerbots_travelnode_link</code> - <code>playerbots_tele_cache</code></p> <p>Items &amp; gear - <code>playerbots_item_info_cache</code> - <code>playerbots_rnditem_cache</code> - <code>playerbots_rarity_cache</code> - <code>playerbots_enchants</code> - <code>playerbots_equip_cache</code> - <code>playerbots_preferred_mounts</code> - <code>playerbots_weightscales</code> - <code>playerbots_weightscale_data</code></p> <p>Dungeon suggestions - <code>playerbots_dungeon_suggestion_definition</code> - <code>playerbots_dungeon_suggestion_abbrevation</code> - <code>playerbots_dungeon_suggestion_strategy</code></p> <p>Guild tasks - <code>playerbots_guild_tasks</code></p>"},{"location":"data-configs-architecture/#characters-database-datasqlcharactersbase","title":"Characters database (<code>data/sql/characters/base/</code>)","text":"<ul> <li><code>playerbots_names</code></li> <li><code>playerbots_guild_names</code></li> <li><code>playerbots_arena_team_names</code></li> </ul>"},{"location":"data-configs-architecture/#world-database-datasqlworldbase","title":"World database (<code>data/sql/world/base/</code>)","text":"<ul> <li><code>playerbots_rpg_races</code></li> </ul>"},{"location":"data-configs-architecture/#53-runtime-data-caches-flags-transient-state","title":"5.3 \u2014 Runtime data (caches, flags, transient state)","text":"<p>Random bot manager caches - <code>BattlegroundData</code>, <code>VisualBots</code>, <code>Supporters</code>, <code>LfgDungeons</code> - <code>BattleMastersCache</code>, <code>eventCache</code> - Travel/teleport caches: <code>locsPerLevelCache</code>, <code>allianceStarterPerLevelCache</code>, <code>hordeStarterPerLevelCache</code>,   <code>bankerLocsPerLevelCache</code>, <code>zone2LevelBracket</code>, <code>rpgLocsCacheLevel</code></p> <p>Transient state - Bot session queues and login throttling timers - <code>currentBots</code>, <code>players</code>, and in\u2011memory bot maps</p> <p>Why it matters - These caches reduce DB cost but must be refreshed carefully to avoid stale behavior. - Use existing managers (<code>RandomPlayerbotMgr</code>, <code>TravelMgr</code>) rather than duplicating cache logic.</p> <pre><code>flowchart TD\n  A[\"playerbots.conf\"] --&gt; B[\"PlayerbotAIConfig\"]\n  B --&gt; C[\"AiFactory / Managers\"]\n  C --&gt; D[\"RandomPlayerbotMgr caches\"]\n  C --&gt; E[\"DB tables (playerbots / characters / world)\"]</code></pre>"},{"location":"diff/","title":"DIFF 2026/02/05","text":""},{"location":"diff/#full-diff","title":"Full diff","text":"<pre><code>diff --git a/.github/README.md b/.github/README.md\nindex 3a9e654d621858..9956881550a4d7 100644\n--- a/.github/README.md\n+++ b/.github/README.md\n@@ -82,7 +82,8 @@ You can check the [authors](https://github.com/azerothcore/azerothcore-wotlk/blo\n\n ## License\n\n-- The AzerothCore source code is released under the [GNU GPL v2](https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html)\n+- The new AzerothCore source components are released under the [GNU AGPL v3](https://www.gnu.org/licenses/agpl-3.0.en.html)\n+- The old sources based on MaNGOS/TrinityCore are released under the [GNU GPL v2](https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html)\n\n It's important to note that AzerothCore is not an official Blizzard Entertainment product, and it is not affiliated with or endorsed by World of Warcraft or Blizzard Entertainment. AzerothCore does not in any case sponsor nor support illegal public servers. If you use this project to run an illegal public server and not for testing and learning it is your own personal choice.\n\ndiff --git a/.github/workflows/codestyle.yml b/.github/workflows/codestyle.yml\nindex 643593a0c2107b..4fc3f97efabf07 100644\n--- a/.github/workflows/codestyle.yml\n+++ b/.github/workflows/codestyle.yml\n@@ -14,7 +14,7 @@ jobs:\n   triage:\n     runs-on: ubuntu-latest\n     name: C++\n-    if: github.repository == 'azerothcore/azerothcore-wotlk' &amp;&amp; !github.event.pull_request.draft\n+    if: github.repository == 'mod-playerbots/azerothcore-wotlk' &amp;&amp; !github.event.pull_request.draft\n     steps:\n       - uses: actions/checkout@v4\n       - name: Setup python\ndiff --git a/.github/workflows/core-build-nopch.yml b/.github/workflows/core-build-nopch.yml\nindex 56f0a6a2d835ac..98eb1f20767469 100644\n--- a/.github/workflows/core-build-nopch.yml\n+++ b/.github/workflows/core-build-nopch.yml\n@@ -44,7 +44,7 @@ jobs:\n               CXX: g++-14\n     runs-on: ${{ matrix.os }}\n     name: ${{ matrix.os }}-${{ matrix.compiler.CC }}-nopch\n-    if: github.repository == 'azerothcore/azerothcore-wotlk' &amp;&amp; !github.event.pull_request.draft\n+    if: github.repository == 'mod-playerbots/azerothcore-wotlk' &amp;&amp; !github.event.pull_request.draft\n     steps:\n       - uses: actions/checkout@v4\n       - uses: ./.github/actions/linux-build\ndiff --git a/.github/workflows/core-build-pch.yml b/.github/workflows/core-build-pch.yml\nindex 3ac8cc6fdcd490..ad07eaf2817590 100644\n--- a/.github/workflows/core-build-pch.yml\n+++ b/.github/workflows/core-build-pch.yml\n@@ -39,8 +39,10 @@ jobs:\n               CC: clang-18\n               CXX: clang++-18\n     runs-on: ${{ matrix.os }}\n-    name: ${{ matrix.os }}-${{ matrix.compiler.CC }}-pch\n-    if: github.repository == 'azerothcore/azerothcore-wotlk' &amp;&amp; !github.event.pull_request.draft\n+    name: ${{ matrix.os }}-${{ matrix.compiler }}-pch\n+    env:\n+      COMPILER: ${{ matrix.compiler }}\n+    if: github.repository == 'mod-playerbots/azerothcore-wotlk' &amp;&amp; !github.event.pull_request.draft\n     steps:\n       - uses: actions/checkout@v4\n       - uses: ./.github/actions/linux-build\ndiff --git a/.github/workflows/core-build-playerbots.yml b/.github/workflows/core-build-playerbots.yml\nnew file mode 100644\nindex 00000000000000..0d7bf98f7b4dc3\n--- /dev/null\n+++ b/.github/workflows/core-build-playerbots.yml\n@@ -0,0 +1,100 @@\n+# This starter workflow is for a CMake project running on multiple platforms. There is a different starter workflow if you just want a single platform.\n+# See: https://github.com/actions/starter-workflows/blob/main/ci/cmake-single-platform.yml\n+name: ubuntu-build\n+\n+on:\n+  push:\n+    branches: [ \"Playerbot\" ]\n+  pull_request:\n+    branches: [ \"Playerbot\" ]\n+\n+jobs:\n+  build:\n+    strategy:\n+      # Set fail-fast to false to ensure that feedback is delivered for all matrix combinations. Consider changing this to true when your workflow is stable.\n+      fail-fast: false\n+      matrix:\n+        # the result of the matrix will be the combination of all attributes, so we get os*compiler builds\n+        include:\n+          - os: ubuntu-22.04\n+            c_compiler: clang\n+            cpp_compiler: clang++\n+            build_type: Release\n+          - os: ubuntu-22.04\n+            c_compiler: gcc\n+            cpp_compiler: g++\n+            build_type: Release\n+          - os: ubuntu-24.04\n+            c_compiler: gcc\n+            cpp_compiler: g++\n+            build_type: Release\n+            \n+    runs-on: ${{ matrix.os }}\n+    name: ${{ matrix.os }}-${{ matrix.cpp_compiler }}\n+\n+    steps:\n+    - name: Checkout AzerothCore\n+      uses: actions/checkout@v3\n+\n+    - name: Set reusable strings\n+      # Turn repeated input strings (such as the build output directory) into step outputs. These step outputs can be used throughout the workflow file.\n+      id: strings\n+      shell: bash\n+      run: |\n+        echo \"build-output-dir=${{ github.workspace }}/build\" &gt;&gt; \"$GITHUB_OUTPUT\"\n+        \n+    # - name: Clone Playerbot Module\n+    #   run: git clone --depth=1 --branch=master https://github.com/mod-playerbots/mod-playerbots.git modules/mod-playerbots\n+\n+    - name: Checkout Playerbot Module\n+      uses: actions/checkout@v3\n+      with:\n+        repository: 'mod-playerbots/mod-playerbots'\n+        #ref: 'feature/core_update_10_2025' #used on core merge conflicts builds\n+        path: 'modules/mod-playerbots'\n+    \n+    - name: Install Requirements\n+      run: sudo apt-get update &amp;&amp; sudo apt-get install git cmake make gcc g++ clang libmysqlclient-dev libssl-dev libbz2-dev libreadline-dev libncurses-dev mysql-server libboost-all-dev\n+      \n+    # - name: Cache\n+    #   uses: actions/cache@v3\n+    #   with:\n+    #     path: var/ccache\n+    #     key: ccache:${{ matrix.os }}:${{ matrix.compiler }}:${{ matrix.modules }}-modules:${{ github.ref }}:${{ github.sha }}\n+    #     restore-keys: |\n+    #       ccache:${{ matrix.os }}:${{ matrix.compiler }}:${{ matrix.modules }}-modules:${{ github.ref }}\n+    #       ccache:${{ matrix.os }}:${{ matrix.compiler }}:${{ matrix.modules }}-modules\n+            \n+    # - name: Configure OS\n+    #   run: source ./acore.sh install-deps\n+    #   env:\n+    #     CONTINUOUS_INTEGRATION: true\n+        \n+    # - name: Create conf/config.sh\n+    #   run: source ./apps/ci/ci-conf-core.sh\n+      \n+    # - name: Process pending sql\n+    #   run: bash bin/acore-db-pendings\n+      \n+    # - name: Build\n+    #   run: source ./apps/ci/ci-compile.sh\n+        \n+    - name: Configure CMake\n+      # Configure CMake in a 'build' subdirectory. `CMAKE_BUILD_TYPE` is only required if you are using a single-configuration generator such as make.\n+      # See https://cmake.org/cmake/help/latest/variable/CMAKE_BUILD_TYPE.html?highlight=cmake_build_type\n+      run: &gt;\n+        cmake -B ${{ steps.strings.outputs.build-output-dir }}\n+        -DCMAKE_CXX_COMPILER=${{ matrix.cpp_compiler }}\n+        -DCMAKE_C_COMPILER=${{ matrix.c_compiler }}\n+        -DCMAKE_BUILD_TYPE=${{ matrix.build_type }}\n+        -S ${{ github.workspace }}\n+\n+    - name: Build\n+      # Build your program with the given configuration. Note that --config is needed because the default Windows generator is a multi-config generator (Visual Studio generator).\n+      run: cmake --build ${{ steps.strings.outputs.build-output-dir }} --config ${{ matrix.build_type }}\n+\n+    # - name: Test\n+    #   working-directory: ${{ steps.strings.outputs.build-output-dir }}\n+    #   # Execute tests defined by the CMake configuration. Note that --build-config is needed because the default Windows generator is a multi-config generator (Visual Studio generator).\n+    #   # See https://cmake.org/cmake/help/latest/manual/ctest.1.html for more detail\n+    #   run: ctest --build-config ${{ matrix.build_type }}\ndiff --git a/.github/workflows/core-build.yml b/.github/workflows/core-build.yml\nnew file mode 100644\nindex 00000000000000..7f1c0657238951\n--- /dev/null\n+++ b/.github/workflows/core-build.yml\n@@ -0,0 +1,99 @@\n+# This starter workflow is for a CMake project running on multiple platforms. There is a different starter workflow if you just want a single platform.\n+# See: https://github.com/actions/starter-workflows/blob/main/ci/cmake-single-platform.yml\n+name: ubuntu-build\n+\n+on:\n+  push:\n+    branches: [ \"Playerbot\" ]\n+  pull_request:\n+    branches: [ \"Playerbot\" ]\n+\n+jobs:\n+  build:\n+    strategy:\n+      # Set fail-fast to false to ensure that feedback is delivered for all matrix combinations. Consider changing this to true when your workflow is stable.\n+      fail-fast: false\n+      matrix:\n+        # the result of the matrix will be the combination of all attributes, so we get os*compiler builds\n+        include:\n+          - os: ubuntu-22.04\n+            c_compiler: clang\n+            cpp_compiler: clang++\n+            build_type: Release\n+          - os: ubuntu-22.04\n+            c_compiler: gcc\n+            cpp_compiler: g++\n+            build_type: Release\n+          - os: ubuntu-24.04\n+            c_compiler: gcc\n+            cpp_compiler: g++\n+            build_type: Release\n+            \n+    runs-on: ${{ matrix.os }}\n+    name: ${{ matrix.os }}-${{ matrix.cpp_compiler }}\n+\n+    steps:\n+    - name: Checkout AzerothCore\n+      uses: actions/checkout@v3\n+\n+    - name: Set reusable strings\n+      # Turn repeated input strings (such as the build output directory) into step outputs. These step outputs can be used throughout the workflow file.\n+      id: strings\n+      shell: bash\n+      run: |\n+        echo \"build-output-dir=${{ github.workspace }}/build\" &gt;&gt; \"$GITHUB_OUTPUT\"\n+        \n+    # - name: Clone Playerbot Module\n+    #   run: git clone --depth=1 --branch=master https://github.com/mod-playerbots/mod-playerbots.git modules/mod-playerbots\n+\n+    # - name: Checkout Playerbot Module\n+    #   uses: actions/checkout@v3\n+    #   with:\n+    #     repository: 'mod-playerbots/mod-playerbots'\n+    #     path: 'modules/mod-playerbots'\n+    \n+    - name: Install Requirements\n+      run: sudo apt-get update &amp;&amp; sudo apt-get install git cmake make gcc g++ clang libmysqlclient-dev libssl-dev libbz2-dev libreadline-dev libncurses-dev mysql-server libboost-all-dev\n+      \n+    # - name: Cache\n+    #   uses: actions/cache@v3\n+    #   with:\n+    #     path: var/ccache\n+    #     key: ccache:${{ matrix.os }}:${{ matrix.compiler }}:${{ matrix.modules }}-modules:${{ github.ref }}:${{ github.sha }}\n+    #     restore-keys: |\n+    #       ccache:${{ matrix.os }}:${{ matrix.compiler }}:${{ matrix.modules }}-modules:${{ github.ref }}\n+    #       ccache:${{ matrix.os }}:${{ matrix.compiler }}:${{ matrix.modules }}-modules\n+            \n+    # - name: Configure OS\n+    #   run: source ./acore.sh install-deps\n+    #   env:\n+    #     CONTINUOUS_INTEGRATION: true\n+        \n+    # - name: Create conf/config.sh\n+    #   run: source ./apps/ci/ci-conf-core.sh\n+      \n+    # - name: Process pending sql\n+    #   run: bash bin/acore-db-pendings\n+      \n+    # - name: Build\n+    #   run: source ./apps/ci/ci-compile.sh\n+        \n+    - name: Configure CMake\n+      # Configure CMake in a 'build' subdirectory. `CMAKE_BUILD_TYPE` is only required if you are using a single-configuration generator such as make.\n+      # See https://cmake.org/cmake/help/latest/variable/CMAKE_BUILD_TYPE.html?highlight=cmake_build_type\n+      run: &gt;\n+        cmake -B ${{ steps.strings.outputs.build-output-dir }}\n+        -DCMAKE_CXX_COMPILER=${{ matrix.cpp_compiler }}\n+        -DCMAKE_C_COMPILER=${{ matrix.c_compiler }}\n+        -DCMAKE_BUILD_TYPE=${{ matrix.build_type }}\n+        -S ${{ github.workspace }}\n+\n+    - name: Build\n+      # Build your program with the given configuration. Note that --config is needed because the default Windows generator is a multi-config generator (Visual Studio generator).\n+      run: cmake --build ${{ steps.strings.outputs.build-output-dir }} --config ${{ matrix.build_type }}\n+\n+    # - name: Test\n+    #   working-directory: ${{ steps.strings.outputs.build-output-dir }}\n+    #   # Execute tests defined by the CMake configuration. Note that --build-config is needed because the default Windows generator is a multi-config generator (Visual Studio generator).\n+    #   # See https://cmake.org/cmake/help/latest/manual/ctest.1.html for more detail\n+    #   run: ctest --build-config ${{ matrix.build_type }}\ndiff --git a/.github/workflows/core_modules_build.yml b/.github/workflows/core_modules_build.yml\nindex 322c063851189e..3d19433446e8be 100644\n--- a/.github/workflows/core_modules_build.yml\n+++ b/.github/workflows/core_modules_build.yml\n@@ -46,7 +46,7 @@ jobs:\n               CXX: clang++-18\n     runs-on: ${{ matrix.os }}\n     name: ${{ matrix.os }}-${{ matrix.compiler.CC }}-nopch-modules\n-    if: github.repository == 'azerothcore/azerothcore-wotlk' &amp;&amp; !github.event.pull_request.draft\n+    if: github.repository == 'mod-playerbots/azerothcore-wotlk' &amp;&amp; !github.event.pull_request.draft\n     steps:\n       - uses: actions/checkout@v4\n         # This script installs a general list of modules to compile with\ndiff --git a/.github/workflows/docker_build.yml b/.github/workflows/docker_build.yml\nindex e770e0eae6bb01..d6d2f29057330d 100644\n--- a/.github/workflows/docker_build.yml\n+++ b/.github/workflows/docker_build.yml\n@@ -23,13 +23,13 @@ env:\n   COMPOSE_DOCKER_CLI_BUILD: 1\n   DOCKER_BUILDKIT: 1\n   RUNNING_ON_PRIMARY_BRANCH: |\n-    ${{ (github.repository == 'azerothcore/azerothcore-wotlk' &amp;&amp; github.ref_name == 'master') &amp;&amp; 'true' || 'false' }}\n+    ${{ (github.repository == 'mod-playerbots/azerothcore-wotlk' &amp;&amp; github.ref_name == 'master') &amp;&amp; 'true' || 'false' }}\n\n jobs:\n   build-containers:\n     runs-on: \"ubuntu-latest\"\n     if: |\n-      github.repository == 'azerothcore/azerothcore-wotlk'\n+      github.repository == 'mod-playerbots/azerothcore-wotlk'\n       &amp;&amp; !github.event.pull_request.draft\n       &amp;&amp; (github.ref_name == 'master' || contains(github.event.pull_request.labels.*.name, 'run-build') || github.event.label.name == 'run-build')\n     steps:\ndiff --git a/.github/workflows/macos_build.yml b/.github/workflows/macos_build.yml\nindex 09ae976a2262a4..03974bca6ee471 100644\n--- a/.github/workflows/macos_build.yml\n+++ b/.github/workflows/macos_build.yml\n@@ -1,12 +1,9 @@\n name: macos-build\n on:\n   push:\n-    branches:\n-      - 'master'\n+    branches: [ \"Playerbot\" ]\n   pull_request:\n-    types:\n-      - labeled\n-      - synchronize\n+    branches: [ \"Playerbot\" ]\n\n concurrency:\n   group: ${{ github.head_ref }} || concat(${{ github.ref_name }}, ${{ github.workflow }})\n@@ -25,10 +22,6 @@ jobs:\n           - macos-14\n     runs-on: ${{ matrix.os }}\n     name: ${{ matrix.os }}\n-    if: |\n-      github.repository == 'azerothcore/azerothcore-wotlk'\n-      &amp;&amp; !github.event.pull_request.draft\n-      &amp;&amp; (github.ref == 'refs/heads/master' || contains(github.event.pull_request.labels.*.name, 'run-build') || github.event.label.name == 'run-build')\n     steps:\n       - uses: actions/checkout@v4\n       - name: Cache\ndiff --git a/.github/workflows/tools_build.yml b/.github/workflows/tools_build.yml\nindex dbd8eba50bcbb0..d414f233d23a71 100644\n--- a/.github/workflows/tools_build.yml\n+++ b/.github/workflows/tools_build.yml\n@@ -32,9 +32,11 @@ jobs:\n     runs-on: ${{ matrix.os }}\n     name: ${{ matrix.os }}-${{ matrix.compiler.CC }}\n     if: |\n-      github.repository == 'azerothcore/azerothcore-wotlk'\n-      &amp;&amp; !github.event.pull_request.draft\n-      &amp;&amp; (github.ref == 'refs/heads/master' || contains(github.event.pull_request.labels.*.name, 'run-build') || github.event.label.name == 'run-build')\n+      github.repository == 'mod-playerbots/azerothcore-wotlk' &amp;&amp; !github.event.pull_request.draft\n+      &amp;&amp; (\n+        contains(github.event.pull_request.labels.*.name, 'run-build')\n+        || github.event.label.name == 'run-build'\n+      )\n     steps:\n       - uses: actions/checkout@v4\n       - uses: ./.github/actions/linux-build\ndiff --git a/.github/workflows/windows_build.yml b/.github/workflows/windows_build.yml\nindex c23c87be1ccd99..d5d09551168a16 100644\n--- a/.github/workflows/windows_build.yml\n+++ b/.github/workflows/windows_build.yml\n@@ -1,12 +1,9 @@\n name: windows-build\n on:\n   push:\n-    branches:\n-      - 'master'\n+    branches: [ \"Playerbot\" ]\n   pull_request:\n-    types:\n-      - labeled\n-      - synchronize\n+    branches: [ \"Playerbot\" ]\n\n concurrency:\n   # One concurrency group per workflow + ref.\n@@ -29,10 +26,6 @@ jobs:\n     name: ${{ matrix.os }}\n     env:\n       BOOST_ROOT: C:\\local\\boost_1_82_0\n-    if: |\n-      github.repository == 'azerothcore/azerothcore-wotlk'\n-      &amp;&amp; !github.event.pull_request.draft\n-      &amp;&amp; (github.ref == 'refs/heads/master' || contains(github.event.pull_request.labels.*.name, 'run-build') || github.event.label.name == 'run-build')\n     steps:\n       - uses: actions/checkout@v4\n       - name: ccache\ndiff --git a/.gitignore b/.gitignore\nindex 548213a63fcbf5..a25db2997252a4 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -58,6 +58,8 @@ CMakeLists.txt.user\n #\n /.settings/\n /.externalToolBuilders/*\n+/.vs\n+/out\n # exclude in all levels\n nbproject/\n .sync.ffs_db\n@@ -102,3 +104,5 @@ local.properties\n #  !modules/yourmodule\n #\n # ==================\n+.cache\n+compile_commands.json\n\\ No newline at end of file\ndiff --git a/apps/ci/mac/ci-compile.sh b/apps/ci/mac/ci-compile.sh\nindex 79507bc9f3c975..10dfbc4b64e14f 100755\n--- a/apps/ci/mac/ci-compile.sh\n+++ b/apps/ci/mac/ci-compile.sh\n@@ -22,8 +22,7 @@ if [ ! -d \"$mysql_include_path\" ]; then\n fi\n\n time cmake ../../../ \\\n--DTOOLS=1 \\\n--DBUILD_TESTING=1 \\\n+-DTOOLS_BUILD=all \\\n -DSCRIPTS=static \\\n -DCMAKE_BUILD_TYPE=Release \\\n -DMYSQL_ADD_INCLUDE_PATH=$mysql_include_path \\\n@@ -33,9 +32,6 @@ time cmake ../../../ \\\n -DOPENSSL_INCLUDE_DIR=\"$OPENSSL_ROOT_DIR/include\" \\\n -DOPENSSL_SSL_LIBRARIES=\"$OPENSSL_ROOT_DIR/lib/libssl.dylib\" \\\n -DOPENSSL_CRYPTO_LIBRARIES=\"$OPENSSL_ROOT_DIR/lib/libcrypto.dylib\" \\\n--DWITH_WARNINGS=1 \\\n--DCMAKE_C_FLAGS=\"-Werror\" \\\n--DCMAKE_CXX_FLAGS=\"-Werror\" \\\n -DCMAKE_C_COMPILER_LAUNCHER=ccache \\\n -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \\\n -DUSE_SCRIPTPCH=0 \\\ndiff --git a/apps/installer/includes/os_configs/windows.sh b/apps/installer/includes/os_configs/windows.sh\nindex cdba50c27fbfa7..ae69640b05c46a 100644\n--- a/apps/installer/includes/os_configs/windows.sh\n+++ b/apps/installer/includes/os_configs/windows.sh\n@@ -24,6 +24,6 @@ fi\n\n choco install -y --skip-checksums \"${INSTALL_ARGS[@]}\"  cmake.install -y --installargs 'ADD_CMAKE_TO_PATH=System'\n choco install -y --skip-checksums \"${INSTALL_ARGS[@]}\"  visualstudio2022-workload-nativedesktop\n-choco install -y --skip-checksums \"${INSTALL_ARGS[@]}\"  openssl --force --version=3.5.4\n+choco install -y --skip-checksums \"${INSTALL_ARGS[@]}\"  openssl --force --version=3.6.1\n choco install -y --skip-checksums \"${INSTALL_ARGS[@]}\"  boost-msvc-14.3 --force --version=1.87.0\n choco install -y --skip-checksums \"${INSTALL_ARGS[@]}\"  mysql --force --version=8.4.6\ndiff --git a/deps/boost/CMakeLists.txt b/deps/boost/CMakeLists.txt\nindex c41ce041a3b231..78335628360859 100644\n--- a/deps/boost/CMakeLists.txt\n+++ b/deps/boost/CMakeLists.txt\n@@ -32,7 +32,7 @@ else()\n endif()\n\n # Boost.System is header-only since 1.69; do not require it explicitly.\n-find_package(Boost ${BOOST_REQUIRED_VERSION} REQUIRED COMPONENTS filesystem program_options iostreams regex)\n+find_package(Boost ${BOOST_REQUIRED_VERSION} REQUIRED COMPONENTS filesystem program_options iostreams regex thread)\n\n if(NOT Boost_FOUND)\n   if(NOT DEFINED ENV{Boost_ROOT} AND NOT DEFINED Boost_DIR AND NOT DEFINED BOOST_ROOT AND NOT DEFINED BOOSTROOT)\ndiff --git a/doc/changelog/master.md b/doc/changelog/master.md\nindex 59b9f7bb9bd6d6..3cd001b8d552f3 100644\n--- a/doc/changelog/master.md\n+++ b/doc/changelog/master.md\n@@ -414,7 +414,7 @@ minimal-dynamic - builds commands and spells dynamically. Now don't support\n - Example loader script for modules:\n ```cpp\n /*\n- * Copyright (C) 2016+ AzerothCore &lt;www.azerothcore.org&gt;\n+ * Copyright (C) 2016+ AzerothCore &lt;www.azerothcore.org&gt;, released under GNU AGPL v3 license: https://github.com/azerothcore/azerothcore-wotlk/blob/master/LICENSE\n  */\n\n // From SC\ndiff --git a/docker-compose.yml b/docker-compose.yml\nindex 4c6525df0ebc98..f14f6dac879ef3 100644\n--- a/docker-compose.yml\n+++ b/docker-compose.yml\n@@ -75,6 +75,7 @@ services:\n       AC_LOGIN_DATABASE_INFO: \"ac-database;3306;root;${DOCKER_DB_ROOT_PASSWORD:-password};acore_auth\"\n       AC_WORLD_DATABASE_INFO: \"ac-database;3306;root;${DOCKER_DB_ROOT_PASSWORD:-password};acore_world\"\n       AC_CHARACTER_DATABASE_INFO: \"ac-database;3306;root;${DOCKER_DB_ROOT_PASSWORD:-password};acore_characters\"\n+      AC_PLAYERBOTS_DATABASE_INFO: \"ac-database;3306;root;${DOCKER_DB_ROOT_PASSWORD:-password};acore_playerbots\"\n     ports:\n       - ${DOCKER_WORLD_EXTERNAL_PORT:-8085}:8085\n       - ${DOCKER_SOAP_EXTERNAL_PORT:-7878}:7878\ndiff --git a/modules/CMakeLists.txt b/modules/CMakeLists.txt\nindex fd36c5068a3991..a4b8c14c6cb11e 100644\n--- a/modules/CMakeLists.txt\n+++ b/modules/CMakeLists.txt\n@@ -37,6 +37,7 @@ set(\"AC_MODULE_LIST\" \"\")\n set(\"AC_SCRIPTS_LIST\" \"\")\n set(MOD_ALE_FOUND 0)\n set(MOD_ALE_PATH \"\")\n+set(MOD_PLAYERBOTS_FOUND 0)\n\n foreach(include ${AC_ADD_SCRIPTS_INCLUDE})\n   set(\"AC_SCRIPTS_INCLUDES\" \"#include \\\"${include}\\\"\\n${AC_SCRIPTS_INCLUDES}\")\n@@ -81,6 +82,16 @@ foreach(SOURCE_MODULE ${MODULES_MODULE_LIST})\n     ConfigureALEModule(${SOURCE_MODULE})\n   endif()\n\n+  if (SOURCE_MODULE MATCHES \"mod-playerbots\")\n+    set(MOD_PLAYERBOTS_FOUND 1)\n+    target_compile_options(database\n+      PRIVATE\n+        -DMOD_PLAYERBOTS)\n+    target_compile_options(game-interface\n+      INTERFACE\n+        -DMOD_PLAYERBOTS)\n+  endif()\n+\n   # Build the Graph values\n   if(${MODULE_MODULE_VARIABLE} MATCHES \"dynamic\")\n     GetProjectNameOfModuleName(${SOURCE_MODULE} MODULE_SOURCE_PROJECT_NAME)\n@@ -289,6 +300,7 @@ endif()\n target_link_libraries(modules\n   PRIVATE\n     acore-core-interface\n+    mysql\n   PUBLIC\n     game-interface)\n\n@@ -363,6 +375,12 @@ target_compile_options(modules\n   INTERFACE\n     -DCONFIG_FILE_LIST=$&lt;1:\"${CONFIG_LIST}\"&gt;)\n\n+if (MOD_PLAYERBOTS_FOUND)\n+    target_compile_options(modules\n+            PRIVATE\n+            -DMOD_PLAYERBOTS)\n+endif()\n+\n if (MOD_ALE_FOUND)\n   if (APPLE)\n     target_compile_definitions(modules\ndiff --git a/src/server/apps/worldserver/Main.cpp b/src/server/apps/worldserver/Main.cpp\nindex 511c17e3674c3d..6a08e9689aa622 100644\n--- a/src/server/apps/worldserver/Main.cpp\n+++ b/src/server/apps/worldserver/Main.cpp\n@@ -434,6 +434,11 @@ bool StartDB()\n     if (!loader.Load())\n         return false;\n\n+    if (!sScriptMgr-&gt;OnDatabasesLoading())\n+    {\n+        return false;\n+    }\n+\n     ///- Get the realm Id from the configuration file\n     realm.Id.Realm = sConfigMgr-&gt;GetOption&lt;uint32&gt;(\"RealmID\", 1);\n     if (!realm.Id.Realm)\n@@ -479,6 +484,8 @@ void StopDB()\n     WorldDatabase.Close();\n     LoginDatabase.Close();\n\n+    sScriptMgr-&gt;OnDatabasesClosing();\n+\n     MySQL::Library_End();\n }\n\n@@ -569,6 +576,8 @@ void WorldUpdateLoop()\n     CharacterDatabase.WarnAboutSyncQueries(true);\n     WorldDatabase.WarnAboutSyncQueries(true);\n\n+    sScriptMgr-&gt;OnDatabaseWarnAboutSyncQueries(true);\n+\n     ///- While we have not World::m_stopEvent, update the world\n     while (!World::IsStopped())\n     {\n@@ -598,6 +607,8 @@ void WorldUpdateLoop()\n #endif\n     }\n\n+    sScriptMgr-&gt;OnDatabaseWarnAboutSyncQueries(false);\n+\n     LoginDatabase.WarnAboutSyncQueries(false);\n     CharacterDatabase.WarnAboutSyncQueries(false);\n     WorldDatabase.WarnAboutSyncQueries(false);\ndiff --git a/src/server/apps/worldserver/worldserver.conf.dist b/src/server/apps/worldserver/worldserver.conf.dist\nindex b445450e17b362..01fc64116d376b 100644\n--- a/src/server/apps/worldserver/worldserver.conf.dist\n+++ b/src/server/apps/worldserver/worldserver.conf.dist\n@@ -678,6 +678,7 @@ Allow.IP.Based.Action.Logging = 0\n\n Appender.Console=1,4,0,\"1 9 3 6 5 8\"\n Appender.Server=2,5,0,Server.log,w\n+Appender.Playerbots=2,5,0,Playerbots.log,w\n # Appender.GM=2,5,15,gm_%s.log\n Appender.Errors=2,2,0,Errors.log,w\n # Appender.DB=3,5,0\n@@ -714,6 +715,7 @@ Logger.sql=4,Console Server\n Logger.time.update=4,Console Server\n Logger.module=4,Console Server\n Logger.spells.scripts=2,Console Errors\n+Logger.playerbots=5,Console Playerbots\n #Logger.achievement=4,Console Server\n #Logger.addon=4,Console Server\n #Logger.auctionHouse=4,Console Server\ndiff --git a/src/server/database/Database/DatabaseEnv.cpp b/src/server/database/Database/DatabaseEnv.cpp\nindex 561e80f4b151cf..56f904d2eb0942 100644\n--- a/src/server/database/Database/DatabaseEnv.cpp\n+++ b/src/server/database/Database/DatabaseEnv.cpp\n@@ -20,3 +20,7 @@\n DatabaseWorkerPool&lt;WorldDatabaseConnection&gt; WorldDatabase;\n DatabaseWorkerPool&lt;CharacterDatabaseConnection&gt; CharacterDatabase;\n DatabaseWorkerPool&lt;LoginDatabaseConnection&gt; LoginDatabase;\n+\n+#ifdef MOD_PLAYERBOTS\n+DatabaseWorkerPool&lt;PlayerbotsDatabaseConnection&gt; PlayerbotsDatabase;\n+#endif\ndiff --git a/src/server/database/Database/DatabaseEnv.h b/src/server/database/Database/DatabaseEnv.h\nindex 3e0cd2e8613636..7d2b5da775d364 100644\n--- a/src/server/database/Database/DatabaseEnv.h\n+++ b/src/server/database/Database/DatabaseEnv.h\n@@ -25,6 +25,10 @@\n #include \"Implementation/LoginDatabase.h\"\n #include \"Implementation/WorldDatabase.h\"\n\n+#ifdef MOD_PLAYERBOTS\n+#include \"Implementation/PlayerbotsDatabase.h\"\n+#endif\n+\n #include \"PreparedStatement.h\"\n #include \"QueryCallback.h\"\n #include \"Transaction.h\"\n@@ -36,4 +40,9 @@ AC_DATABASE_API extern DatabaseWorkerPool&lt;CharacterDatabaseConnection&gt; Character\n /// Accessor to the realm/login database\n AC_DATABASE_API extern DatabaseWorkerPool&lt;LoginDatabaseConnection&gt; LoginDatabase;\n\n+#ifdef MOD_PLAYERBOTS\n+/// Accessor to the playerbots database\n+AC_DATABASE_API extern DatabaseWorkerPool&lt;PlayerbotsDatabaseConnection&gt; PlayerbotsDatabase;\n+#endif\n+\n #endif\ndiff --git a/src/server/database/Database/DatabaseEnvFwd.h b/src/server/database/Database/DatabaseEnvFwd.h\nindex b8e5a8882739f1..d6bbaa65e89711 100644\n--- a/src/server/database/Database/DatabaseEnvFwd.h\n+++ b/src/server/database/Database/DatabaseEnvFwd.h\n@@ -32,6 +32,10 @@ class CharacterDatabaseConnection;\n class LoginDatabaseConnection;\n class WorldDatabaseConnection;\n\n+#ifdef MOD_PLAYERBOTS\n+class PlayerbotsDatabaseConnection;\n+#endif\n+\n class PreparedStatementBase;\n\n template&lt;typename T&gt;\n@@ -41,6 +45,10 @@ using CharacterDatabasePreparedStatement = PreparedStatement&lt;CharacterDatabaseCo\n using LoginDatabasePreparedStatement = PreparedStatement&lt;LoginDatabaseConnection&gt;;\n using WorldDatabasePreparedStatement = PreparedStatement&lt;WorldDatabaseConnection&gt;;\n\n+#ifdef MOD_PLAYERBOTS\n+using PlayerbotsDatabasePreparedStatement = PreparedStatement&lt;PlayerbotsDatabaseConnection&gt;;\n+#endif\n+\n class PreparedResultSet;\n using PreparedQueryResult = std::shared_ptr&lt;PreparedResultSet&gt;;\n using PreparedQueryResultFuture = std::future&lt;PreparedQueryResult&gt;;\n@@ -70,6 +78,10 @@ using CharacterDatabaseTransaction = SQLTransaction&lt;CharacterDatabaseConnection&gt;\n using LoginDatabaseTransaction = SQLTransaction&lt;LoginDatabaseConnection&gt;;\n using WorldDatabaseTransaction = SQLTransaction&lt;WorldDatabaseConnection&gt;;\n\n+#ifdef MOD_PLAYERBOTS\n+using PlayerbotsDatabaseTransaction = SQLTransaction&lt;PlayerbotsDatabaseConnection&gt;;\n+#endif\n+\n class SQLQueryHolderBase;\n using QueryResultHolderFuture = std::future&lt;void&gt;;\n using QueryResultHolderPromise = std::promise&lt;void&gt;;\n@@ -81,6 +93,10 @@ using CharacterDatabaseQueryHolder = SQLQueryHolder&lt;CharacterDatabaseConnection&gt;\n using LoginDatabaseQueryHolder = SQLQueryHolder&lt;LoginDatabaseConnection&gt;;\n using WorldDatabaseQueryHolder = SQLQueryHolder&lt;WorldDatabaseConnection&gt;;\n\n+#ifdef MOD_PLAYERBOTS\n+using PlayerbotsDatabaseQueryHolder = SQLQueryHolder&lt;PlayerbotsDatabaseConnection&gt;;\n+#endif\n+\n class SQLQueryHolderCallback;\n\n // mysql\ndiff --git a/src/server/database/Database/DatabaseLoader.cpp b/src/server/database/Database/DatabaseLoader.cpp\nindex c39aa41b936e1c..0328dd49d01b02 100644\n--- a/src/server/database/Database/DatabaseLoader.cpp\n+++ b/src/server/database/Database/DatabaseLoader.cpp\n@@ -238,3 +238,8 @@ template AC_DATABASE_API\n DatabaseLoader&amp; DatabaseLoader::AddDatabase&lt;CharacterDatabaseConnection&gt;(DatabaseWorkerPool&lt;CharacterDatabaseConnection&gt;&amp;, std::string const&amp;);\n template AC_DATABASE_API\n DatabaseLoader&amp; DatabaseLoader::AddDatabase&lt;WorldDatabaseConnection&gt;(DatabaseWorkerPool&lt;WorldDatabaseConnection&gt;&amp;, std::string const&amp;);\n+\n+#ifdef MOD_PLAYERBOTS\n+template AC_DATABASE_API\n+DatabaseLoader&amp; DatabaseLoader::AddDatabase&lt;PlayerbotsDatabaseConnection&gt;(DatabaseWorkerPool&lt;PlayerbotsDatabaseConnection&gt;&amp;, std::string const&amp;);\n+#endif\ndiff --git a/src/server/database/Database/DatabaseLoader.h b/src/server/database/Database/DatabaseLoader.h\nindex 0f18315e6c51a1..0ef3e82cbbaa76 100644\n--- a/src/server/database/Database/DatabaseLoader.h\n+++ b/src/server/database/Database/DatabaseLoader.h\n@@ -48,8 +48,12 @@ class AC_DATABASE_API DatabaseLoader\n         DATABASE_LOGIN      = 1,\n         DATABASE_CHARACTER  = 2,\n         DATABASE_WORLD      = 4,\n-\n+#ifdef MOD_PLAYERBOTS\n+        DATABASE_PLAYERBOTS = 8,\n+        DATABASE_MASK_ALL   = DATABASE_LOGIN | DATABASE_CHARACTER | DATABASE_WORLD | DATABASE_PLAYERBOTS\n+#else\n         DATABASE_MASK_ALL   = DATABASE_LOGIN | DATABASE_CHARACTER | DATABASE_WORLD\n+#endif\n     };\n\n     [[nodiscard]] uint32 GetUpdateFlags() const\n@@ -57,6 +61,11 @@ class AC_DATABASE_API DatabaseLoader\n         return _updateFlags;\n     }\n\n+    void SetUpdateFlags(uint32 newUpdateFlags)\n+    {\n+        _updateFlags |= newUpdateFlags;\n+    }\n+\n private:\n     bool OpenDatabases();\n     bool PopulateDatabases();\n@@ -73,7 +82,7 @@ class AC_DATABASE_API DatabaseLoader\n     std::string const _logger;\n     std::string_view _modulesList;\n     bool const _autoSetup;\n-    uint32 const _updateFlags;\n+    uint32 _updateFlags;\n\n     std::queue&lt;Predicate&gt; _open, _populate, _update, _prepare;\n     std::stack&lt;Closer&gt; _close;\ndiff --git a/src/server/database/Database/DatabaseWorkerPool.cpp b/src/server/database/Database/DatabaseWorkerPool.cpp\nindex ee19a5a48c5559..f539e2a6a64ac6 100644\n--- a/src/server/database/Database/DatabaseWorkerPool.cpp\n+++ b/src/server/database/Database/DatabaseWorkerPool.cpp\n@@ -41,6 +41,10 @@\n #include &lt;sstream&gt;\n #endif\n\n+#ifdef MOD_PLAYERBOTS\n+#include \"Implementation/PlayerbotsDatabase.h\"\n+#endif\n+\n class PingOperation : public SQLOperation\n {\n     //! Operation for idle delaythreads\n@@ -571,3 +575,7 @@ void DatabaseWorkerPool&lt;T&gt;::ExecuteOrAppend(SQLTransaction&lt;T&gt;&amp; trans, PreparedSt\n template class AC_DATABASE_API DatabaseWorkerPool&lt;LoginDatabaseConnection&gt;;\n template class AC_DATABASE_API DatabaseWorkerPool&lt;WorldDatabaseConnection&gt;;\n template class AC_DATABASE_API DatabaseWorkerPool&lt;CharacterDatabaseConnection&gt;;\n+\n+#ifdef MOD_PLAYERBOTS\n+template class AC_DATABASE_API DatabaseWorkerPool&lt;PlayerbotsDatabaseConnection&gt;;\n+#endif\ndiff --git a/src/server/database/Database/Implementation/CharacterDatabase.cpp b/src/server/database/Database/Implementation/CharacterDatabase.cpp\nindex 1b8650b4965a9a..25e9b635a105f8 100644\n--- a/src/server/database/Database/Implementation/CharacterDatabase.cpp\n+++ b/src/server/database/Database/Implementation/CharacterDatabase.cpp\n@@ -356,6 +356,7 @@ void CharacterDatabaseConnection::DoPrepareStatements()\n     PrepareStatement(CHAR_UPD_PETITION_NAME, \"UPDATE petition SET name = ? WHERE petition_id = ?\", CONNECTION_ASYNC);\n     PrepareStatement(CHAR_INS_PETITION_SIGNATURE, \"INSERT INTO petition_sign (ownerguid, petition_id, playerguid, player_account) VALUES (?, ?, ?, ?)\", CONNECTION_ASYNC);\n     PrepareStatement(CHAR_UPD_ACCOUNT_ONLINE, \"UPDATE characters SET online = 0 WHERE account = ?\", CONNECTION_ASYNC);\n+    PrepareStatement(CHAR_UPD_CHAR_OFFLINE, \"UPDATE characters SET online = 0 WHERE guid = ?\", CONNECTION_ASYNC);\n     PrepareStatement(CHAR_INS_GROUP, \"INSERT INTO `groups` (guid, leaderGuid, lootMethod, looterGuid, lootThreshold, icon1, icon2, icon3, icon4, icon5, icon6, icon7, icon8, groupType, difficulty, raidDifficulty, masterLooterGuid) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\", CONNECTION_ASYNC);\n     PrepareStatement(CHAR_REP_GROUP_MEMBER, \"REPLACE INTO group_member (guid, memberGuid, memberFlags, subgroup, roles) VALUES(?, ?, ?, ?, ?)\", CONNECTION_ASYNC);\n     PrepareStatement(CHAR_DEL_GROUP_MEMBER, \"DELETE FROM group_member WHERE memberGuid = ? AND guid = ?\", CONNECTION_ASYNC);\n@@ -404,7 +405,7 @@ void CharacterDatabaseConnection::DoPrepareStatements()\n     PrepareStatement(CHAR_SEL_CHAR_DEL_INFO_BY_GUID, \"SELECT guid, deleteInfos_Name, deleteInfos_Account, deleteDate FROM characters WHERE deleteDate IS NOT NULL AND guid = ?\", CONNECTION_SYNCH);\n     PrepareStatement(CHAR_SEL_CHAR_DEL_INFO_BY_NAME, \"SELECT guid, deleteInfos_Name, deleteInfos_Account, deleteDate FROM characters WHERE deleteDate IS NOT NULL AND deleteInfos_Name LIKE CONCAT('%%', ?, '%%')\", CONNECTION_SYNCH);\n     PrepareStatement(CHAR_SEL_CHAR_DEL_INFO, \"SELECT guid, deleteInfos_Name, deleteInfos_Account, deleteDate FROM characters WHERE deleteDate IS NOT NULL\", CONNECTION_SYNCH);\n-    PrepareStatement(CHAR_SEL_CHARS_BY_ACCOUNT_ID, \"SELECT guid FROM characters WHERE account = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(CHAR_SEL_CHARS_BY_ACCOUNT_ID, \"SELECT guid, class, race FROM characters WHERE account = ?\", CONNECTION_SYNCH);\n     PrepareStatement(CHAR_SEL_CHAR_PINFO, \"SELECT totaltime, level, money, account, race, class, map, zone, gender, health, playerFlags FROM characters WHERE guid = ?\", CONNECTION_SYNCH);\n     PrepareStatement(CHAR_SEL_PINFO_BANS, \"SELECT unbandate, bandate = unbandate, bannedby, banreason FROM character_banned WHERE guid = ? AND active ORDER BY bandate ASC LIMIT 1\", CONNECTION_SYNCH);\n     PrepareStatement(CHAR_SEL_PINFO_MAILS, \"SELECT SUM(CASE WHEN (checked &amp; 1) THEN 1 ELSE 0 END) AS 'readmail', COUNT(*) AS 'totalmail' FROM mail WHERE `receiver` = ?\", CONNECTION_SYNCH);\ndiff --git a/src/server/database/Database/Implementation/CharacterDatabase.h b/src/server/database/Database/Implementation/CharacterDatabase.h\nindex 3ead3cf4031f4b..0329464f675ee5 100644\n--- a/src/server/database/Database/Implementation/CharacterDatabase.h\n+++ b/src/server/database/Database/Implementation/CharacterDatabase.h\n@@ -280,6 +280,7 @@ enum CharacterDatabaseStatements : uint32\n     CHAR_UPD_PETITION_NAME,\n     CHAR_INS_PETITION_SIGNATURE,\n     CHAR_UPD_ACCOUNT_ONLINE,\n+    CHAR_UPD_CHAR_OFFLINE,\n     CHAR_INS_GROUP,\n     CHAR_REP_GROUP_MEMBER,\n     CHAR_DEL_GROUP_MEMBER,\ndiff --git a/src/server/database/Database/Implementation/LoginDatabase.cpp b/src/server/database/Database/Implementation/LoginDatabase.cpp\nindex 1e091b56e45821..069abd66568c2b 100644\n--- a/src/server/database/Database/Implementation/LoginDatabase.cpp\n+++ b/src/server/database/Database/Implementation/LoginDatabase.cpp\n@@ -75,6 +75,7 @@ void LoginDatabaseConnection::DoPrepareStatements()\n     PrepareStatement(LOGIN_DEL_IP_NOT_BANNED, \"DELETE FROM ip_banned WHERE ip = ?\", CONNECTION_ASYNC);\n     PrepareStatement(LOGIN_INS_ACCOUNT_BANNED, \"INSERT INTO account_banned VALUES (?, UNIX_TIMESTAMP(), UNIX_TIMESTAMP()+?, ?, ?, 1)\", CONNECTION_ASYNC);\n     PrepareStatement(LOGIN_UPD_ACCOUNT_NOT_BANNED, \"UPDATE account_banned SET active = 0 WHERE id = ? AND active != 0\", CONNECTION_ASYNC);\n+    PrepareStatement(LOGIN_DEL_REALM_CHARACTERS_BY_REALM, \"DELETE FROM realmcharacters WHERE acctid = ? AND realmid = ?\", CONNECTION_ASYNC);\n     PrepareStatement(LOGIN_DEL_REALM_CHARACTERS, \"DELETE FROM realmcharacters WHERE acctid = ?\", CONNECTION_ASYNC);\n     PrepareStatement(LOGIN_REP_REALM_CHARACTERS, \"REPLACE INTO realmcharacters (numchars, acctid, realmid) VALUES (?, ?, ?)\", CONNECTION_ASYNC);\n     PrepareStatement(LOGIN_SEL_SUM_REALM_CHARACTERS, \"SELECT SUM(numchars) FROM realmcharacters WHERE acctid = ?\", CONNECTION_ASYNC);\n@@ -89,7 +90,7 @@ void LoginDatabaseConnection::DoPrepareStatements()\n     PrepareStatement(LOGIN_UPD_MUTE_TIME_LOGIN, \"UPDATE account SET mutetime = ? WHERE id = ?\", CONNECTION_ASYNC);\n     PrepareStatement(LOGIN_UPD_LAST_IP, \"UPDATE account SET last_ip = ? WHERE username = ?\", CONNECTION_ASYNC);\n     PrepareStatement(LOGIN_UPD_LAST_ATTEMPT_IP, \"UPDATE account SET last_attempt_ip = ? WHERE username = ?\", CONNECTION_ASYNC);\n-    PrepareStatement(LOGIN_UPD_ACCOUNT_ONLINE, \"UPDATE account SET online = ? WHERE id = ?\", CONNECTION_ASYNC);\n+    PrepareStatement(LOGIN_UPD_ACCOUNT_ONLINE, \"UPDATE account SET online = 1 WHERE id = ?\", CONNECTION_ASYNC);\n     PrepareStatement(LOGIN_UPD_UPTIME_PLAYERS, \"UPDATE uptime SET uptime = ?, maxplayers = ? WHERE realmid = ? AND starttime = ?\", CONNECTION_ASYNC);\n     PrepareStatement(LOGIN_DEL_OLD_LOGS, \"DELETE FROM logs WHERE (time + ?) &lt; ?\", CONNECTION_ASYNC);\n     PrepareStatement(LOGIN_DEL_ACCOUNT_ACCESS, \"DELETE FROM account_access WHERE id = ?\", CONNECTION_ASYNC);\ndiff --git a/src/server/database/Database/Implementation/LoginDatabase.h b/src/server/database/Database/Implementation/LoginDatabase.h\nindex 563cdf3eb6fb21..4f0129782dee1e 100644\n--- a/src/server/database/Database/Implementation/LoginDatabase.h\n+++ b/src/server/database/Database/Implementation/LoginDatabase.h\n@@ -59,6 +59,7 @@ enum LoginDatabaseStatements : uint32\n     LOGIN_SEL_ACCOUNT_BY_ID,\n     LOGIN_INS_ACCOUNT_BANNED,\n     LOGIN_UPD_ACCOUNT_NOT_BANNED,\n+    LOGIN_DEL_REALM_CHARACTERS_BY_REALM,\n     LOGIN_DEL_REALM_CHARACTERS,\n     LOGIN_REP_REALM_CHARACTERS,\n     LOGIN_SEL_SUM_REALM_CHARACTERS,\ndiff --git a/src/server/database/Database/Implementation/PlayerbotsDatabase.cpp b/src/server/database/Database/Implementation/PlayerbotsDatabase.cpp\nnew file mode 100644\nindex 00000000000000..930862e04d887d\n--- /dev/null\n+++ b/src/server/database/Database/Implementation/PlayerbotsDatabase.cpp\n@@ -0,0 +1,129 @@\n+/*\n+ * This file is part of the AzerothCore Project. See AUTHORS file for Copyright information\n+ *\n+ * This program is free software; you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation; either version 2 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n+ * more details.\n+ *\n+ * You should have received a copy of the GNU General Public License along\n+ * with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.\n+ */\n+\n+#ifdef MOD_PLAYERBOTS\n+\n+#include \"PlayerbotsDatabase.h\"\n+#include \"MySQLPreparedStatement.h\"\n+\n+void PlayerbotsDatabaseConnection::DoPrepareStatements()\n+{\n+    if (!m_reconnecting)\n+        m_stmts.resize(MAX_PLAYERBOTS_STATEMENTS);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_CUSTOM_STRATEGY_BY_OWNER, \"SELECT DISTINCT name FROM playerbots_custom_strategy WHERE owner = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_SEL_CUSTOM_STRATEGY_BY_OWNER_AND_NAME, \"SELECT idx, action_line FROM playerbots_custom_strategy WHERE owner = ? AND name = ? ORDER BY idx\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_SEL_CUSTOM_STRATEGY_BY_OWNER_AND_NAME_AND_IDX, \"SELECT action_line FROM playerbots_custom_strategy WHERE owner = ? AND name = ? AND idx = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_DEL_CUSTOM_STRATEGY, \"DELETE FROM playerbots_custom_strategy WHERE name = ? AND owner = ? AND idx = ?\", CONNECTION_ASYNC);\n+    PrepareStatement(PLAYERBOTS_UPD_CUSTOM_STRATEGY, \"UPDATE playerbots_custom_strategy SET action_line = ? WHERE name = ? AND owner = ? AND idx = ?\", CONNECTION_ASYNC);\n+    PrepareStatement(PLAYERBOTS_INS_CUSTOM_STRATEGY, \"INSERT INTO playerbots_custom_strategy (name, owner, idx, action_line) VALUES (?, ?, ?, ?)\", CONNECTION_ASYNC);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_DB_STORE, \"SELECT `key`,`value` FROM `playerbots_db_store` WHERE `guid` = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_DEL_DB_STORE, \"DELETE FROM `playerbots_db_store` WHERE `guid` = ?\", CONNECTION_ASYNC);\n+    PrepareStatement(PLAYERBOTS_INS_DB_STORE, \"INSERT INTO `playerbots_db_store` (`guid`, `key`, `value`) VALUES (?, ?, ?)\", CONNECTION_ASYNC);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_ENCHANTS, \"SELECT class, spec, spellid, slotid FROM playerbots_enchants\", CONNECTION_SYNCH);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_EQUIP_CACHE, \"SELECT clazz, lvl, slot, quality, item FROM playerbots_equip_cache\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_INS_EQUIP_CACHE, \"INSERT INTO playerbots_equip_cache (clazz, lvl, slot, quality, item) VALUES (?, ?, ?, ?, ?)\", CONNECTION_ASYNC);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_GUILD_TASKS_BY_VALUE, \"SELECT `value`, `time`, validIn FROM playerbots_guild_tasks WHERE `value` = ? AND guildid = ? AND `type` = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_SEL_GUILD_TASKS_BY_OWNER, \"SELECT `value`, `time`, validIn, guildid FROM playerbots_guild_tasks WHERE owner = ? AND `type` = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_SEL_GUILD_TASKS_BY_OWNER_AND_TYPE, \"SELECT `value`, `time`, validIn FROM playerbots_guild_tasks WHERE owner = ? AND guildid = ? AND `type` = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_SEL_GUILD_TASKS_BY_OWNER_DISTINCT, \"SELECT DISTINCT guildid FROM playerbots_guild_tasks WHERE owner = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_SEL_GUILD_TASKS_BY_OWNER_ORDERED, \"SELECT `value`, `time`, validIn, guildid FROM playerbots_guild_tasks WHERE owner = ? AND type = ? ORDER BY guildid\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_DEL_GUILD_TASKS, \"DELETE FROM playerbots_guild_tasks WHERE owner = ? AND guildid = ? AND `type` = ?\", CONNECTION_ASYNC);\n+    PrepareStatement(PLAYERBOTS_INS_GUILD_TASKS, \"INSERT INTO playerbots_guild_tasks (owner, guildid, `time`, validIn, `type`, `value`) VALUES (?, ?, ?, ?, ?, ?)\", CONNECTION_ASYNC);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_RANDOM_BOTS_VALUE, \"SELECT value FROM playerbots_random_bots WHERE event = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_SEL_RANDOM_BOTS_BOT, \"SELECT `bot` FROM playerbots_random_bots WHERE event = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_SEL_RANDOM_BOTS_BY_OWNER_AND_EVENT, \"SELECT bot FROM playerbots_random_bots WHERE owner = ? AND event = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_SEL_RANDOM_BOTS_BY_OWNER_AND_BOT, \"SELECT `event`, `value`, `time`, validIn, `data` FROM playerbots_random_bots WHERE owner = ? AND bot = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_SEL_RANDOM_BOTS_BY_EVENT_AND_VALUE, \"SELECT bot FROM playerbots_random_bots WHERE event = ? AND value = ?\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_INS_RANDOM_BOTS, \"INSERT INTO playerbots_random_bots (owner, bot, `time`, validIn, event, `value`, `data`) VALUES (?, ?, ?, ?, ?, ?, ?)\", CONNECTION_ASYNC);\n+    PrepareStatement(PLAYERBOTS_DEL_RANDOM_BOTS, \"DELETE FROM playerbots_random_bots\", CONNECTION_ASYNC);\n+    PrepareStatement(PLAYERBOTS_DEL_RANDOM_BOTS_BY_OWNER, \"DELETE FROM playerbots_random_bots WHERE owner = ? AND bot = ?\", CONNECTION_ASYNC);\n+    PrepareStatement(PLAYERBOTS_DEL_RANDOM_BOTS_BY_OWNER_AND_EVENT, \"DELETE FROM playerbots_random_bots WHERE owner = ? AND bot = ? AND event = ?\", CONNECTION_ASYNC);\n+    PrepareStatement(PLAYERBOTS_UPD_RANDOM_BOTS, \"UPDATE playerbots_random_bots SET validIn = ? WHERE event = ? AND bot = ?\", CONNECTION_ASYNC);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_RARITY_CACHE, \"SELECT item, rarity FROM playerbots_rarity_cache\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_INS_RARITY_CACHE, \"INSERT INTO playerbots_rarity_cache (item, rarity) VALUES (?, ?)\", CONNECTION_ASYNC);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_RNDITEM_CACHE, \"SELECT lvl, type, item FROM playerbots_rnditem_cache\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_INS_RNDITEM_CACHE, \"INSERT INTO playerbots_rnditem_cache (lvl, type, item) VALUES (?, ?, ?)\", CONNECTION_ASYNC);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_SPEECH, \"SELECT name, text, type FROM playerbots_speech\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_SEL_SPEECH_PROBABILITY, \"SELECT name, probability FROM playerbots_speech_probability\", CONNECTION_SYNCH);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_TELE_CACHE, \"SELECT map_id, x, y, z, level FROM playerbots_tele_cache\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_INS_TELE_CACHE, \"INSERT INTO playerbots_tele_cache (level, map_id, x, y, z) VALUES (?, ?, ?, ?, ?)\", CONNECTION_ASYNC);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_TRAVELNODE, \"SELECT id, name, map_id, x, y, z, linked FROM playerbots_travelnode\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_INS_TRAVELNODE, \"INSERT INTO `playerbots_travelnode` (`id`, `name`, `map_id`, `x`, `y`, `z`, `linked`) VALUES (?, ?, ?, ?, ?, ?, ?)\", CONNECTION_ASYNC);\n+    PrepareStatement(PLAYERBOTS_DEL_TRAVELNODE, \"DELETE FROM playerbots_travelnode\", CONNECTION_ASYNC);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_TRAVELNODE_LINK, \"SELECT node_id, to_node_id,type,object,distance,swim_distance, extra_cost,calculated, max_creature_0,max_creature_1,max_creature_2 FROM playerbots_travelnode_link\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_INS_TRAVELNODE_LINK, \"INSERT INTO `playerbots_travelnode_link` (`node_id`, `to_node_id`,`type`,`object`,`distance`,`swim_distance`, `extra_cost`,`calculated`, `max_creature_0`,`max_creature_1`,`max_creature_2`) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\", CONNECTION_ASYNC);\n+    PrepareStatement(PLAYERBOTS_DEL_TRAVELNODE_LINK, \"DELETE FROM playerbots_travelnode_link\", CONNECTION_ASYNC);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_TRAVELNODE_PATH, \"SELECT node_id, to_node_id, nr, map_id, x, y, z FROM playerbots_travelnode_path order by node_id, to_node_id, nr\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_INS_TRAVELNODE_PATH, \"INSERT INTO `playerbots_travelnode_path` (`node_id`, `to_node_id`, `nr`, `map_id`, `x`, `y`, `z`) VALUES (?, ?, ?, ?, ?, ?, ?)\", CONNECTION_ASYNC);\n+    PrepareStatement(PLAYERBOTS_DEL_TRAVELNODE_PATH, \"DELETE FROM playerbots_travelnode_path\", CONNECTION_ASYNC);\n+\n+    PrepareStatement(PLAYERBOTS_SEL_TEXT, \"SELECT `name`, `text`, `say_type`, `reply_type`, `text_loc1`, `text_loc2`, `text_loc3`, `text_loc4`, `text_loc5`, `text_loc6`, `text_loc7`, `text_loc8` FROM `ai_playerbot_texts`\", CONNECTION_SYNCH);\n+    PrepareStatement(\n+        PLAYERBOTS_SEL_DUNGEON_SUGGESTION,\n+        \"SELECT\"\n+        \"   d.`name`, \"\n+        \"   d.`difficulty`, \"\n+        \"   d.`min_level`, \"\n+        \"   d.`max_level`, \"\n+        \"   a.`abbrevation`, \"\n+        \"   s.`strategy` \"\n+        \"FROM playerbots_dungeon_suggestion_definition d \"\n+        \"LEFT OUTER JOIN playerbots_dungeon_suggestion_abbrevation a \"\n+        \"   ON d.slug = a.definition_slug \"\n+        \"LEFT OUTER JOIN playerbots_dungeon_suggestion_strategy s \"\n+        \"   ON d.slug = s.definition_slug \"\n+        \"   AND d.difficulty = s.difficulty \"\n+        \"WHERE d.expansion &lt;= ?;\",\n+        CONNECTION_SYNCH\n+    );\n+\n+    PrepareStatement(PLAYERBOTS_SEL_WEIGHTSCALES, \"SELECT id, name, class FROM playerbots_weightscales\", CONNECTION_SYNCH);\n+    PrepareStatement(PLAYERBOTS_SEL_WEIGHTSCALE_DATA, \"SELECT id, field, val FROM playerbots_weightscale_data\", CONNECTION_SYNCH);\n+\n+    PrepareStatement(PLAYERBOTS_INS_EQUIP_CACHE_NEW, \"INSERT INTO playerbots_item_info_cache (id, quality, slot, source, sourceId, team, faction, factionRepRank, minLevel, \"\n+            \"scale_1, scale_2, scale_3, scale_4, scale_5, scale_6, scale_7, scale_8, scale_9, scale_10, scale_11, scale_12, scale_13, scale_14, scale_15, \"\n+            \"scale_16, scale_17, scale_18, scale_19, scale_20, scale_21, scale_22, scale_23, scale_24, scale_25, scale_26, scale_27, scale_28, scale_29, scale_30, scale_31, scale_32) \"\n+            \"VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\", CONNECTION_ASYNC);\n+    PrepareStatement(PLAYERBOTS_DEL_EQUIP_CACHE_NEW, \"DELETE FROM playerbots_item_info_cache WHERE id = ?\", CONNECTION_ASYNC);\n+}\n+\n+PlayerbotsDatabaseConnection::PlayerbotsDatabaseConnection(MySQLConnectionInfo&amp; connInfo) : MySQLConnection(connInfo)\n+{\n+}\n+\n+PlayerbotsDatabaseConnection::PlayerbotsDatabaseConnection(ProducerConsumerQueue&lt;SQLOperation*&gt;* q, MySQLConnectionInfo&amp; connInfo) : MySQLConnection(q, connInfo)\n+{\n+}\n+\n+PlayerbotsDatabaseConnection::~PlayerbotsDatabaseConnection()\n+{\n+}\n+\n+#endif\ndiff --git a/src/server/database/Database/Implementation/PlayerbotsDatabase.h b/src/server/database/Database/Implementation/PlayerbotsDatabase.h\nnew file mode 100644\nindex 00000000000000..4b826f23764555\n--- /dev/null\n+++ b/src/server/database/Database/Implementation/PlayerbotsDatabase.h\n@@ -0,0 +1,120 @@\n+/*\n+ * This file is part of the AzerothCore Project. See AUTHORS file for Copyright information\n+ *\n+ * This program is free software; you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation; either version 2 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n+ * more details.\n+ *\n+ * You should have received a copy of the GNU General Public License along\n+ * with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.\n+ */\n+\n+#ifdef MOD_PLAYERBOTS\n+\n+#ifndef _PlayerbotsDatabase_H\n+#define _PlayerbotsDatabase_H\n+\n+#include \"MySQLConnection.h\"\n+\n+enum PlayerbotsDatabaseStatements : uint32\n+{\n+    /*  Naming standard for defines:\n+        {DB}_{SEL/INS/UPD/DEL/REP}_{Summary of data changed}\n+        When updating more than one field, consider looking at the calling function\n+        name for a suiting suffix.\n+    */\n+\n+    PLAYERBOTS_SEL_CUSTOM_STRATEGY_BY_OWNER,\n+    PLAYERBOTS_SEL_CUSTOM_STRATEGY_BY_OWNER_AND_NAME,\n+    PLAYERBOTS_SEL_CUSTOM_STRATEGY_BY_OWNER_AND_NAME_AND_IDX,\n+    PLAYERBOTS_DEL_CUSTOM_STRATEGY,\n+    PLAYERBOTS_UPD_CUSTOM_STRATEGY,\n+    PLAYERBOTS_INS_CUSTOM_STRATEGY,\n+\n+    PLAYERBOTS_SEL_DB_STORE,\n+    PLAYERBOTS_DEL_DB_STORE,\n+    PLAYERBOTS_INS_DB_STORE,\n+\n+    PLAYERBOTS_SEL_ENCHANTS,\n+\n+    PLAYERBOTS_SEL_EQUIP_CACHE,\n+    PLAYERBOTS_INS_EQUIP_CACHE,\n+\n+    PLAYERBOTS_SEL_GUILD_TASKS_BY_VALUE,\n+    PLAYERBOTS_SEL_GUILD_TASKS_BY_OWNER,\n+    PLAYERBOTS_SEL_GUILD_TASKS_BY_OWNER_AND_TYPE,\n+    PLAYERBOTS_SEL_GUILD_TASKS_BY_OWNER_DISTINCT,\n+    PLAYERBOTS_SEL_GUILD_TASKS_BY_OWNER_ORDERED,\n+    PLAYERBOTS_DEL_GUILD_TASKS,\n+    PLAYERBOTS_INS_GUILD_TASKS,\n+\n+    PLAYERBOTS_SEL_RANDOM_BOTS_VALUE,\n+    PLAYERBOTS_SEL_RANDOM_BOTS_BOT,\n+    PLAYERBOTS_SEL_RANDOM_BOTS_BY_OWNER_AND_EVENT,\n+    PLAYERBOTS_SEL_RANDOM_BOTS_BY_OWNER_AND_BOT,\n+    PLAYERBOTS_SEL_RANDOM_BOTS_BY_EVENT_AND_VALUE,\n+    PLAYERBOTS_INS_RANDOM_BOTS,\n+    PLAYERBOTS_DEL_RANDOM_BOTS,\n+    PLAYERBOTS_DEL_RANDOM_BOTS_BY_OWNER,\n+    PLAYERBOTS_DEL_RANDOM_BOTS_BY_OWNER_AND_EVENT,\n+    PLAYERBOTS_UPD_RANDOM_BOTS,\n+\n+    PLAYERBOTS_SEL_RARITY_CACHE,\n+    PLAYERBOTS_INS_RARITY_CACHE,\n+\n+    PLAYERBOTS_SEL_RNDITEM_CACHE,\n+    PLAYERBOTS_INS_RNDITEM_CACHE,\n+\n+    PLAYERBOTS_SEL_SPEECH,\n+    PLAYERBOTS_SEL_SPEECH_PROBABILITY,\n+\n+    PLAYERBOTS_SEL_TELE_CACHE,\n+    PLAYERBOTS_INS_TELE_CACHE,\n+\n+    PLAYERBOTS_SEL_TEXT,\n+    PLAYERBOTS_SEL_DUNGEON_SUGGESTION,\n+\n+    PLAYERBOTS_SEL_TRAVELNODE,\n+    PLAYERBOTS_INS_TRAVELNODE,\n+    PLAYERBOTS_DEL_TRAVELNODE,\n+\n+    PLAYERBOTS_SEL_TRAVELNODE_LINK,\n+    PLAYERBOTS_INS_TRAVELNODE_LINK,\n+    PLAYERBOTS_DEL_TRAVELNODE_LINK,\n+\n+    PLAYERBOTS_SEL_TRAVELNODE_PATH,\n+    PLAYERBOTS_INS_TRAVELNODE_PATH,\n+    PLAYERBOTS_DEL_TRAVELNODE_PATH,\n+\n+    PLAYERBOTS_SEL_WEIGHTSCALES,\n+    PLAYERBOTS_SEL_WEIGHTSCALE_DATA,\n+\n+    PLAYERBOTS_INS_EQUIP_CACHE_NEW,\n+    PLAYERBOTS_DEL_EQUIP_CACHE_NEW,\n+\n+    MAX_PLAYERBOTS_STATEMENTS\n+};\n+\n+class AC_DATABASE_API PlayerbotsDatabaseConnection : public MySQLConnection\n+{\n+public:\n+    typedef PlayerbotsDatabaseStatements Statements;\n+\n+    //- Constructors for sync and async connections\n+    PlayerbotsDatabaseConnection(MySQLConnectionInfo&amp; connInfo);\n+    PlayerbotsDatabaseConnection(ProducerConsumerQueue&lt;SQLOperation*&gt;* q, MySQLConnectionInfo&amp; connInfo);\n+    ~PlayerbotsDatabaseConnection();\n+\n+    //- Loads database type specific prepared statements\n+    void DoPrepareStatements() override;\n+};\n+\n+#endif\n+\n+#endif\ndiff --git a/src/server/database/Updater/DBUpdater.cpp b/src/server/database/Updater/DBUpdater.cpp\nindex 4e06beb48c6fd9..a583a33a3281f7 100644\n--- a/src/server/database/Updater/DBUpdater.cpp\n+++ b/src/server/database/Updater/DBUpdater.cpp\n@@ -77,10 +77,16 @@ std::string DBUpdater&lt;LoginDatabaseConnection&gt;::GetTableName()\n     return \"Auth\";\n }\n\n+template&lt;&gt;\n+std::string DBUpdater&lt;LoginDatabaseConnection&gt;::GetSourceDirectory()\n+{\n+    return BuiltInConfig::GetSourceDirectory();\n+}\n+\n template&lt;&gt;\n std::string DBUpdater&lt;LoginDatabaseConnection&gt;::GetBaseFilesDirectory()\n {\n-    return BuiltInConfig::GetSourceDirectory() + \"/data/sql/base/db_auth/\";\n+    return DBUpdater&lt;LoginDatabaseConnection&gt;::GetSourceDirectory() + \"/data/sql/base/db_auth/\";\n }\n\n template&lt;&gt;\n@@ -93,7 +99,7 @@ bool DBUpdater&lt;LoginDatabaseConnection&gt;::IsEnabled(uint32 const updateMask)\n template&lt;&gt;\n std::string DBUpdater&lt;LoginDatabaseConnection&gt;::GetDBModuleName()\n {\n-    return \"db-auth\";\n+    return \"auth\";\n }\n\n // World Database\n@@ -109,10 +115,16 @@ std::string DBUpdater&lt;WorldDatabaseConnection&gt;::GetTableName()\n     return \"World\";\n }\n\n+template&lt;&gt;\n+std::string DBUpdater&lt;WorldDatabaseConnection&gt;::GetSourceDirectory()\n+{\n+    return BuiltInConfig::GetSourceDirectory();\n+}\n+\n template&lt;&gt;\n std::string DBUpdater&lt;WorldDatabaseConnection&gt;::GetBaseFilesDirectory()\n {\n-    return BuiltInConfig::GetSourceDirectory() + \"/data/sql/base/db_world/\";\n+    return DBUpdater&lt;WorldDatabaseConnection&gt;::GetSourceDirectory() + \"/data/sql/base/db_world/\";\n }\n\n template&lt;&gt;\n@@ -125,7 +137,7 @@ bool DBUpdater&lt;WorldDatabaseConnection&gt;::IsEnabled(uint32 const updateMask)\n template&lt;&gt;\n std::string DBUpdater&lt;WorldDatabaseConnection&gt;::GetDBModuleName()\n {\n-    return \"db-world\";\n+    return \"world\";\n }\n\n // Character Database\n@@ -141,10 +153,16 @@ std::string DBUpdater&lt;CharacterDatabaseConnection&gt;::GetTableName()\n     return \"Character\";\n }\n\n+template&lt;&gt;\n+std::string DBUpdater&lt;CharacterDatabaseConnection&gt;::GetSourceDirectory()\n+{\n+    return BuiltInConfig::GetSourceDirectory();\n+}\n+\n template&lt;&gt;\n std::string DBUpdater&lt;CharacterDatabaseConnection&gt;::GetBaseFilesDirectory()\n {\n-    return BuiltInConfig::GetSourceDirectory() + \"/data/sql/base/db_characters/\";\n+    return DBUpdater&lt;CharacterDatabaseConnection&gt;::GetSourceDirectory() + \"/data/sql/base/db_characters/\";\n }\n\n template&lt;&gt;\n@@ -157,9 +175,49 @@ bool DBUpdater&lt;CharacterDatabaseConnection&gt;::IsEnabled(uint32 const updateMask)\n template&lt;&gt;\n std::string DBUpdater&lt;CharacterDatabaseConnection&gt;::GetDBModuleName()\n {\n-    return \"db-characters\";\n+    return \"characters\";\n+}\n+\n+#ifdef MOD_PLAYERBOTS\n+// Playerbots Database\n+template&lt;&gt;\n+std::string DBUpdater&lt;PlayerbotsDatabaseConnection&gt;::GetConfigEntry()\n+{\n+    return \"Updates.Playerbots\";\n+}\n+\n+template&lt;&gt;\n+std::string DBUpdater&lt;PlayerbotsDatabaseConnection&gt;::GetTableName()\n+{\n+    return \"Playerbots\";\n }\n\n+template&lt;&gt;\n+std::string DBUpdater&lt;PlayerbotsDatabaseConnection&gt;::GetSourceDirectory()\n+{\n+    return BuiltInConfig::GetSourceDirectory() + \"/modules/mod-playerbots\";\n+}\n+\n+template&lt;&gt;\n+std::string DBUpdater&lt;PlayerbotsDatabaseConnection&gt;::GetBaseFilesDirectory()\n+{\n+    return DBUpdater&lt;PlayerbotsDatabaseConnection&gt;::GetSourceDirectory() + \"/data/sql/playerbots/base/\";\n+}\n+\n+template&lt;&gt;\n+bool DBUpdater&lt;PlayerbotsDatabaseConnection&gt;::IsEnabled(uint32 const updateMask)\n+{\n+    // This way silences warnings under msvc\n+    return (updateMask &amp; DatabaseLoader::DATABASE_PLAYERBOTS) ? true : false;\n+}\n+\n+template&lt;&gt;\n+std::string DBUpdater&lt;PlayerbotsDatabaseConnection&gt;::GetDBModuleName()\n+{\n+    return \"db_playerbot\";\n+}\n+#endif\n+\n // All\n template&lt;class T&gt;\n BaseLocation DBUpdater&lt;T&gt;::GetBaseLocationType()\n@@ -225,7 +283,7 @@ bool DBUpdater&lt;T&gt;::Update(DatabaseWorkerPool&lt;T&gt;&amp; pool, std::string_view modulesL\n\n     LOG_INFO(\"sql.updates\", \"Updating {} database...\", DBUpdater&lt;T&gt;::GetTableName());\n\n-    Path const sourceDirectory(BuiltInConfig::GetSourceDirectory());\n+    Path const sourceDirectory(DBUpdater&lt;T&gt;::GetSourceDirectory());\n\n     if (!is_directory(sourceDirectory))\n     {\n@@ -300,7 +358,7 @@ bool DBUpdater&lt;T&gt;::Update(DatabaseWorkerPool&lt;T&gt;&amp; pool, std::vector&lt;std::string&gt;\n         return false;\n     }\n\n-    Path const sourceDirectory(BuiltInConfig::GetSourceDirectory());\n+    Path const sourceDirectory(DBUpdater&lt;T&gt;::GetSourceDirectory());\n     if (!is_directory(sourceDirectory))\n     {\n         return false;\n@@ -534,3 +592,7 @@ void DBUpdater&lt;T&gt;::ApplyFile(DatabaseWorkerPool&lt;T&gt;&amp; pool, std::string const&amp; hos\n template class AC_DATABASE_API DBUpdater&lt;LoginDatabaseConnection&gt;;\n template class AC_DATABASE_API DBUpdater&lt;WorldDatabaseConnection&gt;;\n template class AC_DATABASE_API DBUpdater&lt;CharacterDatabaseConnection&gt;;\n+\n+#ifdef MOD_PLAYERBOTS\n+template class AC_DATABASE_API DBUpdater&lt;PlayerbotsDatabaseConnection&gt;;\n+#endif\ndiff --git a/src/server/database/Updater/DBUpdater.h b/src/server/database/Updater/DBUpdater.h\nindex 58ebf332018376..3a0e58709ea692 100644\n--- a/src/server/database/Updater/DBUpdater.h\n+++ b/src/server/database/Updater/DBUpdater.h\n@@ -72,6 +72,7 @@ class AC_DATABASE_API DBUpdater\n\n     static inline std::string GetConfigEntry();\n     static inline std::string GetTableName();\n+    static std::string GetSourceDirectory();\n     static std::string GetBaseFilesDirectory();\n     static bool IsEnabled(uint32 const updateMask);\n     static BaseLocation GetBaseLocationType();\ndiff --git a/src/server/game/Battlegrounds/ArenaTeam.cpp b/src/server/game/Battlegrounds/ArenaTeam.cpp\nindex 985193f9d54952..0e4dd3fde0069d 100644\n--- a/src/server/game/Battlegrounds/ArenaTeam.cpp\n+++ b/src/server/game/Battlegrounds/ArenaTeam.cpp\n@@ -1103,3 +1103,22 @@ std::unordered_map&lt;uint8, uint8&gt; ArenaTeam::ArenaReqPlayersForType =\n     { ARENA_TYPE_3v3, 6},\n     { ARENA_TYPE_5v5, 10}\n };\n+\n+void ArenaTeam::SetEmblem(uint32 backgroundColor, uint8 emblemStyle, uint32 emblemColor, uint8 borderStyle, uint32 borderColor)\n+{\n+    BackgroundColor = backgroundColor;\n+    EmblemStyle = emblemStyle;\n+    EmblemColor = emblemColor;\n+    BorderStyle = borderStyle;\n+    BorderColor = borderColor;\n+}\n+\n+void ArenaTeam::SetRatingForAll(uint32 rating)\n+{\n+    Stats.Rating = rating;\n+\n+    for (MemberList::iterator itr = Members.begin(); itr != Members.end(); ++itr)\n+    {\n+        itr-&gt;PersonalRating = rating;\n+    }\n+}\ndiff --git a/src/server/game/Battlegrounds/ArenaTeam.h b/src/server/game/Battlegrounds/ArenaTeam.h\nindex 33c47920e28159..a0ec07397b133d 100644\n--- a/src/server/game/Battlegrounds/ArenaTeam.h\n+++ b/src/server/game/Battlegrounds/ArenaTeam.h\n@@ -217,6 +217,10 @@ class ArenaTeam\n     static std::unordered_map&lt;uint32, uint8&gt; ArenaSlotByType; // Slot -&gt; Type\n     static std::unordered_map&lt;uint8, uint8&gt; ArenaReqPlayersForType; // Type -&gt; Players count\n\n+    void SetEmblem(uint32 backgroundColor, uint8 emblemStyle, uint32 emblemColor, uint8 borderStyle, uint32 borderColor);\n+    void SetRatingForAll(uint32 rating);\n+\n+\n protected:\n     uint32      TeamId;\n     uint8       Type;\ndiff --git a/src/server/game/Battlegrounds/Battleground.h b/src/server/game/Battlegrounds/Battleground.h\nindex b22cdc143adccb..6178869f547f1c 100644\n--- a/src/server/game/Battlegrounds/Battleground.h\n+++ b/src/server/game/Battlegrounds/Battleground.h\n@@ -205,6 +205,7 @@ struct BattlegroundObjectInfo\n\n enum ArenaType : uint8\n {\n+    ARENA_TYPE_NONE                 = 0,\n     ARENA_TYPE_2v2                  = 2,\n     ARENA_TYPE_3v3                  = 3,\n     ARENA_TYPE_5v5                  = 5\ndiff --git a/src/server/game/Battlegrounds/Zones/BattlegroundAB.h b/src/server/game/Battlegrounds/Zones/BattlegroundAB.h\nindex 72932386a1587b..92e58975e23e7b 100644\n--- a/src/server/game/Battlegrounds/Zones/BattlegroundAB.h\n+++ b/src/server/game/Battlegrounds/Zones/BattlegroundAB.h\n@@ -246,6 +246,18 @@ struct BattlegroundABScore final : public BattlegroundScore\n     uint32 BasesDefended = 0;\n };\n\n+struct CaptureABPointInfo\n+{\n+    CaptureABPointInfo() : _ownerTeamId(TEAM_NEUTRAL), _iconNone(0), _iconCapture(0), _state(BG_AB_NODE_STATE_NEUTRAL), _captured(false) {}\n+\n+    TeamId _ownerTeamId;\n+    uint32 _iconNone;\n+    uint32 _iconCapture;\n+    uint8  _state;\n+\n+    bool _captured;\n+};\n+\n class AC_GAME_API BattlegroundAB : public Battleground\n {\n public:\n@@ -270,6 +282,9 @@ class AC_GAME_API BattlegroundAB : public Battleground\n     bool IsTeamScores500Disadvantage(TeamId teamId) const { return _teamScores500Disadvantage[teamId]; }\n\n     TeamId GetPrematureWinner() override;\n+\n+    [[nodiscard]] CaptureABPointInfo const&amp; GetCapturePointInfo(uint32 node) const { return _capturePointInfo[node]; }\n+\n private:\n     void PostUpdateImpl(uint32 diff) override;\n\n@@ -280,21 +295,7 @@ class AC_GAME_API BattlegroundAB : public Battleground\n     void NodeDeoccupied(uint8 node);\n     void ApplyPhaseMask();\n\n-    struct CapturePointInfo\n-    {\n-        CapturePointInfo() : _ownerTeamId(TEAM_NEUTRAL), _iconNone(0), _iconCapture(0), _state(BG_AB_NODE_STATE_NEUTRAL), _captured(false)\n-        {\n-        }\n-\n-        TeamId _ownerTeamId;\n-        uint32 _iconNone;\n-        uint32 _iconCapture;\n-        uint8 _state;\n-\n-        bool _captured;\n-    };\n-\n-    CapturePointInfo _capturePointInfo[BG_AB_DYNAMIC_NODES_COUNT];\n+    CaptureABPointInfo _capturePointInfo[BG_AB_DYNAMIC_NODES_COUNT];\n     EventMap _bgEvents;\n     uint32 _honorTics;\n     uint32 _reputationTics;\ndiff --git a/src/server/game/Battlegrounds/Zones/BattlegroundAV.h b/src/server/game/Battlegrounds/Zones/BattlegroundAV.h\nindex 57417dd1db3d46..eec6ff05874d94 100644\n--- a/src/server/game/Battlegrounds/Zones/BattlegroundAV.h\n+++ b/src/server/game/Battlegrounds/Zones/BattlegroundAV.h\n@@ -1791,6 +1791,10 @@ class AC_GAME_API BattlegroundAV : public Battleground\n\n     TeamId GetPrematureWinner() override;\n\n+    [[nodiscard]] BG_AV_NodeInfo const&amp; GetAVNodeInfo(uint32 node) const { return m_Nodes[node]; }\n+    [[nodiscard]] bool IsCaptainAlive(uint8 index) const { return m_CaptainAlive[index]; }\n+    [[nodiscard]] TeamId GetMineOwner(uint8 index) const { return m_Mine_Owner[index]; }\n+\n private:\n     void PostUpdateImpl(uint32 diff) override;\n\ndiff --git a/src/server/game/Battlegrounds/Zones/BattlegroundEY.h b/src/server/game/Battlegrounds/Zones/BattlegroundEY.h\nindex 2730a060411690..b4da9d7f53fea6 100644\n--- a/src/server/game/Battlegrounds/Zones/BattlegroundEY.h\n+++ b/src/server/game/Battlegrounds/Zones/BattlegroundEY.h\n@@ -346,6 +346,25 @@ struct BattlegroundEYScore final : public BattlegroundScore\n     uint32 FlagCaptures = 0;\n };\n\n+struct CaptureEYPointInfo\n+{\n+    CaptureEYPointInfo() : _ownerTeamId(TEAM_NEUTRAL), _barStatus(BG_EY_PROGRESS_BAR_STATE_MIDDLE), _areaTrigger(0)\n+    {\n+        _playersCount[TEAM_ALLIANCE] = 0;\n+        _playersCount[TEAM_HORDE] = 0;\n+    }\n+\n+    Player* player = nullptr;\n+    TeamId _ownerTeamId;\n+    int8 _barStatus;\n+    uint32 _areaTrigger;\n+    int8 _playersCount[PVP_TEAMS_COUNT];\n+\n+    bool IsUnderControl(TeamId teamId) const { return _ownerTeamId == teamId; }\n+    bool IsUnderControl() const { return _ownerTeamId != TEAM_NEUTRAL; }\n+    bool IsUncontrolled() const { return _ownerTeamId == TEAM_NEUTRAL; }\n+};\n+\n class AC_GAME_API BattlegroundEY : public Battleground\n {\n public:\n@@ -385,6 +404,8 @@ class AC_GAME_API BattlegroundEY : public Battleground\n     bool AllNodesConrolledByTeam(TeamId teamId) const override;\n     TeamId GetPrematureWinner() override;\n\n+    [[nodiscard]] CaptureEYPointInfo const&amp; GetCapturePointInfo(uint32 node) const { return _capturePointInfo[node]; }\n+\n private:\n     void PostUpdateImpl(uint32 diff) override;\n\n@@ -400,26 +421,7 @@ class AC_GAME_API BattlegroundEY : public Battleground\n     /* Scorekeeping */\n     void AddPoints(TeamId teamId, uint32 points);\n\n-    struct CapturePointInfo\n-    {\n-        CapturePointInfo() : _ownerTeamId(TEAM_NEUTRAL), _barStatus(BG_EY_PROGRESS_BAR_STATE_MIDDLE), _areaTrigger(0)\n-        {\n-            _playersCount[TEAM_ALLIANCE] = 0;\n-            _playersCount[TEAM_HORDE] = 0;\n-        }\n-\n-        TeamId _ownerTeamId;\n-        int8 _barStatus;\n-        uint32 _areaTrigger;\n-        int8 _playersCount[PVP_TEAMS_COUNT];\n-        Player* player = nullptr;\n-\n-        bool IsUnderControl(TeamId teamId) const { return _ownerTeamId == teamId; }\n-        bool IsUnderControl() const { return _ownerTeamId != TEAM_NEUTRAL; }\n-        bool IsUncontrolled() const { return _ownerTeamId == TEAM_NEUTRAL; }\n-    };\n-\n-    CapturePointInfo _capturePointInfo[EY_POINTS_MAX];\n+    CaptureEYPointInfo _capturePointInfo[EY_POINTS_MAX];\n     EventMap _bgEvents;\n     uint32 _honorTics;\n     uint8 _ownedPointsCount[PVP_TEAMS_COUNT];\ndiff --git a/src/server/game/Battlegrounds/Zones/BattlegroundIC.h b/src/server/game/Battlegrounds/Zones/BattlegroundIC.h\nindex 9f859ddfe07a06..bc5daf8fc925a8 100644\n--- a/src/server/game/Battlegrounds/Zones/BattlegroundIC.h\n+++ b/src/server/game/Battlegrounds/Zones/BattlegroundIC.h\n@@ -922,6 +922,9 @@ class AC_GAME_API BattlegroundIC : public Battleground\n     bool AllNodesConrolledByTeam(TeamId teamId) const override;  // overwrited\n     bool IsResourceGlutAllowed(TeamId teamId) const;\n     void DoAction(uint32 action, ObjectGuid guid) override;\n+\n+    [[nodiscard]] ICNodePoint const&amp; GetICNodePoint(uint8 index) { return nodePoint[index]; }\n+\n private:\n     uint32 closeFortressDoorsTimer;\n     bool doorsClosed;\ndiff --git a/src/server/game/Chat/Channels/ChannelMgr.h b/src/server/game/Chat/Channels/ChannelMgr.h\nindex daf595d2f6071f..868f2a1717e1f8 100644\n--- a/src/server/game/Chat/Channels/ChannelMgr.h\n+++ b/src/server/game/Chat/Channels/ChannelMgr.h\n@@ -40,6 +40,7 @@ class ChannelMgr\n\n     Channel* GetJoinChannel(std::string const&amp; name, uint32 channel_id);\n     Channel* GetChannel(std::string const&amp; name, Player* p, bool pkt = true);\n+    const ChannelMap&amp; GetChannels() const { return channels; }\n     static void LoadChannels();\n\n     static void LoadChannelRights();\ndiff --git a/src/server/game/Chat/Chat.cpp b/src/server/game/Chat/Chat.cpp\nindex a0dc7f090d9682..33892e072d837f 100644\n--- a/src/server/game/Chat/Chat.cpp\n+++ b/src/server/game/Chat/Chat.cpp\n@@ -371,6 +371,78 @@ std::size_t ChatHandler::BuildChatPacket(WorldPacket&amp; data, ChatMsg chatType, La\n     return BuildChatPacket(data, chatType, language, senderGUID, receiverGUID, message, chatTag, senderName, receiverName, achievementId, gmMessage, channelName);\n }\n\n+void ChatHandler::BuildChatPacket(WorldPacket&amp; data, ChatMsg msgtype, std::string_view message, Language language /*= LANG_UNIVERSAL*/, PlayerChatTag chatTag /*= CHAT_TAG_NONE*/,\n+                                  ObjectGuid const&amp; senderGuid /*= ObjectGuid()*/, std::string_view senderName /*= nullptr*/,\n+                                  ObjectGuid const&amp; targetGuid /*= ObjectGuid()*/, std::string_view targetName /*= nullptr*/,\n+                                  std::string_view channelName /*= nullptr*/, uint32 achievementId /*= 0*/)\n+{\n+    const bool isGM = (chatTag &amp; CHAT_TAG_GM) != 0;\n+    bool isAchievement = false;\n+\n+    data.Initialize((isGM &amp;&amp; language != LANG_ADDON) ? SMSG_GM_MESSAGECHAT : SMSG_MESSAGECHAT);\n+    data &lt;&lt; uint8(msgtype);\n+    data &lt;&lt; uint32(language);\n+    data &lt;&lt; ObjectGuid(senderGuid);\n+    data &lt;&lt; uint32(0);                                              // 2.1.0\n+\n+    switch (msgtype)\n+    {\n+        case CHAT_MSG_MONSTER_SAY:\n+        case CHAT_MSG_MONSTER_PARTY:\n+        case CHAT_MSG_MONSTER_YELL:\n+        case CHAT_MSG_MONSTER_WHISPER:\n+        case CHAT_MSG_MONSTER_EMOTE:\n+        case CHAT_MSG_RAID_BOSS_WHISPER:\n+        case CHAT_MSG_RAID_BOSS_EMOTE:\n+        case CHAT_MSG_BATTLENET:\n+        case CHAT_MSG_WHISPER_FOREIGN:\n+            data &lt;&lt; uint32(senderName.size() + 1);\n+            data &lt;&lt; senderName;\n+            data &lt;&lt; ObjectGuid(targetGuid);                         // Unit Target\n+            if (targetGuid &amp;&amp; !targetGuid.IsPlayer() &amp;&amp; !targetGuid.IsPet() &amp;&amp; (msgtype != CHAT_MSG_WHISPER_FOREIGN))\n+            {\n+                data &lt;&lt; uint32(targetName.size() + 1);              // target name length\n+                data &lt;&lt; targetName;                                 // target name\n+            }\n+            break;\n+        case CHAT_MSG_BG_SYSTEM_NEUTRAL:\n+        case CHAT_MSG_BG_SYSTEM_ALLIANCE:\n+        case CHAT_MSG_BG_SYSTEM_HORDE:\n+            data &lt;&lt; ObjectGuid(targetGuid);                         // Unit Target\n+            if (targetGuid &amp;&amp; !targetGuid.IsPlayer())\n+            {\n+                data &lt;&lt; uint32(targetName.size() + 1);              // target name length\n+                data &lt;&lt; targetName;                                 // target name\n+            }\n+            break;\n+        case CHAT_MSG_ACHIEVEMENT:\n+        case CHAT_MSG_GUILD_ACHIEVEMENT:\n+            data &lt;&lt; ObjectGuid(targetGuid);                         // Unit Target\n+            isAchievement = true;\n+            break;\n+        default:\n+            if (isGM)\n+            {\n+                data &lt;&lt; uint32(senderName.size() + 1);\n+                data &lt;&lt; senderName;\n+            }\n+\n+            if (msgtype == CHAT_MSG_CHANNEL)\n+            {\n+                data &lt;&lt; channelName;\n+            }\n+            data &lt;&lt; ObjectGuid(targetGuid);\n+            break;\n+    }\n+    data &lt;&lt; uint32(message.size() + 1);\n+    data &lt;&lt; message;\n+    data &lt;&lt; uint8(chatTag);\n+\n+    if (isAchievement)\n+        data &lt;&lt; uint32(achievementId);\n+}\n+\n+\n Player* ChatHandler::getSelectedPlayer() const\n {\n     if (!m_session)\ndiff --git a/src/server/game/Chat/Chat.h b/src/server/game/Chat/Chat.h\nindex e2891a3b836775..ce733b3a57beb6 100644\n--- a/src/server/game/Chat/Chat.h\n+++ b/src/server/game/Chat/Chat.h\n@@ -47,6 +47,13 @@ class AC_GAME_API ChatHandler\n     // Builds chat packet and returns receiver guid position in the packet to substitute in whisper builders\n     static std::size_t BuildChatPacket(WorldPacket&amp; data, ChatMsg chatType, Language language, WorldObject const* sender, WorldObject const* receiver, std::string_view message, uint32 achievementId = 0, std::string const&amp; channelName = \"\", LocaleConstant locale = DEFAULT_LOCALE);\n\n+    // All in one chat message builder\n+    static void BuildChatPacket(\n+            WorldPacket&amp; data, ChatMsg msgtype, std::string_view message, Language language = LANG_UNIVERSAL, PlayerChatTag chatTag = CHAT_TAG_NONE,\n+            ObjectGuid const&amp; senderGuid = ObjectGuid(), std::string_view senderName = {},\n+            ObjectGuid const&amp; targetGuid = ObjectGuid(), std::string_view targetName = {},\n+            std::string_view channelName = {}, uint32 achievementId = 0);\n+\n     static char* LineFromMessage(char*&amp; pos) { char* start = strtok(pos, \"\\n\"); pos = nullptr; return start; }\n\n     void SendNotification(std::string_view str);\ndiff --git a/src/server/game/DataStores/DBCStores.cpp b/src/server/game/DataStores/DBCStores.cpp\nindex 7aa7413325292d..7cb68e1e431d8f 100644\n--- a/src/server/game/DataStores/DBCStores.cpp\n+++ b/src/server/game/DataStores/DBCStores.cpp\n@@ -34,11 +34,16 @@ typedef std::map&lt;uint32, uint32&gt; AreaFlagByMapID;\n typedef std::tuple&lt;int16, int8, int32&gt; WMOAreaTableKey;\n typedef std::map&lt;WMOAreaTableKey, WMOAreaTableEntry const*&gt; WMOAreaInfoByTripple;\n\n+typedef std::multimap&lt;uint32, CharSectionsEntry const*&gt; CharSectionsMap;\n+\n DBCStorage &lt;AreaTableEntry&gt; sAreaTableStore(AreaTableEntryfmt);\n DBCStorage &lt;AreaGroupEntry&gt; sAreaGroupStore(AreaGroupEntryfmt);\n DBCStorage &lt;AreaPOIEntry&gt; sAreaPOIStore(AreaPOIEntryfmt);\n\n static WMOAreaInfoByTripple sWMOAreaInfoByTripple;\n+static AreaFlagByAreaID sAreaFlagByAreaID;\n+// for instances without generated *.map files\n+static AreaFlagByMapID  sAreaFlagByMapID;\n\n DBCStorage &lt;AchievementEntry&gt; sAchievementStore(Achievementfmt);\n DBCStorage &lt;AchievementCategoryEntry&gt; sAchievementCategoryStore(AchievementCategoryfmt);\n@@ -49,6 +54,10 @@ DBCStorage &lt;BattlemasterListEntry&gt; sBattlemasterListStore(BattlemasterListEntryf\n DBCStorage &lt;BarberShopStyleEntry&gt; sBarberShopStyleStore(BarberShopStyleEntryfmt);\n DBCStorage &lt;CharStartOutfitEntry&gt; sCharStartOutfitStore(CharStartOutfitEntryfmt);\n std::map&lt;uint32, CharStartOutfitEntry const*&gt; sCharStartOutfitMap;\n+\n+DBCStorage &lt;CharSectionsEntry&gt; sCharSectionsStore(CharSectionsEntryfmt);\n+CharSectionsMap sCharSectionMap;\n+\n DBCStorage &lt;CharTitlesEntry&gt; sCharTitlesStore(CharTitlesEntryfmt);\n DBCStorage &lt;ChatChannelsEntry&gt; sChatChannelsStore(ChatChannelsEntryfmt);\n DBCStorage &lt;ChrClassesEntry&gt; sChrClassesStore(ChrClassesEntryfmt);\n@@ -71,6 +80,10 @@ DBCStorage &lt;DurabilityCostsEntry&gt; sDurabilityCostsStore(DurabilityCostsfmt);\n DBCStorage &lt;EmotesEntry&gt; sEmotesStore(EmotesEntryfmt);\n DBCStorage &lt;EmotesTextEntry&gt; sEmotesTextStore(EmotesTextEntryfmt);\n\n+typedef std::tuple&lt;uint32, uint32, uint32&gt; EmotesTextSoundKey;\n+static std::map&lt;EmotesTextSoundKey, EmotesTextSoundEntry const*&gt; sEmotesTextSoundMap;\n+DBCStorage &lt;EmotesTextSoundEntry&gt; sEmotesTextSoundStore(EmotesTextSoundEntryfmt);\n+\n typedef std::map&lt;uint32, SimpleFactionsList&gt; FactionTeamMap;\n static FactionTeamMap sFactionTeamMap;\n DBCStorage &lt;FactionEntry&gt; sFactionStore(FactionEntryfmt);\n@@ -280,6 +293,7 @@ void LoadDBCStores(const std::string&amp; dataPath)\n     LOAD_DBC(sBattlemasterListStore,                \"BattlemasterList.dbc\",                 \"battlemasterlist_dbc\");\n     LOAD_DBC(sBarberShopStyleStore,                 \"BarberShopStyle.dbc\",                  \"barbershopstyle_dbc\");\n     LOAD_DBC(sCharStartOutfitStore,                 \"CharStartOutfit.dbc\",                  \"charstartoutfit_dbc\");\n+    LOAD_DBC(sCharSectionsStore,                    \"CharSections.dbc\",                     \"charsections_dbc\");\n     LOAD_DBC(sCharTitlesStore,                      \"CharTitles.dbc\",                       \"chartitles_dbc\");\n     LOAD_DBC(sChatChannelsStore,                    \"ChatChannels.dbc\",                     \"chatchannels_dbc\");\n     LOAD_DBC(sChrClassesStore,                      \"ChrClasses.dbc\",                       \"chrclasses_dbc\");\n@@ -299,6 +313,7 @@ void LoadDBCStores(const std::string&amp; dataPath)\n     LOAD_DBC(sDurabilityQualityStore,               \"DurabilityQuality.dbc\",                \"durabilityquality_dbc\");\n     LOAD_DBC(sEmotesStore,                          \"Emotes.dbc\",                           \"emotes_dbc\");\n     LOAD_DBC(sEmotesTextStore,                      \"EmotesText.dbc\",                       \"emotestext_dbc\");\n+    LOAD_DBC(sEmotesTextSoundStore,                 \"EmotesTextSound.dbc\",                  \"emotetextsound_dbc\");\n     LOAD_DBC(sFactionStore,                         \"Faction.dbc\",                          \"faction_dbc\");\n     LOAD_DBC(sFactionTemplateStore,                 \"FactionTemplate.dbc\",                  \"factiontemplate_dbc\");\n     LOAD_DBC(sGameObjectArtKitStore,                \"GameObjectArtKit.dbc\",                 \"gameobjectartkit_dbc\");\n@@ -384,9 +399,26 @@ void LoadDBCStores(const std::string&amp; dataPath)\n\n #undef LOAD_DBC\n\n+    for (uint32 i = 0; i &lt; sAreaTableStore.GetNumRows(); ++i)    // areaflag numbered from 0\n+    {\n+        if (AreaTableEntry const* area = sAreaTableStore.LookupEntry(i))\n+        {\n+            // fill AreaId-&gt;DBC records\n+            sAreaFlagByAreaID.insert(AreaFlagByAreaID::value_type(uint16(area-&gt;ID), area-&gt;exploreFlag));\n+\n+            // fill MapId-&gt;DBC records ( skip sub zones and continents )\n+            if (area-&gt;zone == 0 &amp;&amp; area-&gt;mapid != 0 &amp;&amp; area-&gt;mapid != 1 &amp;&amp; area-&gt;mapid != 530)\n+                sAreaFlagByMapID.insert(AreaFlagByMapID::value_type(area-&gt;mapid, area-&gt;exploreFlag));\n+        }\n+    }\n+\n     for (CharStartOutfitEntry const* outfit : sCharStartOutfitStore)\n         sCharStartOutfitMap[outfit-&gt;Race | (outfit-&gt;Class &lt;&lt; 8) | (outfit-&gt;Gender &lt;&lt; 16)] = outfit;\n\n+    for (CharSectionsEntry const* charSection : sCharSectionsStore)\n+        if (charSection-&gt;Race &amp;&amp; ((1 &lt;&lt; (charSection-&gt;Race - 1)) &amp; RACEMASK_ALL_PLAYABLE) != 0) //ignore Nonplayable races\n+            sCharSectionMap.insert({ charSection-&gt;GenType | (charSection-&gt;Gender &lt;&lt; 8) | (charSection-&gt;Race &lt;&lt; 16), charSection });\n+\n     for (FactionEntry const* faction : sFactionStore)\n     {\n         if (faction-&gt;team)\n@@ -408,6 +440,9 @@ void LoadDBCStores(const std::string&amp; dataPath)\n             std::swap(*(float*)(&amp;info-&gt;maxZ), *(float*)(&amp;info-&gt;minZ));\n     }\n\n+    for (EmotesTextSoundEntry const* emoteTextSound : sEmotesTextSoundStore)\n+        sEmotesTextSoundMap[EmotesTextSoundKey(emoteTextSound-&gt;EmotesTextId, emoteTextSound-&gt;RaceId, emoteTextSound-&gt;SexId)] = emoteTextSound;\n+\n     // fill data\n     for (MapDifficultyEntry const* entry : sMapDifficultyStore)\n         sMapDifficultyMap[MAKE_PAIR32(entry-&gt;MapId, entry-&gt;Difficulty)] = MapDifficulty(entry-&gt;resetTime, entry-&gt;maxPlayers, entry-&gt;areaTriggerText[0] != '\\0');\n@@ -848,6 +883,18 @@ CharStartOutfitEntry const* GetCharStartOutfitEntry(uint8 race, uint8 class_, ui\n     return itr-&gt;second;\n }\n\n+CharSectionsEntry const* GetCharSectionEntry(uint8 race, CharSectionType genType, uint8 gender, uint8 type, uint8 color)\n+{\n+    std::pair&lt;CharSectionsMap::const_iterator, CharSectionsMap::const_iterator&gt; eqr = sCharSectionMap.equal_range(uint32(genType) | uint32(gender &lt;&lt; 8) | uint32(race &lt;&lt; 16));\n+    for (CharSectionsMap::const_iterator itr = eqr.first; itr != eqr.second; ++itr)\n+    {\n+        if (itr-&gt;second-&gt;Type == type &amp;&amp; itr-&gt;second-&gt;Color == color)\n+            return itr-&gt;second;\n+    }\n+\n+    return nullptr;\n+}\n+\n /// Returns LFGDungeonEntry for a specific map and difficulty. Will return first found entry if multiple dungeons use the same map (such as Scarlet Monastery)\n LFGDungeonEntry const* GetLFGDungeon(uint32 mapId, Difficulty difficulty)\n {\n@@ -913,6 +960,12 @@ SkillRaceClassInfoEntry const* GetSkillRaceClassInfo(uint32 skill, uint8 race, u\n     return nullptr;\n }\n\n+EmotesTextSoundEntry const* FindTextSoundEmoteFor(uint32 emote, uint32 race, uint32 gender)\n+{\n+    auto itr = sEmotesTextSoundMap.find(EmotesTextSoundKey(emote, race, gender));\n+    return itr != sEmotesTextSoundMap.end() ? itr-&gt;second : nullptr;\n+}\n+\n const std::vector&lt;SkillLineAbilityEntry const*&gt;&amp; GetSkillLineAbilitiesBySkillLine(uint32 skillLine)\n {\n     auto it = sSkillLineAbilityIndexBySkillLine.find(skillLine);\n@@ -923,3 +976,40 @@ const std::vector&lt;SkillLineAbilityEntry const*&gt;&amp; GetSkillLineAbilitiesBySkillLin\n     }\n     return it-&gt;second;\n }\n+\n+uint32 GetAreaFlagByMapId(uint32 mapid)\n+{\n+    AreaFlagByMapID::iterator i = sAreaFlagByMapID.find(mapid);\n+    if (i == sAreaFlagByMapID.end())\n+        return 0;\n+    return i-&gt;second;\n+}\n+\n+int32 GetAreaFlagByAreaID(uint32 area_id)\n+{\n+    AreaFlagByAreaID::iterator i = sAreaFlagByAreaID.find(area_id);\n+    if (i == sAreaFlagByAreaID.end())\n+        return -1;\n+\n+    return i-&gt;second;\n+}\n+\n+AreaTableEntry const* GetAreaEntryByAreaID(uint32 area_id)\n+{\n+    int32 areaflag = GetAreaFlagByAreaID(area_id);\n+    if (areaflag &lt; 0)\n+        return nullptr;\n+\n+    return sAreaTableStore.LookupEntry(areaflag);\n+}\n+\n+AreaTableEntry const* GetAreaEntryByAreaFlagAndMap(uint32 area_flag, uint32 map_id)\n+{\n+    if (area_flag)\n+        return sAreaTableStore.LookupEntry(area_flag);\n+\n+    if (MapEntry const* mapEntry = sMapStore.LookupEntry(map_id))\n+        return GetAreaEntryByAreaID(mapEntry-&gt;linked_zone);\n+\n+    return nullptr;\n+}\n\\ No newline at end of file\ndiff --git a/src/server/game/DataStores/DBCStores.h b/src/server/game/DataStores/DBCStores.h\nindex ec8cb68bbcbe43..011a9cbab766b2 100644\n--- a/src/server/game/DataStores/DBCStores.h\n+++ b/src/server/game/DataStores/DBCStores.h\n@@ -35,6 +35,13 @@ TalentSpellPos const* GetTalentSpellPos(uint32 spellId);\n\n WMOAreaTableEntry const* GetWMOAreaTableEntryByTripple(int32 rootid, int32 adtid, int32 groupid);\n\n+\n+// -1 if not found\n+int32 GetAreaFlagByAreaID(uint32 area_id);\n+uint32 GetAreaFlagByMapId(uint32 mapid);\n+AreaTableEntry const* GetAreaEntryByAreaID(uint32 area_id);\n+AreaTableEntry const* GetAreaEntryByAreaFlagAndMap(uint32 area_flag, uint32 map_id);\n+\n uint32 GetVirtualMapForMapAndZone(uint32 mapid, uint32 zoneId);\n\n enum ContentLevels : uint8\n@@ -63,6 +70,8 @@ PvPDifficultyEntry const* GetBattlegroundBracketById(uint32 mapid, BattlegroundB\n\n CharStartOutfitEntry const* GetCharStartOutfitEntry(uint8 race, uint8 class_, uint8 gender);\n\n+CharSectionsEntry const* GetCharSectionEntry(uint8 race, CharSectionType genType, uint8 gender, uint8 type, uint8 color);\n+\n LFGDungeonEntry const* GetLFGDungeon(uint32 mapId, Difficulty difficulty);\n LFGDungeonEntry const* GetZoneLFGDungeonEntry(std::string const&amp; zoneName, LocaleConstant locale);\n\n@@ -72,6 +81,7 @@ typedef std::unordered_multimap&lt;uint32, SkillRaceClassInfoEntry const*&gt; SkillRac\n typedef std::pair&lt;SkillRaceClassInfoMap::iterator, SkillRaceClassInfoMap::iterator&gt; SkillRaceClassInfoBounds;\n SkillRaceClassInfoEntry const* GetSkillRaceClassInfo(uint32 skill, uint8 race, uint8 class_);\n\n+EmotesTextSoundEntry const* FindTextSoundEmoteFor(uint32 emote, uint32 race, uint32 gender);\n typedef std::unordered_map&lt;uint32 /* SkillLine */, std::vector&lt;SkillLineAbilityEntry const*&gt; &gt; SkillLineAbilityIndexBySkillLine;\n const std::vector&lt;SkillLineAbilityEntry const*&gt;&amp; GetSkillLineAbilitiesBySkillLine(uint32 skillLine);\n\n@@ -87,6 +97,7 @@ extern DBCStorage &lt;BarberShopStyleEntry&gt;         sBarberShopStyleStore;\n extern DBCStorage &lt;BattlemasterListEntry&gt;        sBattlemasterListStore;\n extern DBCStorage &lt;ChatChannelsEntry&gt;            sChatChannelsStore;\n extern DBCStorage &lt;CharStartOutfitEntry&gt;         sCharStartOutfitStore;\n+extern DBCStorage &lt;CharSectionsEntry&gt;            sCharSectionsStore;\n extern DBCStorage &lt;CharTitlesEntry&gt;              sCharTitlesStore;\n extern DBCStorage &lt;ChrClassesEntry&gt;              sChrClassesStore;\n extern DBCStorage &lt;ChrRacesEntry&gt;                sChrRacesStore;\n@@ -105,6 +116,7 @@ extern DBCStorage &lt;DurabilityCostsEntry&gt;         sDurabilityCostsStore;\n extern DBCStorage &lt;DurabilityQualityEntry&gt;       sDurabilityQualityStore;\n extern DBCStorage &lt;EmotesEntry&gt;                  sEmotesStore;\n extern DBCStorage &lt;EmotesTextEntry&gt;              sEmotesTextStore;\n+extern DBCStorage &lt;EmotesTextSoundEntry&gt;         sEmotesTextSoundStore;\n extern DBCStorage &lt;FactionEntry&gt;                 sFactionStore;\n extern DBCStorage &lt;FactionTemplateEntry&gt;         sFactionTemplateStore;\n extern DBCStorage &lt;GameObjectArtKitEntry&gt;        sGameObjectArtKitStore;\ndiff --git a/src/server/game/DungeonFinding/LFGMgr.h b/src/server/game/DungeonFinding/LFGMgr.h\nindex 644504567a805d..3d451e8eb0d1b6 100644\n--- a/src/server/game/DungeonFinding/LFGMgr.h\n+++ b/src/server/game/DungeonFinding/LFGMgr.h\n@@ -584,6 +584,7 @@ namespace lfg\n         [[nodiscard]] bool IsTesting() const { return m_Testing; }\n\n         void SetDungeon(ObjectGuid guid, uint32 dungeon);\n+        LFGDungeonData const* GetLFGDungeon(uint32 id);\n\n     private:\n         TeamId GetTeam(ObjectGuid guid);\n@@ -596,7 +597,6 @@ namespace lfg\n         void SetCanOverrideRBState(ObjectGuid guid, bool val);\n         void GetCompatibleDungeons(LfgDungeonSet&amp; dungeons, LfgGuidSet const&amp; players, LfgLockPartyMap&amp; lockMap, uint32 randomDungeonId = 0);\n         void _SaveToDB(ObjectGuid guid);\n-        LFGDungeonData const* GetLFGDungeon(uint32 id);\n\n         // Proposals\n         void RemoveProposal(LfgProposalContainer::iterator itProposal, LfgUpdateType type);\ndiff --git a/src/server/game/DungeonFinding/LFGQueue.cpp b/src/server/game/DungeonFinding/LFGQueue.cpp\nindex aae5df67aa2afe..6e7f99a32252b5 100644\n--- a/src/server/game/DungeonFinding/LFGQueue.cpp\n+++ b/src/server/game/DungeonFinding/LFGQueue.cpp\n@@ -25,6 +25,7 @@\n #include \"Log.h\"\n #include \"ObjectMgr.h\"\n #include \"Player.h\"\n+#include \"ScriptMgr.h\"\n #include \"World.h\"\n\n namespace lfg\n@@ -411,6 +412,11 @@ namespace lfg\n         if (!sLFGMgr-&gt;AllQueued(check)) // can't create proposal\n             return LFG_COMPATIBILITY_PENDING;\n\n+        if (!sScriptMgr-&gt;OnPlayerbotCheckLFGQueue(proposal.queues))\n+        {\n+            return LFG_INCOMPATIBLES_HAS_IGNORES;\n+        }\n+\n         // Create a new proposal\n         proposal.cancelTime = GameTime::GetGameTime().count() + LFG_TIME_PROPOSAL;\n         proposal.state = LFG_PROPOSAL_INITIATING;\ndiff --git a/src/server/game/Entities/Creature/Creature.cpp b/src/server/game/Entities/Creature/Creature.cpp\nindex dd2ab4992dccee..851bf23dbaca3e 100644\n--- a/src/server/game/Entities/Creature/Creature.cpp\n+++ b/src/server/game/Entities/Creature/Creature.cpp\n@@ -1373,7 +1373,7 @@ void Creature::SaveToDB(uint32 mapid, uint8 spawnMask, uint32 phaseMask)\n         m_spawnId = sObjectMgr-&gt;GenerateCreatureSpawnId();\n\n     CreatureData&amp; data = sObjectMgr-&gt;NewOrExistCreatureData(m_spawnId);\n-\n+    data.spawnId = m_spawnId;  // mod_playerbots\n     uint32 displayId = GetNativeDisplayId();\n     uint32 npcflag = GetNpcFlags();\n     uint32 unit_flags = GetUnitFlags();\ndiff --git a/src/server/game/Entities/Creature/CreatureData.h b/src/server/game/Entities/Creature/CreatureData.h\nindex f1f3d6f02ed012..e1022f1226fc55 100644\n--- a/src/server/game/Entities/Creature/CreatureData.h\n+++ b/src/server/game/Entities/Creature/CreatureData.h\n@@ -365,6 +365,7 @@ typedef std::unordered_map&lt;uint32, EquipmentInfoContainerInternal&gt; EquipmentInfo\n struct CreatureData\n {\n     CreatureData() = default;\n+    ObjectGuid::LowType spawnId{ 0 };                          // mod_playerbots\n     uint32 id1{0};                                             // entry in creature_template\n     uint32 id2{0};                                             // entry in creature_template\n     uint32 id3{0};                                             // entry in creature_template\ndiff --git a/src/server/game/Entities/Item/Item.cpp b/src/server/game/Entities/Item/Item.cpp\nindex 9aea0ea74308f9..9c0c27fb770b09 100644\n--- a/src/server/game/Entities/Item/Item.cpp\n+++ b/src/server/game/Entities/Item/Item.cpp\n@@ -1084,7 +1084,7 @@ void Item::SendTimeUpdate(Player* owner)\n     owner-&gt;SendDirectMessage(&amp;data);\n }\n\n-Item* Item::CreateItem(uint32 item, uint32 count, Player const* player, bool clone, uint32 randomPropertyId)\n+Item* Item::CreateItem(uint32 item, uint32 count, Player const* player, bool clone, uint32 randomPropertyId, bool temp)\n {\n     if (count &lt; 1)\n         return nullptr;                                        //don't create item at zero count\n@@ -1098,7 +1098,8 @@ Item* Item::CreateItem(uint32 item, uint32 count, Player const* player, bool clo\n         ASSERT_NODEBUGINFO(count != 0 &amp;&amp; \"pProto-&gt;Stackable == 0 but checked at loading already\");\n\n         Item* pItem = NewItemOrBag(pProto);\n-        if (pItem-&gt;Create(sObjectMgr-&gt;GetGenerator&lt;HighGuid::Item&gt;().Generate(), item, player))\n+        uint32 guid = temp ? 0xFFFFFFFF : sObjectMgr-&gt;GetGenerator&lt;HighGuid::Item&gt;().Generate();\n+        if (pItem-&gt;Create(guid, item, player))\n         {\n             pItem-&gt;SetCount(count);\n             if (!clone)\n@@ -1276,10 +1277,15 @@ void Item::ClearSoulboundTradeable(Player* currentOwner)\n\n bool Item::CheckSoulboundTradeExpire()\n {\n-    // called from owner's update - GetOwner() MUST be valid\n-    if (GetUInt32Value(ITEM_FIELD_CREATE_PLAYED_TIME) + 2 * HOUR &lt; GetOwner()-&gt;GetTotalPlayedTime())\n+    // we have to check the owner for mod_playerbots since bots programically call methods like DestroyItem, \n+    // MoveItemToMail, DestroyItemCount which do not handle soulboundTradeable clearing.\n+    Player* owner = GetOwner();\n+    if (!owner)\n+        return true; // remove from tradeable list\n+    \n+    if (GetUInt32Value(ITEM_FIELD_CREATE_PLAYED_TIME) + 2 * HOUR &lt; owner-&gt;GetTotalPlayedTime())\n     {\n-        ClearSoulboundTradeable(GetOwner());\n+        ClearSoulboundTradeable(owner);\n         return true; // remove from tradeable list\n     }\n\ndiff --git a/src/server/game/Entities/Item/Item.h b/src/server/game/Entities/Item/Item.h\nindex 51289594b98b59..e333a4ba772dfe 100644\n--- a/src/server/game/Entities/Item/Item.h\n+++ b/src/server/game/Entities/Item/Item.h\n@@ -219,7 +219,7 @@ bool ItemCanGoIntoBag(ItemTemplate const* proto, ItemTemplate const* pBagProto);\n class Item : public Object\n {\n public:\n-    static Item* CreateItem(uint32 item, uint32 count, Player const* player = nullptr, bool clone = false, uint32 randomPropertyId = 0);\n+    static Item* CreateItem(uint32 item, uint32 count, Player const* player = nullptr, bool clone = false, uint32 randomPropertyId = 0, bool temp = false);\n     Item* CloneItem(uint32 count, Player const* player = nullptr) const;\n\n     Item();\ndiff --git a/src/server/game/Entities/Item/ItemTemplate.h b/src/server/game/Entities/Item/ItemTemplate.h\nindex b41616c1120fec..dca51af799512f 100644\n--- a/src/server/game/Entities/Item/ItemTemplate.h\n+++ b/src/server/game/Entities/Item/ItemTemplate.h\n@@ -251,7 +251,7 @@ enum SocketColor\n\n #define SOCKET_COLOR_ALL (SOCKET_COLOR_META | SOCKET_COLOR_RED | SOCKET_COLOR_YELLOW | SOCKET_COLOR_BLUE)\n\n-enum InventoryType\n+enum InventoryType : uint32\n {\n     INVTYPE_NON_EQUIP                           = 0,\n     INVTYPE_HEAD                                = 1,\n@@ -818,6 +818,8 @@ struct ItemTemplate\n     [[nodiscard]] bool IsWeaponVellum() const { return Class == ITEM_CLASS_TRADE_GOODS &amp;&amp; SubClass == ITEM_SUBCLASS_WEAPON_ENCHANTMENT; }\n     [[nodiscard]] bool IsArmorVellum() const { return Class == ITEM_CLASS_TRADE_GOODS &amp;&amp; SubClass == ITEM_SUBCLASS_ARMOR_ENCHANTMENT; }\n     [[nodiscard]] bool IsConjuredConsumable() const { return Class == ITEM_CLASS_CONSUMABLE &amp;&amp; HasFlag(ITEM_FLAG_CONJURED); }\n+    [[nodiscard]] bool IsWeapon() const { return Class == ITEM_CLASS_WEAPON; }\n+    [[nodiscard]] bool IsRangedWeapon() const { return IsWeapon() &amp;&amp; (InventoryType == INVTYPE_RANGED || InventoryType == INVTYPE_THROWN || InventoryType == INVTYPE_RANGEDRIGHT); }\n\n     [[nodiscard]] bool HasStat(ItemModType stat) const;\n     [[nodiscard]] bool HasSpellPowerStat() const;\ndiff --git a/src/server/game/Entities/Player/Player.cpp b/src/server/game/Entities/Player/Player.cpp\nindex ff26ef061923ef..82e67db4e1a1d0 100644\n--- a/src/server/game/Entities/Player/Player.cpp\n+++ b/src/server/game/Entities/Player/Player.cpp\n@@ -4922,6 +4922,15 @@ void Player::CleanupChannels()\n     }\n }\n\n+// Playerbot helper if bot talks in a different locale\n+bool Player::IsInChannel(const Channel* c)\n+{\n+    return std::any_of(m_channels.begin(), m_channels.end(), [c](const Channel* chan)\n+    {\n+        return c-&gt;GetChannelId() == chan-&gt;GetChannelId();\n+    });\n+}\n+\n void Player::ClearChannelWatch()\n {\n     for (JoinedChannelsList::iterator itr = m_channels.begin(); itr != m_channels.end(); ++itr)\ndiff --git a/src/server/game/Entities/Player/Player.h b/src/server/game/Entities/Player/Player.h\nindex 92b42d7358b9bb..b570441cbd7e5c 100644\n--- a/src/server/game/Entities/Player/Player.h\n+++ b/src/server/game/Entities/Player/Player.h\n@@ -656,7 +656,7 @@ enum PlayerSlots\n\n #define INVENTORY_SLOT_BAG_0    255\n\n-enum EquipmentSlots                                         // 19 slots\n+enum EquipmentSlots : uint32                                // 19 slots\n {\n     EQUIPMENT_SLOT_START        = 0,\n     EQUIPMENT_SLOT_HEAD         = 0,\n@@ -1295,6 +1295,7 @@ class Player : public Unit, public GridObject&lt;Player&gt;\n     InventoryResult CanUseItem(Item* pItem, bool not_loading = true) const;\n     [[nodiscard]] bool HasItemTotemCategory(uint32 TotemCategory) const;\n     bool IsTotemCategoryCompatiableWith(ItemTemplate const* pProto, uint32 requiredTotemCategoryId) const;\n+    InventoryResult BotCanUseItem(ItemTemplate const* pItem) const;\n     InventoryResult CanUseItem(ItemTemplate const* pItem) const;\n     [[nodiscard]] InventoryResult CanUseAmmo(uint32 item) const;\n     InventoryResult CanRollForItemInLFG(ItemTemplate const* item, WorldObject const* lootedObject) const;\n@@ -2054,10 +2055,13 @@ class Player : public Unit, public GridObject&lt;Player&gt;\n     }\n     bool IsMirrorTimerActive(MirrorTimerType type) { return m_MirrorTimer[type] == getMaxTimer(type); }\n\n+    void SetMovement(PlayerMovementType pType);\n+\n     bool CanJoinConstantChannelInZone(ChatChannelsEntry const* channel, AreaTableEntry const* zone);\n\n     void JoinedChannel(Channel* c);\n     void LeftChannel(Channel* c);\n+    bool IsInChannel(const Channel* c);\n     void CleanupChannels();\n     void ClearChannelWatch();\n     void UpdateLFGChannel();\n@@ -2638,6 +2642,8 @@ class Player : public Unit, public GridObject&lt;Player&gt;\n\n     void SendSystemMessage(std::string_view msg, bool escapeCharacters = false);\n\n+    void ResetSpeakTimers();\n+\n     std::string GetDebugInfo() const override;\n\n     bool IsExpectingChangeTransport() const { return _expectingChangeTransport; }\ndiff --git a/src/server/game/Entities/Player/PlayerStorage.cpp b/src/server/game/Entities/Player/PlayerStorage.cpp\nindex e8117aa58ea901..b7932bbc3f53d4 100644\n--- a/src/server/game/Entities/Player/PlayerStorage.cpp\n+++ b/src/server/game/Entities/Player/PlayerStorage.cpp\n@@ -908,6 +908,31 @@ bool Player::IsTotemCategoryCompatiableWith(ItemTemplate const* pProto, uint32 r\n     return true;\n }\n\n+InventoryResult Player::BotCanUseItem(ItemTemplate const* proto) const\n+{\n+    if (proto-&gt;Class == ITEM_CLASS_ARMOR &amp;&amp; proto-&gt;SubClass == ITEM_SUBCLASS_ARMOR_IDOL &amp;&amp; !IsClass(CLASS_DRUID, CLASS_CONTEXT_EQUIP_RELIC))\n+    {\n+        return EQUIP_ERR_YOU_CAN_NEVER_USE_THAT_ITEM;\n+    }\n+\n+    if (proto-&gt;Class == ITEM_CLASS_ARMOR &amp;&amp; proto-&gt;SubClass == ITEM_SUBCLASS_ARMOR_TOTEM &amp;&amp; !IsClass(CLASS_SHAMAN, CLASS_CONTEXT_EQUIP_RELIC))\n+    {\n+        return EQUIP_ERR_YOU_CAN_NEVER_USE_THAT_ITEM;\n+    }\n+\n+    if (proto-&gt;Class == ITEM_CLASS_ARMOR &amp;&amp; proto-&gt;SubClass == ITEM_SUBCLASS_ARMOR_LIBRAM &amp;&amp; !IsClass(CLASS_PALADIN, CLASS_CONTEXT_EQUIP_RELIC))\n+    {\n+        return EQUIP_ERR_YOU_CAN_NEVER_USE_THAT_ITEM;\n+    }\n+\n+    if (proto-&gt;Class == ITEM_CLASS_ARMOR &amp;&amp; proto-&gt;SubClass == ITEM_SUBCLASS_ARMOR_SIGIL &amp;&amp; !IsClass(CLASS_DEATH_KNIGHT, CLASS_CONTEXT_EQUIP_RELIC))\n+    {\n+        return EQUIP_ERR_YOU_CAN_NEVER_USE_THAT_ITEM;\n+    }\n+\n+    return CanUseItem(proto);\n+}\n+\n InventoryResult Player::CanStoreItem_InSpecificSlot(uint8 bag, uint8 slot, ItemPosCountVec&amp; dest, ItemTemplate const* pProto, uint32&amp; count, bool swap, Item* pSrcItem) const\n {\n     Item* pItem2 = GetItemByPos(bag, slot);\ndiff --git a/src/server/game/Entities/Player/PlayerUpdates.cpp b/src/server/game/Entities/Player/PlayerUpdates.cpp\nindex b0c7a85218ec76..ba8c9257620fe5 100644\n--- a/src/server/game/Entities/Player/PlayerUpdates.cpp\n+++ b/src/server/game/Entities/Player/PlayerUpdates.cpp\n@@ -430,6 +430,7 @@ void Player::Update(uint32 p_time)\n         m_delayed_unit_relocation_timer = 0;\n         RemoveFromNotify(NOTIFY_VISIBILITY_CHANGED);\n     }\n+    sScriptMgr-&gt;OnPlayerAfterUpdate(this, p_time);\n }\n\n void Player::UpdateMirrorTimers()\ndiff --git a/src/server/game/Entities/Unit/Unit.cpp b/src/server/game/Entities/Unit/Unit.cpp\nindex f87548d1801a4d..dd6aef12c4b763 100644\n--- a/src/server/game/Entities/Unit/Unit.cpp\n+++ b/src/server/game/Entities/Unit/Unit.cpp\n@@ -10410,6 +10410,11 @@ ReputationRank Unit::GetFactionReactionTo(FactionTemplateEntry const* factionTem\n         }\n     }\n\n+    return GetFactionReactionTo(factionTemplateEntry, targetFactionTemplateEntry);\n+}\n+\n+ReputationRank Unit::GetFactionReactionTo(FactionTemplateEntry const* factionTemplateEntry, FactionTemplateEntry const* targetFactionTemplateEntry)\n+{\n     // common faction based check\n     if (factionTemplateEntry-&gt;IsHostileTo(*targetFactionTemplateEntry))\n         return REP_HOSTILE;\n@@ -10419,6 +10424,7 @@ ReputationRank Unit::GetFactionReactionTo(FactionTemplateEntry const* factionTem\n         return REP_FRIENDLY;\n     if (factionTemplateEntry-&gt;factionFlags &amp; FACTION_TEMPLATE_FLAG_HATES_ALL_EXCEPT_FRIENDS)\n         return REP_HOSTILE;\n+\n     // neutral by default\n     return REP_NEUTRAL;\n }\n@@ -15984,6 +15990,11 @@ void Unit::CleanupBeforeRemoveFromMap(bool finalCleanup)\n     if (IsInWorld()) // not in world and not being removed atm\n         RemoveFromWorld();\n\n+    // Added for mod_playerbots crash fixes; cancel and remove pending events before aura/spellmod cleanup.\n+    // Without this SpellEvent may be cancelled later during EventProcessor destruction after auras/spellmods \n+    // are already removed and leading to invalid access in Player::RestoreSpellMods on logout.\n+    m_Events.KillAllEvents(false);\n+\n     ASSERT(GetGUID());\n\n     // A unit may be in removelist and not in world, but it is still in grid\n@@ -18234,6 +18245,8 @@ void Unit::Kill(Unit* killer, Unit* victim, bool durabilityLoss, WeaponAttackTyp\n             }\n         }\n\n+        sScriptMgr-&gt;OnPlayerbotCheckKillTask(player, victim);\n+\n         // Dungeon specific stuff, only applies to players killing creatures\n         if (creature-&gt;GetInstanceId())\n         {\n@@ -19178,11 +19191,23 @@ void Unit::SendPlaySpellVisual(uint32 id)\n     SendMessageToSet(&amp;data, true);\n }\n\n+void Unit::SendPlaySpellVisual(ObjectGuid guid, uint32 id)\n+{\n+    WorldPacket data(SMSG_PLAY_SPELL_VISUAL, 8 + 4);\n+    data &lt;&lt; guid;\n+    data &lt;&lt; uint32(id); // SpellVisualKit.dbc index\n+    SendMessageToSet(&amp;data, true);\n+}\n+\n void Unit::SendPlaySpellImpact(ObjectGuid guid, uint32 id)\n {\n     WorldPacket data(SMSG_PLAY_SPELL_IMPACT, 8 + 4);\n     data &lt;&lt; guid;       // target\n     data &lt;&lt; uint32(id); // SpellVisualKit.dbc index\n+\n+    if (IsPlayer())\n+        ToPlayer()-&gt;SendDirectMessage(&amp;data);\n+    else\n     SendMessageToSet(&amp;data, true);\n }\n\ndiff --git a/src/server/game/Entities/Unit/Unit.h b/src/server/game/Entities/Unit/Unit.h\nindex 1590c2721fdb1c..9aa5cb1fd1bd45 100644\n--- a/src/server/game/Entities/Unit/Unit.h\n+++ b/src/server/game/Entities/Unit/Unit.h\n@@ -1851,6 +1851,7 @@ class Unit : public WorldObject\n     // Reputations system\n     ReputationRank GetReactionTo(Unit const* target, bool checkOriginalFaction = false) const;\n     ReputationRank GetFactionReactionTo(FactionTemplateEntry const* factionTemplateEntry, Unit const* target) const;\n+    static ReputationRank GetFactionReactionTo(FactionTemplateEntry const* factionTemplateEntry, FactionTemplateEntry const* targetFactionTemplateEntry);\n\n     // Shared vision\n     SharedVisionList const&amp; GetSharedVisionList() { return m_sharedVision; }\n@@ -2008,6 +2009,7 @@ class Unit : public WorldObject\n     void SendComboPoints();\n\n     void SendPlaySpellVisual(uint32 id);\n+    void SendPlaySpellVisual(ObjectGuid guid, uint32 id);\n     void SendPlaySpellImpact(ObjectGuid guid, uint32 id);\n\n     void SendPetActionFeedback(uint8 msg) const;\ndiff --git a/src/server/game/Entities/Vehicle/VehicleDefines.h b/src/server/game/Entities/Vehicle/VehicleDefines.h\nindex 1aa25458194ad4..86822d05e81a10 100644\n--- a/src/server/game/Entities/Vehicle/VehicleDefines.h\n+++ b/src/server/game/Entities/Vehicle/VehicleDefines.h\n@@ -45,6 +45,7 @@ enum VehicleFlags\n     VEHICLE_FLAG_CUSTOM_PITCH                    = 0x00000040,           // If set use pitchMin and pitchMax from DBC, otherwise pitchMin = -pi/2, pitchMax = pi/2\n     VEHICLE_FLAG_ADJUST_AIM_ANGLE                = 0x00000400,           // Lua_IsVehicleAimAngleAdjustable\n     VEHICLE_FLAG_ADJUST_AIM_POWER                = 0x00000800,           // Lua_IsVehicleAimPowerAdjustable\n+    VEHICLE_FLAG_FIXED_POSITION                  = 0x00200000            // Used for cannons, when they should be rooted (mod_playerbots, not sure this is still valid since its only used my playerbot)\n };\n\n enum VehicleSpells\ndiff --git a/src/server/game/Globals/ObjectMgr.h b/src/server/game/Globals/ObjectMgr.h\nindex 4ac1e33b664629..37bf94b7d73d6b 100644\n--- a/src/server/game/Globals/ObjectMgr.h\n+++ b/src/server/game/Globals/ObjectMgr.h\n@@ -867,6 +867,7 @@ class ObjectMgr\n         return nullptr;\n     }\n\n+    [[nodiscard]] AreaTriggerTeleportContainer const&amp; GetAllAreaTriggerTeleports() const { return _areaTriggerTeleportStore; }\n     [[nodiscard]] AreaTriggerTeleport const* GetAreaTriggerTeleport(uint32 trigger) const\n     {\n         AreaTriggerTeleportContainer::const_iterator itr = _areaTriggerTeleportStore.find(trigger);\ndiff --git a/src/server/game/Groups/Group.cpp b/src/server/game/Groups/Group.cpp\nindex d2338ca813b95e..9242668a96eb61 100644\n--- a/src/server/game/Groups/Group.cpp\n+++ b/src/server/game/Groups/Group.cpp\n@@ -350,14 +350,21 @@ bool Group::AddLeaderInvite(Player* player)\n\n void Group::RemoveInvite(Player* player)\n {\n-    if (player)\n-    {\n-        if (!m_invitees.empty())\n-            m_invitees.erase(player);\n-        player-&gt;SetGroupInvite(nullptr);\n-    }\n+    if (!player)\n+        return;\n+\n+    // mod_playerbots: double invite hack workaround\n+    if (player-&gt;GetGroupInvite() != this)\n+        return;\n+\n+    auto itr = m_invitees.find(player);\n+    if (itr != m_invitees.end())\n+        m_invitees.erase(itr);\n+\n+    player-&gt;SetGroupInvite(nullptr);\n }\n\n+\n void Group::RemoveAllInvites()\n {\n     for (InvitesList::iterator itr = m_invitees.begin(); itr != m_invitees.end(); ++itr)\ndiff --git a/src/server/game/Groups/Group.h b/src/server/game/Groups/Group.h\nindex c4a9b926277aba..b9cdb1e3550d3a 100644\n--- a/src/server/game/Groups/Group.h\n+++ b/src/server/game/Groups/Group.h\n@@ -262,6 +262,9 @@ class Group\n     void SetGroupMemberFlag(ObjectGuid guid, bool apply, GroupMemberFlags flag);\n     void RemoveUniqueGroupMemberFlag(GroupMemberFlags flag);\n\n+    //mod_playerbots\n+    ObjectGuid const GetTargetIcon(uint8 id) const { return m_targetIcons[id]; }\n+\n     Difficulty GetDifficulty(bool isRaid) const;\n     Difficulty GetDungeonDifficulty() const;\n     Difficulty GetRaidDifficulty() const;\n@@ -300,6 +303,8 @@ class Group\n     bool CountRollVote(ObjectGuid playerGUID, ObjectGuid Guid, uint8 Choise);\n     void EndRoll(Loot* loot, Map* allowedMap);\n\n+    Rolls GetRolls() const { return RollId; }\n+\n     // related to disenchant rolls\n     void ResetMaxEnchantingLevel();\n\ndiff --git a/src/server/game/Guilds/Guild.cpp b/src/server/game/Guilds/Guild.cpp\nindex d38838121584be..86b3cc83295e09 100644\n--- a/src/server/game/Guilds/Guild.cpp\n+++ b/src/server/game/Guilds/Guild.cpp\n@@ -44,48 +44,48 @@ std::string _GetGuildEventString(GuildEvents event)\n {\n     switch (event)\n     {\n-        case GE_PROMOTION:\n-            return \"Member promotion\";\n-        case GE_DEMOTION:\n-            return \"Member demotion\";\n-        case GE_MOTD:\n-            return \"Guild MOTD\";\n-        case GE_JOINED:\n-            return \"Member joined\";\n-        case GE_LEFT:\n-            return \"Member left\";\n-        case GE_REMOVED:\n-            return \"Member removed\";\n-        case GE_LEADER_IS:\n-            return \"Leader is\";\n-        case GE_LEADER_CHANGED:\n-            return \"Leader changed\";\n-        case GE_DISBANDED:\n-            return \"Guild disbanded\";\n-        case GE_TABARDCHANGE:\n-            return \"Tabard change\";\n-        case GE_RANK_UPDATED:\n-            return \"Rank updated\";\n-        case GE_RANK_DELETED:\n-            return \"Rank deleted\";\n-        case GE_SIGNED_ON:\n-            return \"Member signed on\";\n-        case GE_SIGNED_OFF:\n-            return \"Member signed off\";\n-        case GE_GUILDBANKBAGSLOTS_CHANGED:\n-            return \"Bank bag slots changed\";\n-        case GE_BANK_TAB_PURCHASED:\n-            return \"Bank tab purchased\";\n-        case GE_BANK_TAB_UPDATED:\n-            return \"Bank tab updated\";\n-        case GE_BANK_MONEY_SET:\n-            return \"Bank money set\";\n-        case GE_BANK_TAB_AND_MONEY_UPDATED:\n-            return \"Bank and money updated\";\n-        case GE_BANK_TEXT_CHANGED:\n-            return \"Bank tab text changed\";\n-        default:\n-            break;\n+    case GE_PROMOTION:\n+        return \"Member promotion\";\n+    case GE_DEMOTION:\n+        return \"Member demotion\";\n+    case GE_MOTD:\n+        return \"Guild MOTD\";\n+    case GE_JOINED:\n+        return \"Member joined\";\n+    case GE_LEFT:\n+        return \"Member left\";\n+    case GE_REMOVED:\n+        return \"Member removed\";\n+    case GE_LEADER_IS:\n+        return \"Leader is\";\n+    case GE_LEADER_CHANGED:\n+        return \"Leader changed\";\n+    case GE_DISBANDED:\n+        return \"Guild disbanded\";\n+    case GE_TABARDCHANGE:\n+        return \"Tabard change\";\n+    case GE_RANK_UPDATED:\n+        return \"Rank updated\";\n+    case GE_RANK_DELETED:\n+        return \"Rank deleted\";\n+    case GE_SIGNED_ON:\n+        return \"Member signed on\";\n+    case GE_SIGNED_OFF:\n+        return \"Member signed off\";\n+    case GE_GUILDBANKBAGSLOTS_CHANGED:\n+        return \"Bank bag slots changed\";\n+    case GE_BANK_TAB_PURCHASED:\n+        return \"Bank tab purchased\";\n+    case GE_BANK_TAB_UPDATED:\n+        return \"Bank tab updated\";\n+    case GE_BANK_MONEY_SET:\n+        return \"Bank money set\";\n+    case GE_BANK_TAB_AND_MONEY_UPDATED:\n+        return \"Bank and money updated\";\n+    case GE_BANK_TEXT_CHANGED:\n+        return \"Bank tab text changed\";\n+    default:\n+        break;\n     }\n     return \"&lt;None&gt;\";\n }\n@@ -94,20 +94,20 @@ inline uint32 _GetGuildBankTabPrice(uint8 tabId)\n {\n     switch (tabId)\n     {\n-        case 0:\n-            return sWorld-&gt;getIntConfig(CONFIG_GUILD_BANK_TAB_COST_0);\n-        case 1:\n-            return sWorld-&gt;getIntConfig(CONFIG_GUILD_BANK_TAB_COST_1);\n-        case 2:\n-            return sWorld-&gt;getIntConfig(CONFIG_GUILD_BANK_TAB_COST_2);\n-        case 3:\n-            return sWorld-&gt;getIntConfig(CONFIG_GUILD_BANK_TAB_COST_3);\n-        case 4:\n-            return sWorld-&gt;getIntConfig(CONFIG_GUILD_BANK_TAB_COST_4);\n-        case 5:\n-            return sWorld-&gt;getIntConfig(CONFIG_GUILD_BANK_TAB_COST_5);\n-        default:\n-            return 0;\n+    case 0:\n+        return sWorld-&gt;getIntConfig(CONFIG_GUILD_BANK_TAB_COST_0);\n+    case 1:\n+        return sWorld-&gt;getIntConfig(CONFIG_GUILD_BANK_TAB_COST_1);\n+    case 2:\n+        return sWorld-&gt;getIntConfig(CONFIG_GUILD_BANK_TAB_COST_2);\n+    case 3:\n+        return sWorld-&gt;getIntConfig(CONFIG_GUILD_BANK_TAB_COST_3);\n+    case 4:\n+        return sWorld-&gt;getIntConfig(CONFIG_GUILD_BANK_TAB_COST_4);\n+    case 5:\n+        return sWorld-&gt;getIntConfig(CONFIG_GUILD_BANK_TAB_COST_5);\n+    default:\n+        return 0;\n     }\n }\n\n@@ -134,8 +134,9 @@ void Guild::SendSaveEmblemResult(WorldSession* session, GuildEmblemError errCode\n // LogHolder\n template &lt;typename Entry&gt;\n Guild::LogHolder&lt;Entry&gt;::LogHolder()\n-        : m_maxRecords(sWorld-&gt;getIntConfig(std::is_same_v&lt;Entry, BankEventLogEntry&gt; ? CONFIG_GUILD_BANK_EVENT_LOG_COUNT : CONFIG_GUILD_EVENT_LOG_COUNT)), m_nextGUID(uint32(GUILD_EVENT_LOG_GUID_UNDEFINED))\n-{ }\n+    : m_maxRecords(sWorld-&gt;getIntConfig(std::is_same_v&lt;Entry, BankEventLogEntry&gt; ? CONFIG_GUILD_BANK_EVENT_LOG_COUNT : CONFIG_GUILD_EVENT_LOG_COUNT)), m_nextGUID(uint32(GUILD_EVENT_LOG_GUID_UNDEFINED))\n+{\n+}\n\n template &lt;typename Entry&gt; template &lt;typename... Ts&gt;\n void Guild::LogHolder&lt;Entry&gt;::LoadEvent(Ts&amp;&amp;... args)\n@@ -173,7 +174,8 @@ inline uint32 Guild::LogHolder&lt;Entry&gt;::GetNextGUID()\n }\n\n Guild::LogEntry::LogEntry(uint32 guildId, ObjectGuid::LowType guid) :\n-    m_guildId(guildId), m_guid(guid), m_timestamp(GameTime::GetGameTime().count()) { }\n+    m_guildId(guildId), m_guid(guid), m_timestamp(GameTime::GetGameTime().count()) {\n+}\n\n // EventLogEntry\n void Guild::EventLogEntry::SaveToDB(CharacterDatabaseTransaction trans) const\n@@ -185,12 +187,12 @@ void Guild::EventLogEntry::SaveToDB(CharacterDatabaseTransaction trans) const\n\n     uint8 index = 0;\n     stmt = CharacterDatabase.GetPreparedStatement(CHAR_INS_GUILD_EVENTLOG);\n-    stmt-&gt;SetData(  index, m_guildId);\n+    stmt-&gt;SetData(index, m_guildId);\n     stmt-&gt;SetData(++index, m_guid);\n-    stmt-&gt;SetData (++index, uint8(m_eventType));\n+    stmt-&gt;SetData(++index, uint8(m_eventType));\n     stmt-&gt;SetData(++index, m_playerGuid1.GetCounter());\n     stmt-&gt;SetData(++index, m_playerGuid2.GetCounter());\n-    stmt-&gt;SetData (++index, m_newRank);\n+    stmt-&gt;SetData(++index, m_newRank);\n     stmt-&gt;SetData(++index, m_timestamp);\n     CharacterDatabase.ExecuteOrAppend(trans, stmt);\n }\n@@ -215,21 +217,21 @@ void Guild::BankEventLogEntry::SaveToDB(CharacterDatabaseTransaction trans) cons\n     uint8 index = 0;\n\n     CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_DEL_GUILD_BANK_EVENTLOG);\n-    stmt-&gt;SetData(  index, m_guildId);\n+    stmt-&gt;SetData(index, m_guildId);\n     stmt-&gt;SetData(++index, m_guid);\n-    stmt-&gt;SetData (++index, m_bankTabId);\n+    stmt-&gt;SetData(++index, m_bankTabId);\n     CharacterDatabase.ExecuteOrAppend(trans, stmt);\n\n     index = 0;\n     stmt = CharacterDatabase.GetPreparedStatement(CHAR_INS_GUILD_BANK_EVENTLOG);\n-    stmt-&gt;SetData(  index, m_guildId);\n+    stmt-&gt;SetData(index, m_guildId);\n     stmt-&gt;SetData(++index, m_guid);\n-    stmt-&gt;SetData (++index, m_bankTabId);\n-    stmt-&gt;SetData (++index, uint8(m_eventType));\n+    stmt-&gt;SetData(++index, m_bankTabId);\n+    stmt-&gt;SetData(++index, uint8(m_eventType));\n     stmt-&gt;SetData(++index, m_playerGuid.GetCounter());\n     stmt-&gt;SetData(++index, m_itemOrMoney);\n     stmt-&gt;SetData(++index, m_itemStackCount);\n-    stmt-&gt;SetData (++index, m_destTabId);\n+    stmt-&gt;SetData(++index, m_destTabId);\n     stmt-&gt;SetData(++index, m_timestamp);\n     CharacterDatabase.ExecuteOrAppend(trans, stmt);\n }\n@@ -243,19 +245,19 @@ void Guild::BankEventLogEntry::WritePacket(WorldPackets::Guild::GuildBankLogQuer\n\n     switch (m_eventType)\n     {\n-        case GUILD_BANK_LOG_DEPOSIT_ITEM:\n-        case GUILD_BANK_LOG_WITHDRAW_ITEM:\n-            bankLogEntry.ItemID = int32(m_itemOrMoney);\n-            bankLogEntry.Count = int32(m_itemStackCount);\n-            break;\n-        case GUILD_BANK_LOG_MOVE_ITEM:\n-        case GUILD_BANK_LOG_MOVE_ITEM2:\n-            bankLogEntry.ItemID = int32(m_itemOrMoney);\n-            bankLogEntry.Count = int32(m_itemStackCount);\n-            bankLogEntry.OtherTab = int8(m_destTabId);\n-            break;\n-        default:\n-            bankLogEntry.Money = uint32(m_itemOrMoney);\n+    case GUILD_BANK_LOG_DEPOSIT_ITEM:\n+    case GUILD_BANK_LOG_WITHDRAW_ITEM:\n+        bankLogEntry.ItemID = int32(m_itemOrMoney);\n+        bankLogEntry.Count = int32(m_itemStackCount);\n+        break;\n+    case GUILD_BANK_LOG_MOVE_ITEM:\n+    case GUILD_BANK_LOG_MOVE_ITEM2:\n+        bankLogEntry.ItemID = int32(m_itemOrMoney);\n+        bankLogEntry.Count = int32(m_itemStackCount);\n+        bankLogEntry.OtherTab = int8(m_destTabId);\n+        break;\n+    default:\n+        bankLogEntry.Money = uint32(m_itemOrMoney);\n     }\n\n     packet.Entry.push_back(bankLogEntry);\n@@ -264,10 +266,10 @@ void Guild::BankEventLogEntry::WritePacket(WorldPackets::Guild::GuildBankLogQuer\n // RankInfo\n void Guild::RankInfo::LoadFromDB(Field* fields)\n {\n-    m_rankId            = fields[1].Get&lt;uint8&gt;();\n-    m_name              = fields[2].Get&lt;std::string&gt;();\n-    m_rights            = fields[3].Get&lt;uint32&gt;();\n-    m_bankMoneyPerDay   = fields[4].Get&lt;uint32&gt;();\n+    m_rankId = fields[1].Get&lt;uint8&gt;();\n+    m_name = fields[2].Get&lt;std::string&gt;();\n+    m_rights = fields[3].Get&lt;uint32&gt;();\n+    m_bankMoneyPerDay = fields[4].Get&lt;uint32&gt;();\n     if (m_rankId == GR_GUILDMASTER)                     // Prevent loss of leader rights\n         m_rights |= GR_RIGHT_ALL;\n }\n@@ -276,7 +278,7 @@ void Guild::RankInfo::SaveToDB(CharacterDatabaseTransaction trans) const\n {\n     CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_INS_GUILD_RANK);\n     stmt-&gt;SetData(0, m_guildId);\n-    stmt-&gt;SetData (1, m_rankId);\n+    stmt-&gt;SetData(1, m_rankId);\n     stmt-&gt;SetData(2, m_name);\n     stmt-&gt;SetData(3, m_rights);\n     stmt-&gt;SetData(4, m_bankMoneyPerDay);\n@@ -317,7 +319,7 @@ void Guild::RankInfo::SetName(std::string_view name)\n\n     CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_UPD_GUILD_RANK_NAME);\n     stmt-&gt;SetData(0, m_name);\n-    stmt-&gt;SetData (1, m_rankId);\n+    stmt-&gt;SetData(1, m_rankId);\n     stmt-&gt;SetData(2, m_guildId);\n     CharacterDatabase.Execute(stmt);\n }\n@@ -334,7 +336,7 @@ void Guild::RankInfo::SetRights(uint32 rights)\n\n     CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_UPD_GUILD_RANK_RIGHTS);\n     stmt-&gt;SetData(0, m_rights);\n-    stmt-&gt;SetData (1, m_rankId);\n+    stmt-&gt;SetData(1, m_rankId);\n     stmt-&gt;SetData(2, m_guildId);\n     CharacterDatabase.Execute(stmt);\n }\n@@ -351,7 +353,7 @@ void Guild::RankInfo::SetBankMoneyPerDay(uint32 money)\n\n     CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_UPD_GUILD_RANK_BANK_MONEY);\n     stmt-&gt;SetData(0, money);\n-    stmt-&gt;SetData (1, m_rankId);\n+    stmt-&gt;SetData(1, m_rankId);\n     stmt-&gt;SetData(2, m_guildId);\n     CharacterDatabase.Execute(stmt);\n }\n@@ -368,9 +370,9 @@ void Guild::RankInfo::SetBankTabSlotsAndRights(GuildBankRightsAndSlots rightsAnd\n     {\n         CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_INS_GUILD_BANK_RIGHT);\n         stmt-&gt;SetData(0, m_guildId);\n-        stmt-&gt;SetData (1, guildBR.GetTabId());\n-        stmt-&gt;SetData (2, m_rankId);\n-        stmt-&gt;SetData (3, guildBR.GetRights());\n+        stmt-&gt;SetData(1, guildBR.GetTabId());\n+        stmt-&gt;SetData(2, m_rankId);\n+        stmt-&gt;SetData(3, guildBR.GetRights());\n         stmt-&gt;SetData(4, guildBR.GetSlots());\n         CharacterDatabase.Execute(stmt);\n     }\n@@ -409,8 +411,8 @@ bool Guild::BankTab::LoadItemFromDB(Field* fields)\n\n         CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_DEL_NONEXISTENT_GUILD_BANK_ITEM);\n         stmt-&gt;SetData(0, m_guildId);\n-        stmt-&gt;SetData (1, m_tabId);\n-        stmt-&gt;SetData (2, slotId);\n+        stmt-&gt;SetData(1, m_tabId);\n+        stmt-&gt;SetData(2, slotId);\n         CharacterDatabase.Execute(stmt);\n\n         delete pItem;\n@@ -448,7 +450,7 @@ void Guild::BankTab::SetInfo(std::string_view name, std::string_view icon)\n     stmt-&gt;SetData(0, m_name);\n     stmt-&gt;SetData(1, m_icon);\n     stmt-&gt;SetData(2, m_guildId);\n-    stmt-&gt;SetData (3, m_tabId);\n+    stmt-&gt;SetData(3, m_tabId);\n     CharacterDatabase.Execute(stmt);\n }\n\n@@ -463,7 +465,7 @@ void Guild::BankTab::SetText(std::string_view text)\n     CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_UPD_GUILD_BANK_TAB_TEXT);\n     stmt-&gt;SetData(0, m_text);\n     stmt-&gt;SetData(1, m_guildId);\n-    stmt-&gt;SetData (2, m_tabId);\n+    stmt-&gt;SetData(2, m_tabId);\n     CharacterDatabase.Execute(stmt);\n }\n\n@@ -478,16 +480,16 @@ bool Guild::BankTab::SetItem(CharacterDatabaseTransaction trans, uint8 slotId, I\n\n     CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_DEL_GUILD_BANK_ITEM);\n     stmt-&gt;SetData(0, m_guildId);\n-    stmt-&gt;SetData (1, m_tabId);\n-    stmt-&gt;SetData (2, slotId);\n+    stmt-&gt;SetData(1, m_tabId);\n+    stmt-&gt;SetData(2, slotId);\n     CharacterDatabase.ExecuteOrAppend(trans, stmt);\n\n     if (item)\n     {\n         stmt = CharacterDatabase.GetPreparedStatement(CHAR_INS_GUILD_BANK_ITEM);\n         stmt-&gt;SetData(0, m_guildId);\n-        stmt-&gt;SetData (1, m_tabId);\n-        stmt-&gt;SetData (2, slotId);\n+        stmt-&gt;SetData(1, m_tabId);\n+        stmt-&gt;SetData(2, slotId);\n         stmt-&gt;SetData(3, item-&gt;GetGUID().GetCounter());\n         CharacterDatabase.ExecuteOrAppend(trans, stmt);\n\n@@ -508,7 +510,7 @@ void Guild::BankTab::SendText(Guild const* guild, WorldSession* session) const\n     if (session)\n     {\n         LOG_DEBUG(\"guild\", \"MSG_QUERY_GUILD_BANK_TEXT [{}]: Tabid: {}, Text: {}\"\n-                       , session-&gt;GetPlayerInfo(), m_tabId, m_text);\n+            , session-&gt;GetPlayerInfo(), m_tabId, m_text);\n         session-&gt;SendPacket(textQuery.Write());\n     }\n     else\n@@ -521,21 +523,21 @@ void Guild::BankTab::SendText(Guild const* guild, WorldSession* session) const\n // Member\n void Guild::Member::SetStats(Player* player)\n {\n-    m_name      = player-&gt;GetName();\n-    m_level     = player-&gt;GetLevel();\n-    m_class     = player-&gt;getClass();\n-    m_gender    = player-&gt;getGender();\n-    m_zoneId    = player-&gt;GetZoneId();\n+    m_name = player-&gt;GetName();\n+    m_level = player-&gt;GetLevel();\n+    m_class = player-&gt;getClass();\n+    m_gender = player-&gt;getGender();\n+    m_zoneId = player-&gt;GetZoneId();\n     m_accountId = player-&gt;GetSession()-&gt;GetAccountId();\n }\n\n void Guild::Member::SetStats(std::string_view name, uint8 level, uint8 _class, uint8 gender, uint32 zoneId, uint32 accountId)\n {\n-    m_name      = name;\n-    m_level     = level;\n-    m_class     = _class;\n-    m_gender    = gender;\n-    m_zoneId    = zoneId;\n+    m_name = name;\n+    m_level = level;\n+    m_class = _class;\n+    m_gender = gender;\n+    m_zoneId = zoneId;\n     m_accountId = accountId;\n }\n\n@@ -574,7 +576,7 @@ void Guild::Member::ChangeRank(uint8 newRank)\n         player-&gt;SetRank(newRank);\n\n     CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_UPD_GUILD_MEMBER_RANK);\n-    stmt-&gt;SetData (0, newRank);\n+    stmt-&gt;SetData(0, newRank);\n     stmt-&gt;SetData(1, m_guid.GetCounter());\n     CharacterDatabase.Execute(stmt);\n }\n@@ -589,7 +591,7 @@ void Guild::Member::SaveToDB(CharacterDatabaseTransaction trans) const\n     CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_INS_GUILD_MEMBER);\n     stmt-&gt;SetData(0, m_guildId);\n     stmt-&gt;SetData(1, m_guid.GetCounter());\n-    stmt-&gt;SetData (2, m_rankId);\n+    stmt-&gt;SetData(2, m_rankId);\n     stmt-&gt;SetData(3, m_publicNote);\n     stmt-&gt;SetData(4, m_officerNote);\n     CharacterDatabase.ExecuteOrAppend(trans, stmt);\n@@ -600,18 +602,18 @@ void Guild::Member::SaveToDB(CharacterDatabaseTransaction trans) const\n // In this case member has to be removed from guild.\n bool Guild::Member::LoadFromDB(Field* fields)\n {\n-    m_publicNote  = fields[3].Get&lt;std::string&gt;();\n+    m_publicNote = fields[3].Get&lt;std::string&gt;();\n     m_officerNote = fields[4].Get&lt;std::string&gt;();\n\n     for (uint8 i = 0; i &lt;= GUILD_BANK_MAX_TABS; ++i)\n         m_bankWithdraw[i] = fields[5 + i].Get&lt;uint32&gt;();\n\n     SetStats(fields[12].Get&lt;std::string&gt;(),\n-             fields[13].Get&lt;uint8&gt;(),                         // characters.level\n-             fields[14].Get&lt;uint8&gt;(),                         // characters.class\n-             fields[15].Get&lt;uint8&gt;(),                         // characters.gender\n-             fields[16].Get&lt;uint16&gt;(),                        // characters.zone\n-             fields[17].Get&lt;uint32&gt;());                       // characters.account\n+        fields[13].Get&lt;uint8&gt;(),                         // characters.level\n+        fields[14].Get&lt;uint8&gt;(),                         // characters.class\n+        fields[15].Get&lt;uint8&gt;(),                         // characters.gender\n+        fields[16].Get&lt;uint16&gt;(),                        // characters.zone\n+        fields[17].Get&lt;uint32&gt;());                       // characters.account\n     m_logoutTime = fields[18].Get&lt;uint32&gt;();                  // characters.logout_time\n\n     if (!CheckStats())\n@@ -691,11 +693,11 @@ void EmblemInfo::ReadPacket(WorldPackets::Guild::SaveGuildEmblem&amp; packet)\n\n void EmblemInfo::LoadFromDB(Field* fields)\n {\n-    m_style             = fields[3].Get&lt;uint8&gt;();\n-    m_color             = fields[4].Get&lt;uint8&gt;();\n-    m_borderStyle       = fields[5].Get&lt;uint8&gt;();\n-    m_borderColor       = fields[6].Get&lt;uint8&gt;();\n-    m_backgroundColor   = fields[7].Get&lt;uint8&gt;();\n+    m_style = fields[3].Get&lt;uint8&gt;();\n+    m_color = fields[4].Get&lt;uint8&gt;();\n+    m_borderStyle = fields[5].Get&lt;uint8&gt;();\n+    m_borderColor = fields[6].Get&lt;uint8&gt;();\n+    m_backgroundColor = fields[7].Get&lt;uint8&gt;();\n }\n\n void EmblemInfo::SaveToDB(uint32 guildId) const\n@@ -747,8 +749,8 @@ void Guild::MoveItemData::LogAction(MoveItemData* pFrom) const\n     ASSERT(pFrom-&gt;GetItem());\n\n     sScriptMgr-&gt;OnGuildItemMove(m_pGuild, m_pPlayer, pFrom-&gt;GetItem(),\n-                                pFrom-&gt;IsBank(), pFrom-&gt;GetContainer(), pFrom-&gt;GetSlotId(),\n-                                IsBank(), GetContainer(), GetSlotId());\n+        pFrom-&gt;IsBank(), pFrom-&gt;GetContainer(), pFrom-&gt;GetSlotId(),\n+        IsBank(), GetContainer(), GetSlotId());\n }\n\n inline void Guild::MoveItemData::CopySlots(SlotIds&amp; ids) const\n@@ -808,7 +810,7 @@ void Guild::PlayerMoveItemData::LogBankEvent(CharacterDatabaseTransaction trans,\n     ASSERT(pFrom);\n     // Bank -&gt; Char\n     m_pGuild-&gt;_LogBankEvent(trans, GUILD_BANK_LOG_WITHDRAW_ITEM, pFrom-&gt;GetContainer(), m_pPlayer-&gt;GetGUID(),\n-                            pFrom-&gt;GetItem()-&gt;GetEntry(), count);\n+        pFrom-&gt;GetItem()-&gt;GetEntry(), count);\n }\n\n inline InventoryResult Guild::PlayerMoveItemData::CanStore(Item* pItem, bool swap)\n@@ -829,7 +831,7 @@ bool Guild::BankMoveItemData::HasStoreRights(MoveItemData* pOther) const\n     // Do not check rights if item is being swapped within the same bank tab\n     if (pOther-&gt;IsBank() &amp;&amp; pOther-&gt;GetContainer() == m_container)\n         return true;\n-    return m_pGuild-&gt;_MemberHasTabRights(m_pPlayer-&gt;GetGUID(), m_container, GUILD_BANK_RIGHT_DEPOSIT_ITEM);\n+    return m_pGuild-&gt;MemberHasTabRights(m_pPlayer-&gt;GetGUID(), m_container, GUILD_BANK_RIGHT_DEPOSIT_ITEM);\n }\n\n bool Guild::BankMoveItemData::HasWithdrawRights(MoveItemData* pOther) const\n@@ -881,7 +883,7 @@ Item* Guild::BankMoveItemData::StoreItem(CharacterDatabaseTransaction trans, Ite\n         ++itr;\n\n         LOG_DEBUG(\"guild\", \"GUILD STORAGE: StoreItem tab = {}, slot = {}, item = {}, count = {}\",\n-                       m_container, m_slotId, pItem-&gt;GetEntry(), pItem-&gt;GetCount());\n+            m_container, m_slotId, pItem-&gt;GetEntry(), pItem-&gt;GetCount());\n         pLastItem = _StoreItem(trans, pTab, pItem, pos, itr != m_vec.end());\n     }\n     return pLastItem;\n@@ -893,11 +895,11 @@ void Guild::BankMoveItemData::LogBankEvent(CharacterDatabaseTransaction trans, M\n     if (pFrom-&gt;IsBank())\n         // Bank -&gt; Bank\n         m_pGuild-&gt;_LogBankEvent(trans, GUILD_BANK_LOG_MOVE_ITEM, pFrom-&gt;GetContainer(), m_pPlayer-&gt;GetGUID(),\n-                                pFrom-&gt;GetItem()-&gt;GetEntry(), count, m_container);\n+            pFrom-&gt;GetItem()-&gt;GetEntry(), count, m_container);\n     else\n         // Char -&gt; Bank\n         m_pGuild-&gt;_LogBankEvent(trans, GUILD_BANK_LOG_DEPOSIT_ITEM, m_container, m_pPlayer-&gt;GetGUID(),\n-                                pFrom-&gt;GetItem()-&gt;GetEntry(), count);\n+            pFrom-&gt;GetItem()-&gt;GetEntry(), count);\n }\n\n void Guild::BankMoveItemData::LogAction(MoveItemData* pFrom) const\n@@ -984,7 +986,7 @@ void Guild::BankMoveItemData::CanStoreItemInTab(Item* pItem, uint8 skipSlotId, b\n InventoryResult Guild::BankMoveItemData::CanStore(Item* pItem, bool swap)\n {\n     LOG_DEBUG(\"guild\", \"GUILD STORAGE: CanStore() tab = {}, slot = {}, item = {}, count = {}\",\n-                   m_container, m_slotId, pItem-&gt;GetEntry(), pItem-&gt;GetCount());\n+        m_container, m_slotId, pItem-&gt;GetEntry(), pItem-&gt;GetCount());\n     uint32 count = pItem-&gt;GetCount();\n     // Soulbound items cannot be moved\n     if (pItem-&gt;IsSoulBound())\n@@ -1031,7 +1033,7 @@ InventoryResult Guild::BankMoveItemData::CanStore(Item* pItem, bool swap)\n }\n\n // Guild\n-Guild::Guild():\n+Guild::Guild() :\n     m_id(0),\n     m_createdDate(0),\n     m_accountsNumber(0),\n@@ -1065,7 +1067,7 @@ bool Guild::Create(Player* pLeader, std::string_view name)\n     m_createdDate = GameTime::GetGameTime().count();\n\n     LOG_DEBUG(\"guild\", \"GUILD: creating guild [{}] for leader {} ({})\",\n-              m_name, pLeader-&gt;GetName(), m_leaderGuid.ToString());\n+        m_name, pLeader-&gt;GetName(), m_leaderGuid.ToString());\n\n     CharacterDatabaseTransaction trans = CharacterDatabase.BeginTransaction();\n\n@@ -1075,7 +1077,7 @@ bool Guild::Create(Player* pLeader, std::string_view name)\n\n     uint8 index = 0;\n     stmt = CharacterDatabase.GetPreparedStatement(CHAR_INS_GUILD);\n-    stmt-&gt;SetData(  index, m_id);\n+    stmt-&gt;SetData(index, m_id);\n     stmt-&gt;SetData(++index, m_name);\n     stmt-&gt;SetData(++index, m_leaderGuid.GetCounter());\n     stmt-&gt;SetData(++index, m_info);\n@@ -1161,15 +1163,15 @@ void Guild::UpdateMemberData(Player* player, uint8 dataid, uint32 value)\n     {\n         switch (dataid)\n         {\n-            case GUILD_MEMBER_DATA_ZONEID:\n-                member-&gt;SetZoneID(value);\n-                break;\n-            case GUILD_MEMBER_DATA_LEVEL:\n-                member-&gt;SetLevel(value);\n-                break;\n-            default:\n-                LOG_ERROR(\"guild\", \"Guild::UpdateMemberData: Called with incorrect DATAID {} (value {})\", dataid, value);\n-                return;\n+        case GUILD_MEMBER_DATA_ZONEID:\n+            member-&gt;SetZoneID(value);\n+            break;\n+        case GUILD_MEMBER_DATA_LEVEL:\n+            member-&gt;SetLevel(value);\n+            break;\n+        default:\n+            LOG_ERROR(\"guild\", \"Guild::UpdateMemberData: Called with incorrect DATAID {} (value {})\", dataid, value);\n+            return;\n         }\n         //HandleRoster();\n     }\n@@ -1207,7 +1209,7 @@ void Guild::HandleRoster(WorldSession* session)\n     roster.RankData.reserve(m_ranks.size());\n     for (RankInfo const&amp; rank : m_ranks)\n     {\n-        WorldPackets::Guild::GuildRankData&amp; rankData =  roster.RankData.emplace_back();\n+        WorldPackets::Guild::GuildRankData&amp; rankData = roster.RankData.emplace_back();\n\n         rankData.Flags = rank.GetRights();\n         rankData.WithdrawGoldLimit = rank.GetBankMoneyPerDay();\n@@ -1218,7 +1220,7 @@ void Guild::HandleRoster(WorldSession* session)\n         }\n     }\n\n-    bool sendOfficerNote = _HasRankRight(session-&gt;GetPlayer(), GR_RIGHT_VIEWOFFNOTE);\n+    bool sendOfficerNote = HasRankRight(session-&gt;GetPlayer(), GR_RIGHT_VIEWOFFNOTE);\n     roster.MemberData.reserve(m_members.size());\n     for (auto const&amp; [guid, member] : m_members)\n     {\n@@ -1275,7 +1277,7 @@ void Guild::HandleSetMOTD(WorldSession* session, std::string_view motd)\n         return;\n\n     // Player must have rights to set MOTD\n-    if (!_HasRankRight(session-&gt;GetPlayer(), GR_RIGHT_SETMOTD))\n+    if (!HasRankRight(session-&gt;GetPlayer(), GR_RIGHT_SETMOTD))\n         SendCommandResult(session, GUILD_COMMAND_EDIT_MOTD, ERR_GUILD_PERMISSIONS);\n     else\n     {\n@@ -1298,7 +1300,7 @@ void Guild::HandleSetInfo(WorldSession* session, std::string_view info)\n         return;\n\n     // Player must have rights to set guild's info\n-    if (_HasRankRight(session-&gt;GetPlayer(), GR_RIGHT_MODIFY_GUILD_INFO))\n+    if (HasRankRight(session-&gt;GetPlayer(), GR_RIGHT_MODIFY_GUILD_INFO))\n     {\n         m_info = info;\n\n@@ -1331,6 +1333,12 @@ void Guild::HandleSetEmblem(WorldSession* session, const EmblemInfo&amp; emblemInfo)\n     }\n }\n\n+void Guild::HandleSetEmblem(EmblemInfo const&amp; emblemInfo)\n+{\n+    m_emblemInfo = emblemInfo;\n+    m_emblemInfo.SaveToDB(m_id);\n+}\n+\n void Guild::HandleSetLeader(WorldSession* session, std::string_view name)\n {\n     Player* player = session-&gt;GetPlayer();\n@@ -1356,7 +1364,7 @@ void Guild::HandleSetBankTabInfo(WorldSession* session, uint8 tabId, std::string\n     if (!tab)\n     {\n         LOG_ERROR(\"guild\", \"Guild::HandleSetBankTabInfo: Player {} trying to change bank tab info from unexisting tab {}.\",\n-                       session-&gt;GetPlayerInfo(), tabId);\n+            session-&gt;GetPlayerInfo(), tabId);\n         return;\n     }\n\n@@ -1367,7 +1375,7 @@ void Guild::HandleSetBankTabInfo(WorldSession* session, uint8 tabId, std::string\n void Guild::HandleSetMemberNote(WorldSession* session, std::string_view name, std::string_view note, bool isPublic)\n {\n     // Player must have rights to set public/officer note\n-    if (!_HasRankRight(session-&gt;GetPlayer(), isPublic ? GR_RIGHT_EPNOTE : GR_RIGHT_EOFFNOTE))\n+    if (!HasRankRight(session-&gt;GetPlayer(), isPublic ? GR_RIGHT_EPNOTE : GR_RIGHT_EOFFNOTE))\n         SendCommandResult(session, GUILD_COMMAND_PUBLIC_NOTE, ERR_GUILD_PERMISSIONS);\n     else if (Member* member = GetMember(name))\n     {\n@@ -1400,6 +1408,29 @@ void Guild::HandleSetRankInfo(WorldSession* session, uint8 rankId, std::string_v\n     }\n }\n\n+void Guild::HandleSetRankInfo(uint8 rankId, uint32 rights, std::string_view name, uint32 moneyPerDay)\n+{\n+    if (RankInfo* rankInfo = GetRankInfo(rankId))\n+    {\n+        if (!name.empty())\n+        {\n+            rankInfo-&gt;SetName(name);\n+        }\n+\n+        if (rights &gt; 0)\n+        {\n+            rankInfo-&gt;SetRights(rights);\n+        }\n+\n+        if (moneyPerDay &gt; 0)\n+        {\n+            _SetRankBankMoneyPerDay(rankId, moneyPerDay);\n+        }\n+\n+        _BroadcastEvent(GE_RANK_UPDATED, ObjectGuid::Empty, std::to_string(rankId), rankInfo-&gt;GetName(), std::to_string(m_ranks.size()));\n+    }\n+}\n+\n void Guild::HandleBuyBankTab(WorldSession* session, uint8 tabId)\n {\n     Player* player = session-&gt;GetPlayer();\n@@ -1470,7 +1501,7 @@ void Guild::HandleInviteMember(WorldSession* session, std::string const&amp; name)\n         return;\n     }\n     // Inviting player must have rights to invite\n-    if (!_HasRankRight(player, GR_RIGHT_INVITE))\n+    if (!HasRankRight(player, GR_RIGHT_INVITE))\n     {\n         SendCommandResult(session, GUILD_COMMAND_INVITE, ERR_GUILD_PERMISSIONS);\n         return;\n@@ -1541,7 +1572,7 @@ void Guild::HandleRemoveMember(WorldSession* session, std::string_view name)\n {\n     Player* player = session-&gt;GetPlayer();\n     // Player must have rights to remove members\n-    if (!_HasRankRight(player, GR_RIGHT_REMOVE))\n+    if (!HasRankRight(player, GR_RIGHT_REMOVE))\n         SendCommandResult(session, GUILD_COMMAND_REMOVE, ERR_GUILD_PERMISSIONS);\n     else if (Member* member = GetMember(name))\n     {\n@@ -1574,7 +1605,7 @@ void Guild::HandleUpdateMemberRank(WorldSession* session, std::string_view name,\n     Player* player = session-&gt;GetPlayer();\n     GuildCommandType type = demote ? GUILD_COMMAND_DEMOTE : GUILD_COMMAND_PROMOTE;\n     // Player must have rights to promote\n-    if (!_HasRankRight(player, demote ? GR_RIGHT_DEMOTE : GR_RIGHT_PROMOTE))\n+    if (!HasRankRight(player, demote ? GR_RIGHT_DEMOTE : GR_RIGHT_PROMOTE))\n         SendCommandResult(session, type, ERR_GUILD_PERMISSIONS);\n     // Promoted player must be a member of guild\n     else if (Member* member = GetMember(name))\n@@ -1708,7 +1739,7 @@ bool Guild::HandleMemberWithdrawMoney(WorldSession* session, uint32 amount, bool\n     if (uint32(_GetMemberRemainingMoney(*member)) &lt; amount)   // Check if we have enough slot/money today\n         return false;\n\n-    if (!(_GetRankRights(member-&gt;GetRankId()) &amp; GR_RIGHT_WITHDRAW_REPAIR) &amp;&amp; repair)\n+    if (!(GetRankRights(member-&gt;GetRankId()) &amp; GR_RIGHT_WITHDRAW_REPAIR) &amp;&amp; repair)\n         return false;\n\n     // Call script after validation and before money transfer.\n@@ -1850,7 +1881,7 @@ void Guild::SendPermissions(WorldSession* session)\n     WorldPackets::Guild::GuildPermissionsQueryResults queryResult;\n     queryResult.RankID = rankId;\n     queryResult.WithdrawGoldLimit = _GetRankBankMoneyPerDay(rankId);\n-    queryResult.Flags = _GetRankRights(rankId);\n+    queryResult.Flags = GetRankRights(rankId);\n     queryResult.NumTabs = _GetPurchasedTabsSize();\n\n     for (uint8 tabId = 0; tabId &lt; GUILD_BANK_MAX_TABS; ++tabId)\n@@ -1902,14 +1933,14 @@ void Guild::SendLoginInfo(WorldSession* session)\n // Loading methods\n bool Guild::LoadFromDB(Field* fields)\n {\n-    m_id            = fields[0].Get&lt;uint32&gt;();\n-    m_name          = fields[1].Get&lt;std::string&gt;();\n-    m_leaderGuid    = ObjectGuid::Create&lt;HighGuid::Player&gt;(fields[2].Get&lt;uint32&gt;());\n+    m_id = fields[0].Get&lt;uint32&gt;();\n+    m_name = fields[1].Get&lt;std::string&gt;();\n+    m_leaderGuid = ObjectGuid::Create&lt;HighGuid::Player&gt;(fields[2].Get&lt;uint32&gt;());\n     m_emblemInfo.LoadFromDB(fields);\n-    m_info          = fields[8].Get&lt;std::string&gt;();\n-    m_motd          = fields[9].Get&lt;std::string&gt;();\n-    m_createdDate   = time_t(fields[10].Get&lt;uint32&gt;());\n-    m_bankMoney     = fields[11].Get&lt;uint64&gt;();\n+    m_info = fields[8].Get&lt;std::string&gt;();\n+    m_motd = fields[9].Get&lt;std::string&gt;();\n+    m_createdDate = time_t(fields[10].Get&lt;uint32&gt;());\n+    m_bankMoney = fields[11].Get&lt;uint64&gt;();\n\n     uint8 purchasedTabs = uint8(fields[12].Get&lt;uint64&gt;());\n     if (purchasedTabs &gt; GUILD_BANK_MAX_TABS)\n@@ -1968,13 +1999,13 @@ bool Guild::LoadEventLogFromDB(Field* fields)\n     if (m_eventLog.CanInsert())\n     {\n         m_eventLog.LoadEvent(\n-                                  m_id,                                                         // guild id\n-                                  fields[1].Get&lt;uint32&gt;(),                                        // guid\n-                                  time_t(fields[6].Get&lt;uint32&gt;()),                                // timestamp\n-                                  GuildEventLogTypes(fields[2].Get&lt;uint8&gt;()),                     // event type\n-                                  ObjectGuid::Create&lt;HighGuid::Player&gt;(fields[3].Get&lt;uint32&gt;()),  // player guid 1\n-                                  ObjectGuid::Create&lt;HighGuid::Player&gt;(fields[4].Get&lt;uint32&gt;()),  // player guid 2\n-                                  fields[5].Get&lt;uint8&gt;());                                       // rank\n+            m_id,                                                         // guild id\n+            fields[1].Get&lt;uint32&gt;(),                                        // guid\n+            time_t(fields[6].Get&lt;uint32&gt;()),                                // timestamp\n+            GuildEventLogTypes(fields[2].Get&lt;uint8&gt;()),                     // event type\n+            ObjectGuid::Create&lt;HighGuid::Player&gt;(fields[3].Get&lt;uint32&gt;()),  // player guid 1\n+            ObjectGuid::Create&lt;HighGuid::Player&gt;(fields[4].Get&lt;uint32&gt;()),  // player guid 2\n+            fields[5].Get&lt;uint8&gt;());                                       // rank\n         return true;\n     }\n     return false;\n@@ -2006,15 +2037,15 @@ bool Guild::LoadBankEventLogFromDB(Field* fields)\n                 return false;\n             }\n             bankLog.LoadEvent(\n-                                m_id,                                                       // guild id\n-                                guid,                                                       // guid\n-                                time_t(fields[8].Get&lt;uint32&gt;()),                              // timestamp\n-                                dbTabId,                                                    // tab id\n-                                eventType,                                                  // event type\n-                                ObjectGuid::Create&lt;HighGuid::Player&gt;(fields[4].Get&lt;uint32&gt;()), // player guid\n-                                fields[5].Get&lt;uint32&gt;(),                                      // item or money\n-                                fields[6].Get&lt;uint16&gt;(),                                      // itam stack count\n-                                fields[7].Get&lt;uint8&gt;());                                     // dest tab id\n+                m_id,                                                       // guild id\n+                guid,                                                       // guid\n+                time_t(fields[8].Get&lt;uint32&gt;()),                              // timestamp\n+                dbTabId,                                                    // tab id\n+                eventType,                                                  // event type\n+                ObjectGuid::Create&lt;HighGuid::Player&gt;(fields[4].Get&lt;uint32&gt;()), // player guid\n+                fields[5].Get&lt;uint32&gt;(),                                      // item or money\n+                fields[6].Get&lt;uint16&gt;(),                                      // itam stack count\n+                fields[7].Get&lt;uint8&gt;());                                     // dest tab id\n         }\n     }\n     return true;\n@@ -2035,7 +2066,7 @@ bool Guild::LoadBankItemFromDB(Field* fields)\n     if (tabId &gt;= _GetPurchasedTabsSize())\n     {\n         LOG_ERROR(\"guild\", \"Invalid tab for item (GUID: {}, id: #{}) in guild bank, skipped.\",\n-                       fields[14].Get&lt;uint32&gt;(), fields[15].Get&lt;uint32&gt;());\n+            fields[14].Get&lt;uint32&gt;(), fields[15].Get&lt;uint32&gt;());\n         return false;\n     }\n     return m_bankTabs[tabId].LoadItemFromDB(fields);\n@@ -2116,13 +2147,13 @@ bool Guild::Validate()\n // Broadcasts\n void Guild::BroadcastToGuild(WorldSession* session, bool officerOnly, std::string_view msg, uint32 language) const\n {\n-    if (session &amp;&amp; session-&gt;GetPlayer() &amp;&amp; _HasRankRight(session-&gt;GetPlayer(), officerOnly ? GR_RIGHT_OFFCHATSPEAK : GR_RIGHT_GCHATSPEAK))\n+    if (session &amp;&amp; session-&gt;GetPlayer() &amp;&amp; HasRankRight(session-&gt;GetPlayer(), officerOnly ? GR_RIGHT_OFFCHATSPEAK : GR_RIGHT_GCHATSPEAK))\n     {\n         WorldPacket data;\n         ChatHandler::BuildChatPacket(data, officerOnly ? CHAT_MSG_OFFICER : CHAT_MSG_GUILD, Language(language), session-&gt;GetPlayer(), nullptr, msg);\n         for (auto const&amp; [guid, member] : m_members)\n             if (Player* player = member.FindPlayer())\n-                if (_HasRankRight(player, officerOnly ? GR_RIGHT_OFFCHATLISTEN : GR_RIGHT_GCHATLISTEN) &amp;&amp; !player-&gt;GetSocial()-&gt;HasIgnore(session-&gt;GetPlayer()-&gt;GetGUID()))\n+                if (HasRankRight(player, officerOnly ? GR_RIGHT_OFFCHATLISTEN : GR_RIGHT_GCHATLISTEN) &amp;&amp; !player-&gt;GetSocial()-&gt;HasIgnore(session-&gt;GetPlayer()-&gt;GetGUID()))\n                     player-&gt;SendDirectMessage(&amp;data);\n     }\n }\n@@ -2177,11 +2208,19 @@ void Guild::MassInviteToEvent(WorldSession* session, uint32 minLevel, uint32 max\n // Members handling\n bool Guild::AddMember(ObjectGuid guid, uint8 rankId)\n {\n+    Player* leader = nullptr;\n+    if (this-&gt;GetLeaderGUID())\n+    {\n+        leader = ObjectAccessor::FindConnectedPlayer(this-&gt;GetLeaderGUID());\n+    }\n+\n     Player* player = ObjectAccessor::FindConnectedPlayer(guid);\n+\n     // Player cannot be in guild\n     if (player)\n     {\n-        if (player-&gt;GetGuildId() != 0)\n+        if (player-&gt;GetGuildId() != 0 ||\n+            (!sWorld-&gt;getBoolConfig(CONFIG_ALLOW_TWO_SIDE_INTERACTION_GUILD) &amp;&amp; (leader &amp;&amp; leader-&gt;GetTeamId() != player-&gt;GetTeamId())))\n             return false;\n     }\n     else if (sCharacterCache-&gt;GetCharacterGuildIdByGuid(guid) != 0)\n@@ -2346,7 +2385,7 @@ bool Guild::ChangeMemberRank(ObjectGuid guid, uint8 newRank)\n void Guild::SwapItems(Player* player, uint8 tabId, uint8 slotId, uint8 destTabId, uint8 destSlotId, uint32 splitedAmount)\n {\n     if (tabId &gt;= _GetPurchasedTabsSize() || slotId &gt;= GUILD_BANK_MAX_SLOTS ||\n-            destTabId &gt;= _GetPurchasedTabsSize() || destSlotId &gt;= GUILD_BANK_MAX_SLOTS)\n+        destTabId &gt;= _GetPurchasedTabsSize() || destSlotId &gt;= GUILD_BANK_MAX_SLOTS)\n         return;\n\n     if (tabId == destTabId &amp;&amp; slotId == destSlotId)\n@@ -2390,12 +2429,12 @@ void Guild::_CreateNewBankTab()\n\n     CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_DEL_GUILD_BANK_TAB);\n     stmt-&gt;SetData(0, m_id);\n-    stmt-&gt;SetData (1, tabId);\n+    stmt-&gt;SetData(1, tabId);\n     trans-&gt;Append(stmt);\n\n     stmt = CharacterDatabase.GetPreparedStatement(CHAR_INS_GUILD_BANK_TAB);\n     stmt-&gt;SetData(0, m_id);\n-    stmt-&gt;SetData (1, tabId);\n+    stmt-&gt;SetData(1, tabId);\n     trans-&gt;Append(stmt);\n\n     ++tabId;\n@@ -2415,10 +2454,10 @@ void Guild::_CreateDefaultGuildRanks(LocaleConstant loc)\n     stmt-&gt;SetData(0, m_id);\n     CharacterDatabase.Execute(stmt);\n\n-    _CreateRank(sObjectMgr-&gt;GetAcoreString(LANG_GUILD_MASTER,   loc), GR_RIGHT_ALL);\n-    _CreateRank(sObjectMgr-&gt;GetAcoreString(LANG_GUILD_OFFICER,  loc), GR_RIGHT_ALL);\n-    _CreateRank(sObjectMgr-&gt;GetAcoreString(LANG_GUILD_VETERAN,  loc), GR_RIGHT_GCHATLISTEN | GR_RIGHT_GCHATSPEAK);\n-    _CreateRank(sObjectMgr-&gt;GetAcoreString(LANG_GUILD_MEMBER,   loc), GR_RIGHT_GCHATLISTEN | GR_RIGHT_GCHATSPEAK);\n+    _CreateRank(sObjectMgr-&gt;GetAcoreString(LANG_GUILD_MASTER, loc), GR_RIGHT_ALL);\n+    _CreateRank(sObjectMgr-&gt;GetAcoreString(LANG_GUILD_OFFICER, loc), GR_RIGHT_ALL);\n+    _CreateRank(sObjectMgr-&gt;GetAcoreString(LANG_GUILD_VETERAN, loc), GR_RIGHT_GCHATLISTEN | GR_RIGHT_GCHATSPEAK);\n+    _CreateRank(sObjectMgr-&gt;GetAcoreString(LANG_GUILD_MEMBER, loc), GR_RIGHT_GCHATLISTEN | GR_RIGHT_GCHATSPEAK);\n     _CreateRank(sObjectMgr-&gt;GetAcoreString(LANG_GUILD_INITIATE, loc), GR_RIGHT_GCHATLISTEN | GR_RIGHT_GCHATSPEAK);\n }\n\n@@ -2525,7 +2564,7 @@ inline std::string Guild::_GetRankName(uint8 rankId) const\n     return \"&lt;unknown&gt;\";\n }\n\n-inline uint32 Guild::_GetRankRights(uint8 rankId) const\n+uint32 Guild::GetRankRights(uint8 rankId) const\n {\n     if (const RankInfo* rankInfo = GetRankInfo(rankId))\n         return rankInfo-&gt;GetRights();\n@@ -2574,7 +2613,7 @@ inline int32 Guild::_GetMemberRemainingMoney(Member const&amp; member) const\n     if (rankId == GR_GUILDMASTER)\n         return static_cast&lt;int32&gt;(GUILD_WITHDRAW_MONEY_UNLIMITED);\n\n-    if ((_GetRankRights(rankId) &amp; (GR_RIGHT_WITHDRAW_REPAIR | GR_RIGHT_WITHDRAW_GOLD)) != 0)\n+    if ((GetRankRights(rankId) &amp; (GR_RIGHT_WITHDRAW_REPAIR | GR_RIGHT_WITHDRAW_GOLD)) != 0)\n     {\n         int32 remaining = _GetRankBankMoneyPerDay(rankId) - member.GetBankWithdrawValue(GUILD_BANK_MAX_TABS);\n         if (remaining &gt; 0)\n@@ -2589,12 +2628,12 @@ inline void Guild::_UpdateMemberWithdrawSlots(CharacterDatabaseTransaction trans\n     {\n         uint8 rankId = member-&gt;GetRankId();\n         if (rankId != GR_GUILDMASTER\n-                &amp;&amp; member-&gt;GetBankWithdrawValue(tabId) &lt; _GetRankBankTabSlotsPerDay(rankId, tabId))\n+            &amp;&amp; member-&gt;GetBankWithdrawValue(tabId) &lt; _GetRankBankTabSlotsPerDay(rankId, tabId))\n             member-&gt;UpdateBankWithdrawValue(trans, tabId, 1);\n     }\n }\n\n-inline bool Guild::_MemberHasTabRights(ObjectGuid guid, uint8 tabId, uint32 rights) const\n+bool Guild::MemberHasTabRights(ObjectGuid guid, uint8 tabId, uint32 rights) const\n {\n     if (const Member* member = GetMember(guid))\n     {\n@@ -2606,6 +2645,19 @@ inline bool Guild::_MemberHasTabRights(ObjectGuid guid, uint8 tabId, uint32 righ\n     return false;\n }\n\n+bool Guild::HasRankRight(Player* player, uint32 right) const\n+{\n+    if (player)\n+    {\n+        if (Member const* member = GetMember(player-&gt;GetGUID()))\n+        {\n+            return (GetRankRights(member-&gt;GetRankId()) &amp; right) != GR_RIGHT_EMPTY;\n+        }\n+    }\n+\n+    return false;\n+}\n+\n // Add new event log record\n inline void Guild::_LogEvent(GuildEventLogTypes eventType, ObjectGuid playerGuid1, ObjectGuid playerGuid2, uint8 newRank)\n {\n@@ -2751,7 +2803,7 @@ bool Guild::_DoItemsMove(MoveItemData* pSrc, MoveItemData* pDest, bool sendError\n void Guild::_SendBankContent(WorldSession* session, uint8 tabId, bool sendAllSlots) const\n {\n     ObjectGuid guid = session-&gt;GetPlayer()-&gt;GetGUID();\n-    if (!_MemberHasTabRights(guid, tabId, GUILD_BANK_RIGHT_VIEW_TAB))\n+    if (!MemberHasTabRights(guid, tabId, GUILD_BANK_RIGHT_VIEW_TAB))\n         return;\n\n     _SendBankList(session, tabId, sendAllSlots);\n@@ -2800,7 +2852,7 @@ void Guild::_SendBankContentUpdate(uint8 tabId, SlotIds slots) const\n }\n\n void Guild::_BroadcastEvent(GuildEvents guildEvent, ObjectGuid guid,\n-                            Optional&lt;std::string_view&gt; param1 /*= {}*/, Optional&lt;std::string_view&gt; param2 /*= {}*/, Optional&lt;std::string_view&gt; param3 /*= {}*/) const\n+    Optional&lt;std::string_view&gt; param1 /*= {}*/, Optional&lt;std::string_view&gt; param2 /*= {}*/, Optional&lt;std::string_view&gt; param3 /*= {}*/) const\n {\n     WorldPackets::Guild::GuildEvent event;\n     event.Type = guildEvent;\n@@ -2823,7 +2875,7 @@ void Guild::_BroadcastEvent(GuildEvents guildEvent, ObjectGuid guid,\n     LOG_DEBUG(\"guild\", \"SMSG_GUILD_EVENT [Broadcast] Event: {}\", guildEvent);\n }\n\n-void Guild::_SendBankList(WorldSession* session /* = nullptr*/, uint8 tabId /*= 0*/, bool sendAllSlots /*= false*/, SlotIds *slots /*= nullptr*/) const\n+void Guild::_SendBankList(WorldSession* session /* = nullptr*/, uint8 tabId /*= 0*/, bool sendAllSlots /*= false*/, SlotIds* slots /*= nullptr*/) const\n {\n     if (!sScriptMgr-&gt;CanGuildSendBankList(this, session, tabId, sendAllSlots))\n         return;\n@@ -2849,47 +2901,47 @@ void Guild::_SendBankList(WorldSession* session /* = nullptr*/, uint8 tabId /*=\n     if (BankTab const* tab = GetBankTab(tabId))\n     {\n         auto fillItems = [&amp;](auto begin, auto end, bool skipEmpty)\n-        {\n-            for (auto itr = begin; itr != end; ++itr)\n             {\n-                if (Item* tabItem = tab-&gt;GetItem(*itr))\n+                for (auto itr = begin; itr != end; ++itr)\n                 {\n-                    WorldPackets::Guild::GuildBankItemInfo itemInfo;\n-\n-                    itemInfo.Slot = *itr;\n-                    itemInfo.ItemID = tabItem-&gt;GetEntry();\n-                    itemInfo.Count = int32(tabItem-&gt;GetCount());\n-                    itemInfo.Charges = int32(std::abs(tabItem-&gt;GetSpellCharges()));\n-                    itemInfo.EnchantmentID = int32(tabItem-&gt;GetEnchantmentId(PERM_ENCHANTMENT_SLOT));\n-                    itemInfo.Flags = tabItem-&gt;GetInt32Value(ITEM_FIELD_FLAGS);\n-                    itemInfo.RandomPropertiesID = tabItem-&gt;GetItemRandomPropertyId();\n-                    itemInfo.RandomPropertiesSeed = int32(tabItem-&gt;GetItemSuffixFactor());\n-\n-                    for (uint32 socketSlot = 0; socketSlot &lt; MAX_GEM_SOCKETS; ++socketSlot)\n+                    if (Item* tabItem = tab-&gt;GetItem(*itr))\n                     {\n-                        if (uint32 enchId = tabItem-&gt;GetEnchantmentId(EnchantmentSlot(SOCK_ENCHANTMENT_SLOT + socketSlot)))\n+                        WorldPackets::Guild::GuildBankItemInfo itemInfo;\n+\n+                        itemInfo.Slot = *itr;\n+                        itemInfo.ItemID = tabItem-&gt;GetEntry();\n+                        itemInfo.Count = int32(tabItem-&gt;GetCount());\n+                        itemInfo.Charges = int32(std::abs(tabItem-&gt;GetSpellCharges()));\n+                        itemInfo.EnchantmentID = int32(tabItem-&gt;GetEnchantmentId(PERM_ENCHANTMENT_SLOT));\n+                        itemInfo.Flags = tabItem-&gt;GetInt32Value(ITEM_FIELD_FLAGS);\n+                        itemInfo.RandomPropertiesID = tabItem-&gt;GetItemRandomPropertyId();\n+                        itemInfo.RandomPropertiesSeed = int32(tabItem-&gt;GetItemSuffixFactor());\n+\n+                        for (uint32 socketSlot = 0; socketSlot &lt; MAX_GEM_SOCKETS; ++socketSlot)\n                         {\n-                            WorldPackets::Guild::GuildBankSocketEnchant gem;\n-                            gem.SocketIndex = socketSlot;\n-                            gem.SocketEnchantID = int32(enchId);\n-                            itemInfo.SocketEnchant.push_back(gem);\n+                            if (uint32 enchId = tabItem-&gt;GetEnchantmentId(EnchantmentSlot(SOCK_ENCHANTMENT_SLOT + socketSlot)))\n+                            {\n+                                WorldPackets::Guild::GuildBankSocketEnchant gem;\n+                                gem.SocketIndex = socketSlot;\n+                                gem.SocketEnchantID = int32(enchId);\n+                                itemInfo.SocketEnchant.push_back(gem);\n+                            }\n                         }\n-                    }\n\n-                    packet.ItemInfo.push_back(itemInfo);\n-                }\n-                else if (!skipEmpty)\n-                {\n-                    WorldPackets::Guild::GuildBankItemInfo itemInfo;\n+                        packet.ItemInfo.push_back(itemInfo);\n+                    }\n+                    else if (!skipEmpty)\n+                    {\n+                        WorldPackets::Guild::GuildBankItemInfo itemInfo;\n\n-                    itemInfo.Slot = *itr;\n-                    itemInfo.ItemID = 0;\n+                        itemInfo.Slot = *itr;\n+                        itemInfo.ItemID = 0;\n\n-                    packet.ItemInfo.push_back(itemInfo);\n+                        packet.ItemInfo.push_back(itemInfo);\n+                    }\n                 }\n-            }\n\n-        };\n+            };\n\n         if (sendAllSlots)\n             fillItems(boost::make_counting_iterator(uint8(0)), boost::make_counting_iterator(uint8(GUILD_BANK_MAX_SLOTS)), true);\n@@ -2904,7 +2956,7 @@ void Guild::_SendBankList(WorldSession* session /* = nullptr*/, uint8 tabId /*=\n\n         session-&gt;SendPacket(packet.Write());\n         LOG_DEBUG(\"guild\", \"SMSG_GUILD_BANK_LIST [{}]: TabId: {}, FullSlots: {}, slots: {}\",\n-                     session-&gt;GetPlayerInfo(), tabId, sendAllSlots, packet.WithdrawalsRemaining);\n+            session-&gt;GetPlayerInfo(), tabId, sendAllSlots, packet.WithdrawalsRemaining);\n     }\n     else\n     {\n@@ -2914,7 +2966,7 @@ void Guild::_SendBankList(WorldSession* session /* = nullptr*/, uint8 tabId /*=\n             if (!member.ShouldReceiveBankPartialUpdatePackets())\n                 continue;\n\n-            if (!_MemberHasTabRights(member.GetGUID(), tabId, GUILD_BANK_RIGHT_VIEW_TAB))\n+            if (!MemberHasTabRights(member.GetGUID(), tabId, GUILD_BANK_RIGHT_VIEW_TAB))\n                 continue;\n\n             Player* player = member.FindPlayer();\n@@ -2924,7 +2976,7 @@ void Guild::_SendBankList(WorldSession* session /* = nullptr*/, uint8 tabId /*=\n             packet.SetWithdrawalsRemaining(_GetMemberRemainingSlots(member, tabId));\n             player-&gt;SendDirectMessage(packet.GetRawPacket());\n             LOG_DEBUG(\"guild\", \"SMSG_GUILD_BANK_LIST [{}]: TabId: {}, FullSlots: {}, slots: {}\"\n-                    , player-&gt;GetName(), tabId, sendAllSlots, packet.WithdrawalsRemaining);\n+                , player-&gt;GetName(), tabId, sendAllSlots, packet.WithdrawalsRemaining);\n         }\n     }\n }\ndiff --git a/src/server/game/Guilds/Guild.h b/src/server/game/Guilds/Guild.h\nindex ab5d47295d28a3..ceb935e86f61e7 100644\n--- a/src/server/game/Guilds/Guild.h\n+++ b/src/server/game/Guilds/Guild.h\n@@ -39,16 +39,16 @@ namespace WorldPackets\n\n enum GuildMisc\n {\n-    GUILD_BANK_MAX_TABS                 = 6,                    // send by client for money log also\n-    GUILD_BANK_MAX_SLOTS                = 98,\n-    GUILD_BANK_MONEY_LOGS_TAB           = 100,                  // used for money log in DB\n-    GUILD_RANKS_MIN_COUNT               = 5,\n-    GUILD_RANKS_MAX_COUNT               = 10,\n-    GUILD_RANK_NONE                     = 0xFF,\n-    GUILD_WITHDRAW_MONEY_UNLIMITED      = 0xFFFFFFFF,\n-    GUILD_WITHDRAW_SLOT_UNLIMITED       = 0xFFFFFFFF,\n-    GUILD_EVENT_LOG_GUID_UNDEFINED      = 0xFFFFFFFF,\n-    TAB_UNDEFINED                       = 0xFF,\n+    GUILD_BANK_MAX_TABS = 6,                    // send by client for money log also\n+    GUILD_BANK_MAX_SLOTS = 98,\n+    GUILD_BANK_MONEY_LOGS_TAB = 100,                  // used for money log in DB\n+    GUILD_RANKS_MIN_COUNT = 5,\n+    GUILD_RANKS_MAX_COUNT = 10,\n+    GUILD_RANK_NONE = 0xFF,\n+    GUILD_WITHDRAW_MONEY_UNLIMITED = 0xFFFFFFFF,\n+    GUILD_WITHDRAW_SLOT_UNLIMITED = 0xFFFFFFFF,\n+    GUILD_EVENT_LOG_GUID_UNDEFINED = 0xFFFFFFFF,\n+    TAB_UNDEFINED = 0xFF,\n };\n\n constexpr uint64 GUILD_BANK_MONEY_LIMIT = UI64LIT(0x7FFFFFFFFFFFF);\n@@ -62,183 +62,185 @@ enum GuildMemberData\n enum GuildDefaultRanks\n {\n     // These ranks can be modified, but they cannot be deleted\n-    GR_GUILDMASTER  = 0,\n-    GR_OFFICER      = 1,\n-    GR_VETERAN      = 2,\n-    GR_MEMBER       = 3,\n-    GR_INITIATE     = 4\n-                      // When promoting member server does: rank--\n-                      // When demoting member server does: rank++\n+    GR_GUILDMASTER = 0,\n+    GR_OFFICER = 1,\n+    GR_VETERAN = 2,\n+    GR_MEMBER = 3,\n+    GR_INITIATE = 4\n+    // When promoting member server does: rank--\n+    // When demoting member server does: rank++\n };\n\n enum GuildRankRights\n {\n-    GR_RIGHT_EMPTY                      = 0x00000040,\n-    GR_RIGHT_GCHATLISTEN                = GR_RIGHT_EMPTY | 0x00000001,\n-    GR_RIGHT_GCHATSPEAK                 = GR_RIGHT_EMPTY | 0x00000002,\n-    GR_RIGHT_OFFCHATLISTEN              = GR_RIGHT_EMPTY | 0x00000004,\n-    GR_RIGHT_OFFCHATSPEAK               = GR_RIGHT_EMPTY | 0x00000008,\n-    GR_RIGHT_INVITE                     = GR_RIGHT_EMPTY | 0x00000010,\n-    GR_RIGHT_REMOVE                     = GR_RIGHT_EMPTY | 0x00000020,\n-    GR_RIGHT_PROMOTE                    = GR_RIGHT_EMPTY | 0x00000080,\n-    GR_RIGHT_DEMOTE                     = GR_RIGHT_EMPTY | 0x00000100,\n-    GR_RIGHT_SETMOTD                    = GR_RIGHT_EMPTY | 0x00001000,\n-    GR_RIGHT_EPNOTE                     = GR_RIGHT_EMPTY | 0x00002000,\n-    GR_RIGHT_VIEWOFFNOTE                = GR_RIGHT_EMPTY | 0x00004000,\n-    GR_RIGHT_EOFFNOTE                   = GR_RIGHT_EMPTY | 0x00008000,\n-    GR_RIGHT_MODIFY_GUILD_INFO          = GR_RIGHT_EMPTY | 0x00010000,\n-    GR_RIGHT_WITHDRAW_GOLD_LOCK         = 0x00020000,                   // remove money withdraw capacity\n-    GR_RIGHT_WITHDRAW_REPAIR            = 0x00040000,                   // withdraw for repair\n-    GR_RIGHT_WITHDRAW_GOLD              = 0x00080000,                   // withdraw gold\n-    GR_RIGHT_CREATE_GUILD_EVENT         = 0x00100000,                   // wotlk\n-    GR_RIGHT_ALL                        = 0x001DF1FF\n+    GR_RIGHT_EMPTY = 0x00000040,\n+    GR_RIGHT_GCHATLISTEN = GR_RIGHT_EMPTY | 0x00000001,\n+    GR_RIGHT_GCHATSPEAK = GR_RIGHT_EMPTY | 0x00000002,\n+    GR_RIGHT_OFFCHATLISTEN = GR_RIGHT_EMPTY | 0x00000004,\n+    GR_RIGHT_OFFCHATSPEAK = GR_RIGHT_EMPTY | 0x00000008,\n+    GR_RIGHT_INVITE = GR_RIGHT_EMPTY | 0x00000010,\n+    GR_RIGHT_REMOVE = GR_RIGHT_EMPTY | 0x00000020,\n+    GR_RIGHT_PROMOTE = GR_RIGHT_EMPTY | 0x00000080,\n+    GR_RIGHT_DEMOTE = GR_RIGHT_EMPTY | 0x00000100,\n+    GR_RIGHT_SETMOTD = GR_RIGHT_EMPTY | 0x00001000,\n+    GR_RIGHT_EPNOTE = GR_RIGHT_EMPTY | 0x00002000,\n+    GR_RIGHT_VIEWOFFNOTE = GR_RIGHT_EMPTY | 0x00004000,\n+    GR_RIGHT_EOFFNOTE = GR_RIGHT_EMPTY | 0x00008000,\n+    GR_RIGHT_MODIFY_GUILD_INFO = GR_RIGHT_EMPTY | 0x00010000,\n+    GR_RIGHT_WITHDRAW_GOLD_LOCK = 0x00020000,                   // remove money withdraw capacity\n+    GR_RIGHT_WITHDRAW_REPAIR = 0x00040000,                   // withdraw for repair\n+    GR_RIGHT_WITHDRAW_GOLD = 0x00080000,                   // withdraw gold\n+    GR_RIGHT_CREATE_GUILD_EVENT = 0x00100000,                   // wotlk\n+    GR_RIGHT_ALL = 0x001DF1FF\n };\n\n enum GuildCommandType\n {\n-    GUILD_COMMAND_CREATE                = 0,\n-    GUILD_COMMAND_INVITE                = 1,\n-    GUILD_COMMAND_QUIT                  = 3,\n-    GUILD_COMMAND_ROSTER                = 5,\n-    GUILD_COMMAND_PROMOTE               = 6,\n-    GUILD_COMMAND_DEMOTE                = 7,\n-    GUILD_COMMAND_REMOVE                = 8,\n-    GUILD_COMMAND_CHANGE_LEADER         = 10,\n-    GUILD_COMMAND_EDIT_MOTD             = 11,\n-    GUILD_COMMAND_GUILD_CHAT            = 13,\n-    GUILD_COMMAND_FOUNDER               = 14,\n-    GUILD_COMMAND_CHANGE_RANK           = 16,\n-    GUILD_COMMAND_PUBLIC_NOTE           = 19,\n-    GUILD_COMMAND_VIEW_TAB              = 21,\n-    GUILD_COMMAND_MOVE_ITEM             = 22,\n-    GUILD_COMMAND_REPAIR                = 25,\n+    GUILD_COMMAND_CREATE = 0,\n+    GUILD_COMMAND_INVITE = 1,\n+    GUILD_COMMAND_QUIT = 3,\n+    GUILD_COMMAND_ROSTER = 5,\n+    GUILD_COMMAND_PROMOTE = 6,\n+    GUILD_COMMAND_DEMOTE = 7,\n+    GUILD_COMMAND_REMOVE = 8,\n+    GUILD_COMMAND_CHANGE_LEADER = 10,\n+    GUILD_COMMAND_EDIT_MOTD = 11,\n+    GUILD_COMMAND_GUILD_CHAT = 13,\n+    GUILD_COMMAND_FOUNDER = 14,\n+    GUILD_COMMAND_CHANGE_RANK = 16,\n+    GUILD_COMMAND_PUBLIC_NOTE = 19,\n+    GUILD_COMMAND_VIEW_TAB = 21,\n+    GUILD_COMMAND_MOVE_ITEM = 22,\n+    GUILD_COMMAND_REPAIR = 25,\n };\n\n enum GuildCommandError\n {\n-    ERR_GUILD_COMMAND_SUCCESS           = 0,\n-    ERR_GUILD_INTERNAL                  = 1,\n-    ERR_ALREADY_IN_GUILD                = 2,\n-    ERR_ALREADY_IN_GUILD_S              = 3,\n-    ERR_INVITED_TO_GUILD                = 4,\n-    ERR_ALREADY_INVITED_TO_GUILD_S      = 5,\n-    ERR_GUILD_NAME_INVALID              = 6,\n-    ERR_GUILD_NAME_EXISTS_S             = 7,\n-    ERR_GUILD_LEADER_LEAVE              = 8,\n-    ERR_GUILD_PERMISSIONS               = 8,\n-    ERR_GUILD_PLAYER_NOT_IN_GUILD       = 9,\n-    ERR_GUILD_PLAYER_NOT_IN_GUILD_S     = 10,\n-    ERR_GUILD_PLAYER_NOT_FOUND_S        = 11,\n-    ERR_GUILD_NOT_ALLIED                = 12,\n-    ERR_GUILD_RANK_TOO_HIGH_S           = 13,\n-    ERR_GUILD_RANK_TOO_LOW_S            = 14,\n-    ERR_GUILD_RANKS_LOCKED              = 17,\n-    ERR_GUILD_RANK_IN_USE               = 18,\n-    ERR_GUILD_IGNORING_YOU_S            = 19,\n-    ERR_GUILD_UNK1                      = 20, // Forces roster update\n-    ERR_GUILD_WITHDRAW_LIMIT            = 25,\n-    ERR_GUILD_NOT_ENOUGH_MONEY          = 26,\n-    ERR_GUILD_BANK_FULL                 = 28,\n-    ERR_GUILD_ITEM_NOT_FOUND            = 29,\n+    ERR_GUILD_COMMAND_SUCCESS = 0,\n+    ERR_GUILD_INTERNAL = 1,\n+    ERR_ALREADY_IN_GUILD = 2,\n+    ERR_ALREADY_IN_GUILD_S = 3,\n+    ERR_INVITED_TO_GUILD = 4,\n+    ERR_ALREADY_INVITED_TO_GUILD_S = 5,\n+    ERR_GUILD_NAME_INVALID = 6,\n+    ERR_GUILD_NAME_EXISTS_S = 7,\n+    ERR_GUILD_LEADER_LEAVE = 8,\n+    ERR_GUILD_PERMISSIONS = 8,\n+    ERR_GUILD_PLAYER_NOT_IN_GUILD = 9,\n+    ERR_GUILD_PLAYER_NOT_IN_GUILD_S = 10,\n+    ERR_GUILD_PLAYER_NOT_FOUND_S = 11,\n+    ERR_GUILD_NOT_ALLIED = 12,\n+    ERR_GUILD_RANK_TOO_HIGH_S = 13,\n+    ERR_GUILD_RANK_TOO_LOW_S = 14,\n+    ERR_GUILD_RANKS_LOCKED = 17,\n+    ERR_GUILD_RANK_IN_USE = 18,\n+    ERR_GUILD_IGNORING_YOU_S = 19,\n+    ERR_GUILD_UNK1 = 20, // Forces roster update\n+    ERR_GUILD_WITHDRAW_LIMIT = 25,\n+    ERR_GUILD_NOT_ENOUGH_MONEY = 26,\n+    ERR_GUILD_BANK_FULL = 28,\n+    ERR_GUILD_ITEM_NOT_FOUND = 29,\n };\n\n enum GuildEvents\n {\n-    GE_PROMOTION                        = 0,\n-    GE_DEMOTION                         = 1,\n-    GE_MOTD                             = 2,\n-    GE_JOINED                           = 3,\n-    GE_LEFT                             = 4,\n-    GE_REMOVED                          = 5,\n-    GE_LEADER_IS                        = 6,\n-    GE_LEADER_CHANGED                   = 7,\n-    GE_DISBANDED                        = 8,\n-    GE_TABARDCHANGE                     = 9,\n-    GE_RANK_UPDATED                     = 10,\n-    GE_RANK_DELETED                     = 11,\n-    GE_SIGNED_ON                        = 12,\n-    GE_SIGNED_OFF                       = 13,\n-    GE_GUILDBANKBAGSLOTS_CHANGED        = 14,   /// @todo: Sent when items are moved in gbank - all players with bank open will send tab query\n-    GE_BANK_TAB_PURCHASED               = 15,\n-    GE_BANK_TAB_UPDATED                 = 16,\n-    GE_BANK_MONEY_SET                   = 17,\n-    GE_BANK_TAB_AND_MONEY_UPDATED       = 18,\n-    GE_BANK_TEXT_CHANGED                = 19,\n+    GE_PROMOTION = 0,\n+    GE_DEMOTION = 1,\n+    GE_MOTD = 2,\n+    GE_JOINED = 3,\n+    GE_LEFT = 4,\n+    GE_REMOVED = 5,\n+    GE_LEADER_IS = 6,\n+    GE_LEADER_CHANGED = 7,\n+    GE_DISBANDED = 8,\n+    GE_TABARDCHANGE = 9,\n+    GE_RANK_UPDATED = 10,\n+    GE_RANK_DELETED = 11,\n+    GE_SIGNED_ON = 12,\n+    GE_SIGNED_OFF = 13,\n+    GE_GUILDBANKBAGSLOTS_CHANGED = 14,   /// @todo: Sent when items are moved in gbank - all players with bank open will send tab query\n+    GE_BANK_TAB_PURCHASED = 15,\n+    GE_BANK_TAB_UPDATED = 16,\n+    GE_BANK_MONEY_SET = 17,\n+    GE_BANK_TAB_AND_MONEY_UPDATED = 18,\n+    GE_BANK_TEXT_CHANGED = 19,\n };\n\n enum PetitionTurns\n {\n-    PETITION_TURN_OK                    = 0,\n-    PETITION_TURN_ALREADY_IN_GUILD      = 2,\n-    PETITION_TURN_NEED_MORE_SIGNATURES  = 4\n+    PETITION_TURN_OK = 0,\n+    PETITION_TURN_ALREADY_IN_GUILD = 2,\n+    PETITION_TURN_NEED_MORE_SIGNATURES = 4\n };\n\n enum PetitionSigns\n {\n-    PETITION_SIGN_OK                    = 0,\n-    PETITION_SIGN_ALREADY_SIGNED        = 1,\n-    PETITION_SIGN_ALREADY_IN_GUILD      = 2,\n-    PETITION_SIGN_CANT_SIGN_OWN         = 3,\n-    PETITION_SIGN_NOT_SERVER            = 4\n+    PETITION_SIGN_OK = 0,\n+    PETITION_SIGN_ALREADY_SIGNED = 1,\n+    PETITION_SIGN_ALREADY_IN_GUILD = 2,\n+    PETITION_SIGN_CANT_SIGN_OWN = 3,\n+    PETITION_SIGN_NOT_SERVER = 4\n };\n\n enum GuildBankRights\n {\n-    GUILD_BANK_RIGHT_VIEW_TAB           = 0x01,\n-    GUILD_BANK_RIGHT_PUT_ITEM           = 0x02,\n-    GUILD_BANK_RIGHT_UPDATE_TEXT        = 0x04,\n+    GUILD_BANK_RIGHT_VIEW_TAB = 0x01,\n+    GUILD_BANK_RIGHT_PUT_ITEM = 0x02,\n+    GUILD_BANK_RIGHT_UPDATE_TEXT = 0x04,\n\n-    GUILD_BANK_RIGHT_DEPOSIT_ITEM       = GUILD_BANK_RIGHT_VIEW_TAB | GUILD_BANK_RIGHT_PUT_ITEM,\n-    GUILD_BANK_RIGHT_FULL               = 0xFF\n+    GUILD_BANK_RIGHT_DEPOSIT_ITEM = GUILD_BANK_RIGHT_VIEW_TAB | GUILD_BANK_RIGHT_PUT_ITEM,\n+    GUILD_BANK_RIGHT_FULL = 0xFF\n };\n\n enum GuildBankEventLogTypes\n {\n-    GUILD_BANK_LOG_DEPOSIT_ITEM         = 1,\n-    GUILD_BANK_LOG_WITHDRAW_ITEM        = 2,\n-    GUILD_BANK_LOG_MOVE_ITEM            = 3,\n-    GUILD_BANK_LOG_DEPOSIT_MONEY        = 4,\n-    GUILD_BANK_LOG_WITHDRAW_MONEY       = 5,\n-    GUILD_BANK_LOG_REPAIR_MONEY         = 6,\n-    GUILD_BANK_LOG_MOVE_ITEM2           = 7,\n-    GUILD_BANK_LOG_UNK1                 = 8,\n-    GUILD_BANK_LOG_BUY_SLOT             = 9\n+    GUILD_BANK_LOG_DEPOSIT_ITEM = 1,\n+    GUILD_BANK_LOG_WITHDRAW_ITEM = 2,\n+    GUILD_BANK_LOG_MOVE_ITEM = 3,\n+    GUILD_BANK_LOG_DEPOSIT_MONEY = 4,\n+    GUILD_BANK_LOG_WITHDRAW_MONEY = 5,\n+    GUILD_BANK_LOG_REPAIR_MONEY = 6,\n+    GUILD_BANK_LOG_MOVE_ITEM2 = 7,\n+    GUILD_BANK_LOG_UNK1 = 8,\n+    GUILD_BANK_LOG_BUY_SLOT = 9\n };\n\n enum GuildEventLogTypes\n {\n-    GUILD_EVENT_LOG_INVITE_PLAYER       = 1,\n-    GUILD_EVENT_LOG_JOIN_GUILD          = 2,\n-    GUILD_EVENT_LOG_PROMOTE_PLAYER      = 3,\n-    GUILD_EVENT_LOG_DEMOTE_PLAYER       = 4,\n-    GUILD_EVENT_LOG_UNINVITE_PLAYER     = 5,\n-    GUILD_EVENT_LOG_LEAVE_GUILD         = 6\n+    GUILD_EVENT_LOG_INVITE_PLAYER = 1,\n+    GUILD_EVENT_LOG_JOIN_GUILD = 2,\n+    GUILD_EVENT_LOG_PROMOTE_PLAYER = 3,\n+    GUILD_EVENT_LOG_DEMOTE_PLAYER = 4,\n+    GUILD_EVENT_LOG_UNINVITE_PLAYER = 5,\n+    GUILD_EVENT_LOG_LEAVE_GUILD = 6\n };\n\n enum GuildEmblemError\n {\n-    ERR_GUILDEMBLEM_SUCCESS               = 0,\n+    ERR_GUILDEMBLEM_SUCCESS = 0,\n     ERR_GUILDEMBLEM_INVALID_TABARD_COLORS = 1,\n-    ERR_GUILDEMBLEM_NOGUILD               = 2,\n-    ERR_GUILDEMBLEM_NOTGUILDMASTER        = 3,\n-    ERR_GUILDEMBLEM_NOTENOUGHMONEY        = 4,\n-    ERR_GUILDEMBLEM_INVALIDVENDOR         = 5\n+    ERR_GUILDEMBLEM_NOGUILD = 2,\n+    ERR_GUILDEMBLEM_NOTGUILDMASTER = 3,\n+    ERR_GUILDEMBLEM_NOTENOUGHMONEY = 4,\n+    ERR_GUILDEMBLEM_INVALIDVENDOR = 5\n };\n\n enum GuildMemberFlags\n {\n-    GUILDMEMBER_STATUS_NONE             = 0x0000,\n-    GUILDMEMBER_STATUS_ONLINE           = 0x0001,\n-    GUILDMEMBER_STATUS_AFK              = 0x0002,\n-    GUILDMEMBER_STATUS_DND              = 0x0004,\n-    GUILDMEMBER_STATUS_MOBILE           = 0x0008, // remote chat from mobile app\n+    GUILDMEMBER_STATUS_NONE = 0x0000,\n+    GUILDMEMBER_STATUS_ONLINE = 0x0001,\n+    GUILDMEMBER_STATUS_AFK = 0x0002,\n+    GUILDMEMBER_STATUS_DND = 0x0004,\n+    GUILDMEMBER_STATUS_MOBILE = 0x0008, // remote chat from mobile app\n };\n\n // Emblem info\n class EmblemInfo\n {\n public:\n-    EmblemInfo() : m_style(0), m_color(0), m_borderStyle(0), m_borderColor(0), m_backgroundColor(0) { }\n+    EmblemInfo(uint32 /*style*/ = 0, uint32 /*color*/ = 0, uint32 /*borderStyle*/ = 0, uint32 /*borderColor*/ = 0, uint32 /*backgroundColor*/ = 0) :\n+        m_style(0), m_color(0), m_borderStyle(0), m_borderColor(0), m_backgroundColor(0) {\n+    }\n\n     void LoadFromDB(Field* fields);\n     void SaveToDB(uint32 guildId) const;\n@@ -262,9 +264,9 @@ class EmblemInfo\n class GuildBankRightsAndSlots\n {\n public:\n-    GuildBankRightsAndSlots() : tabId(TAB_UNDEFINED), rights(0), slots(0) { }\n-    GuildBankRightsAndSlots(uint8 _tabId) : tabId(_tabId), rights(0), slots(0) { }\n-    GuildBankRightsAndSlots(uint8 _tabId, uint8 _rights, uint32 _slots) : tabId(_tabId), rights(_rights), slots(_slots) { }\n+    GuildBankRightsAndSlots() : tabId(TAB_UNDEFINED), rights(0), slots(0) {}\n+    GuildBankRightsAndSlots(uint8 _tabId) : tabId(_tabId), rights(0), slots(0) {}\n+    GuildBankRightsAndSlots(uint8 _tabId, uint8 _rights, uint32 _slots) : tabId(_tabId), rights(_rights), slots(_slots) {}\n\n     void SetGuildMasterValues()\n     {\n@@ -295,7 +297,7 @@ class Guild\n     class Member\n     {\n     public:\n-        Member(uint32 guildId, ObjectGuid guid, uint8 rankId):\n+        Member(uint32 guildId, ObjectGuid guid, uint8 rankId) :\n             m_guildId(guildId),\n             m_guid(guid),\n             m_zoneId(0),\n@@ -403,8 +405,8 @@ class Guild\n     {\n     public:\n         LogEntry(uint32 guildId, ObjectGuid::LowType guid);\n-        LogEntry(uint32 guildId, ObjectGuid::LowType guid, time_t timestamp) : m_guildId(guildId), m_guid(guid), m_timestamp(timestamp) { }\n-        virtual ~LogEntry() { }\n+        LogEntry(uint32 guildId, ObjectGuid::LowType guid, time_t timestamp) : m_guildId(guildId), m_guid(guid), m_timestamp(timestamp) {}\n+        virtual ~LogEntry() {}\n\n         ObjectGuid::LowType GetGUID() const { return m_guid; }\n         uint64 GetTimestamp() const { return m_timestamp; }\n@@ -422,12 +424,14 @@ class Guild\n     {\n     public:\n         EventLogEntry(uint32 guildId, ObjectGuid::LowType guid, GuildEventLogTypes eventType, ObjectGuid playerGuid1, ObjectGuid playerGuid2, uint8 newRank) :\n-            LogEntry(guildId, guid), m_eventType(eventType), m_playerGuid1(playerGuid1), m_playerGuid2(playerGuid2), m_newRank(newRank) { }\n+            LogEntry(guildId, guid), m_eventType(eventType), m_playerGuid1(playerGuid1), m_playerGuid2(playerGuid2), m_newRank(newRank) {\n+        }\n\n         EventLogEntry(uint32 guildId, ObjectGuid::LowType guid, time_t timestamp, GuildEventLogTypes eventType, ObjectGuid playerGuid1, ObjectGuid playerGuid2, uint8 newRank) :\n-            LogEntry(guildId, guid, timestamp), m_eventType(eventType), m_playerGuid1(playerGuid1), m_playerGuid2(playerGuid2), m_newRank(newRank) { }\n+            LogEntry(guildId, guid, timestamp), m_eventType(eventType), m_playerGuid1(playerGuid1), m_playerGuid2(playerGuid2), m_newRank(newRank) {\n+        }\n\n-        ~EventLogEntry() override { }\n+        ~EventLogEntry() override {}\n\n         void SaveToDB(CharacterDatabaseTransaction trans) const override;\n         void WritePacket(WorldPackets::Guild::GuildEventLogQueryResults&amp; packet) const;\n@@ -458,13 +462,15 @@ class Guild\n\n         BankEventLogEntry(uint32 guildId, ObjectGuid::LowType guid, GuildBankEventLogTypes eventType, uint8 tabId, ObjectGuid playerGuid, uint32 itemOrMoney, uint16 itemStackCount, uint8 destTabId) :\n             LogEntry(guildId, guid), m_eventType(eventType), m_bankTabId(tabId), m_playerGuid(playerGuid),\n-            m_itemOrMoney(itemOrMoney), m_itemStackCount(itemStackCount), m_destTabId(destTabId) { }\n+            m_itemOrMoney(itemOrMoney), m_itemStackCount(itemStackCount), m_destTabId(destTabId) {\n+        }\n\n         BankEventLogEntry(uint32 guildId, ObjectGuid::LowType guid, time_t timestamp, uint8 tabId, GuildBankEventLogTypes eventType, ObjectGuid playerGuid, uint32 itemOrMoney, uint16 itemStackCount, uint8 destTabId) :\n             LogEntry(guildId, guid, timestamp), m_eventType(eventType), m_bankTabId(tabId), m_playerGuid(playerGuid),\n-            m_itemOrMoney(itemOrMoney), m_itemStackCount(itemStackCount), m_destTabId(destTabId) { }\n+            m_itemOrMoney(itemOrMoney), m_itemStackCount(itemStackCount), m_destTabId(destTabId) {\n+        }\n\n-        ~BankEventLogEntry() override { }\n+        ~BankEventLogEntry() override {}\n\n         void SaveToDB(CharacterDatabaseTransaction trans) const override;\n         void WritePacket(WorldPackets::Guild::GuildBankLogQueryResults&amp; packet) const;\n@@ -509,11 +515,12 @@ class Guild\n     class RankInfo\n     {\n     public:\n-        RankInfo(): m_guildId(0), m_rankId(GUILD_RANK_NONE), m_rights(GR_RIGHT_EMPTY), m_bankMoneyPerDay(0) { }\n-        RankInfo(uint32 guildId) : m_guildId(guildId), m_rankId(GUILD_RANK_NONE), m_rights(GR_RIGHT_EMPTY), m_bankMoneyPerDay(0) { }\n+        RankInfo() : m_guildId(0), m_rankId(GUILD_RANK_NONE), m_rights(GR_RIGHT_EMPTY), m_bankMoneyPerDay(0) {}\n+        RankInfo(uint32 guildId) : m_guildId(guildId), m_rankId(GUILD_RANK_NONE), m_rights(GR_RIGHT_EMPTY), m_bankMoneyPerDay(0) {}\n         RankInfo(uint32 guildId, uint8 rankId, std::string_view name, uint32 rights, uint32 money) :\n             m_guildId(guildId), m_rankId(rankId), m_name(name), m_rights(rights),\n-            m_bankMoneyPerDay(rankId != GR_GUILDMASTER ? money : GUILD_WITHDRAW_MONEY_UNLIMITED) { }\n+            m_bankMoneyPerDay(rankId != GR_GUILDMASTER ? money : GUILD_WITHDRAW_MONEY_UNLIMITED) {\n+        }\n\n         void LoadFromDB(Field* fields);\n         void SaveToDB(CharacterDatabaseTransaction trans) const;\n@@ -572,7 +579,7 @@ class Guild\n         std::string const&amp; GetIcon() const { return m_icon; }\n         std::string const&amp; GetText() const { return m_text; }\n\n-        inline Item* GetItem(uint8 slotId) const { return slotId &lt; GUILD_BANK_MAX_SLOTS ?  m_items[slotId] : nullptr; }\n+        inline Item* GetItem(uint8 slotId) const { return slotId &lt; GUILD_BANK_MAX_SLOTS ? m_items[slotId] : nullptr; }\n         bool SetItem(CharacterDatabaseTransaction trans, uint8 slotId, Item* pItem);\n\n     private:\n@@ -590,8 +597,9 @@ class Guild\n     {\n     public:\n         MoveItemData(Guild* guild, Player* player, uint8 container, uint8 slotId) : m_pGuild(guild), m_pPlayer(player),\n-            m_container(container), m_slotId(slotId), m_pItem(nullptr), m_pClonedItem(nullptr) { }\n-        virtual ~MoveItemData() { }\n+            m_container(container), m_slotId(slotId), m_pItem(nullptr), m_pClonedItem(nullptr) {\n+        }\n+        virtual ~MoveItemData() {}\n\n         virtual bool IsBank() const = 0;\n         // Initializes item pointer. Returns true, if item exists, false otherwise.\n@@ -637,7 +645,8 @@ class Guild\n     {\n     public:\n         PlayerMoveItemData(Guild* guild, Player* player, uint8 container, uint8 slotId) :\n-            MoveItemData(guild, player, container, slotId) { }\n+            MoveItemData(guild, player, container, slotId) {\n+        }\n\n         bool IsBank() const override { return false; }\n         bool InitItem() override;\n@@ -652,7 +661,8 @@ class Guild\n     {\n     public:\n         BankMoveItemData(Guild* guild, Player* player, uint8 container, uint8 slotId) :\n-            MoveItemData(guild, player, container, slotId) { }\n+            MoveItemData(guild, player, container, slotId) {\n+        }\n\n         bool IsBank() const override { return true; }\n         bool InitItem() override;\n@@ -696,11 +706,13 @@ class Guild\n     void HandleQuery(WorldSession* session);\n     void HandleSetMOTD(WorldSession* session, std::string_view motd);\n     void HandleSetInfo(WorldSession* session, std::string_view info);\n-    void HandleSetEmblem(WorldSession* session, const EmblemInfo&amp; emblemInfo);\n+    void HandleSetEmblem(WorldSession* session, EmblemInfo const&amp; emblemInfo);\n+    void HandleSetEmblem(EmblemInfo const&amp; emblemInfo);\n     void HandleSetLeader(WorldSession* session, std::string_view name);\n     void HandleSetBankTabInfo(WorldSession* session, uint8 tabId, std::string_view name, std::string_view icon);\n     void HandleSetMemberNote(WorldSession* session, std::string_view name, std::string_view note, bool isPublic);\n     void HandleSetRankInfo(WorldSession* session, uint8 rankId, std::string_view name, uint32 rights, uint32 moneyPerDay, std::array&lt;GuildBankRightsAndSlots, GUILD_BANK_MAX_TABS&gt; const&amp; rightsAndSlots);\n+    void HandleSetRankInfo(uint8 rankId, uint32 rights = 0, std::string_view name = \"\", uint32 moneyPerDay = 0);\n     void HandleBuyBankTab(WorldSession* session, uint8 tabId);\n     void HandleInviteMember(WorldSession* session, std::string const&amp; name);\n     void HandleAcceptMember(WorldSession* session);\n@@ -779,6 +791,10 @@ class Guild\n     [[nodiscard]] bool ModifyBankMoney(CharacterDatabaseTransaction trans, const uint64&amp; amount, bool add) { return _ModifyBankMoney(trans, amount, add); }\n     [[nodiscard]] uint32 GetMemberSize() const { return m_members.size(); }\n\n+    bool MemberHasTabRights(ObjectGuid guid, uint8 tabId, uint32 rights) const;\n+    bool HasRankRight(Player* player, uint32 right) const;\n+    uint32 GetRankRights(uint8 rankId) const;\n+\n protected:\n     uint32 m_id;\n     std::string m_name;\n@@ -803,13 +819,6 @@ class Guild\n     inline uint8 _GetRanksSize() const { return uint8(m_ranks.size()); }\n     inline const RankInfo* GetRankInfo(uint8 rankId) const { return rankId &lt; _GetRanksSize() ? &amp;m_ranks[rankId] : nullptr; }\n     inline RankInfo* GetRankInfo(uint8 rankId) { return rankId &lt; _GetRanksSize() ? &amp;m_ranks[rankId] : nullptr; }\n-    inline bool _HasRankRight(Player* player, uint32 right) const\n-    {\n-        if (player)\n-            if (Member const* member = GetMember(player-&gt;GetGUID()))\n-                return (_GetRankRights(member-&gt;GetRankId()) &amp; right) != GR_RIGHT_EMPTY;\n-        return false;\n-    }\n\n     inline uint8 _GetLowestRankId() const { return uint8(m_ranks.size() - 1); }\n\n@@ -840,7 +849,6 @@ class Guild\n     void _SetRankBankMoneyPerDay(uint8 rankId, uint32 moneyPerDay);\n     void _SetRankBankTabRightsAndSlots(uint8 rankId, GuildBankRightsAndSlots rightsAndSlots, bool saveToDB = true);\n     int8 _GetRankBankTabRights(uint8 rankId, uint8 tabId) const;\n-    uint32 _GetRankRights(uint8 rankId) const;\n     int32 _GetRankBankMoneyPerDay(uint8 rankId) const;\n     int32 _GetRankBankTabSlotsPerDay(uint8 rankId, uint8 tabId) const;\n     std::string _GetRankName(uint8 rankId) const;\n@@ -848,7 +856,6 @@ class Guild\n     int32 _GetMemberRemainingSlots(Member const&amp; member, uint8 tabId) const;\n     int32 _GetMemberRemainingMoney(Member const&amp; member) const;\n     void _UpdateMemberWithdrawSlots(CharacterDatabaseTransaction trans, ObjectGuid guid, uint8 tabId);\n-    bool _MemberHasTabRights(ObjectGuid guid, uint8 tabId, uint32 rights) const;\n\n     void _LogEvent(GuildEventLogTypes eventType, ObjectGuid playerGuid1, ObjectGuid playerGuid2 = ObjectGuid::Empty, uint8 newRank = 0);\n     void _LogBankEvent(CharacterDatabaseTransaction trans, GuildBankEventLogTypes eventType, uint8 tabId, ObjectGuid playerGuid, uint32 itemOrMoney, uint16 itemStackCount = 0, uint8 destTabId = 0);\ndiff --git a/src/server/game/Handlers/CharacterHandler.cpp b/src/server/game/Handlers/CharacterHandler.cpp\nindex eeff0d3d6488d3..97c8815d972718 100644\n--- a/src/server/game/Handlers/CharacterHandler.cpp\n+++ b/src/server/game/Handlers/CharacterHandler.cpp\n@@ -60,19 +60,9 @@\n #include \"WorldSession.h\"\n #include \"WorldSessionMgr.h\"\n\n-class LoginQueryHolder : public CharacterDatabaseQueryHolder\n+LoginQueryHolder::LoginQueryHolder(uint32 accountId, ObjectGuid guid) : m_accountId(accountId), m_guid(guid)\n {\n-private:\n-    uint32 m_accountId;\n-    ObjectGuid m_guid;\n-public:\n-    LoginQueryHolder(uint32 accountId, ObjectGuid guid)\n-        : m_accountId(accountId), m_guid(guid) { }\n-\n-    ObjectGuid GetGuid() const { return m_guid; }\n-    uint32 GetAccountId() const { return m_accountId; }\n-    bool Initialize();\n-};\n+}\n\n bool LoginQueryHolder::Initialize()\n {\n@@ -274,15 +264,15 @@ void WorldSession::HandleCharCreateOpcode(WorldPacket&amp; recvData)\n     std::shared_ptr&lt;CharacterCreateInfo&gt; createInfo = std::make_shared&lt;CharacterCreateInfo&gt;();\n\n     recvData &gt;&gt; createInfo-&gt;Name\n-             &gt;&gt; createInfo-&gt;Race\n-             &gt;&gt; createInfo-&gt;Class\n-             &gt;&gt; createInfo-&gt;Gender\n-             &gt;&gt; createInfo-&gt;Skin\n-             &gt;&gt; createInfo-&gt;Face\n-             &gt;&gt; createInfo-&gt;HairStyle\n-             &gt;&gt; createInfo-&gt;HairColor\n-             &gt;&gt; createInfo-&gt;FacialHair\n-             &gt;&gt; createInfo-&gt;OutfitId;\n+        &gt;&gt; createInfo-&gt;Race\n+        &gt;&gt; createInfo-&gt;Class\n+        &gt;&gt; createInfo-&gt;Gender\n+        &gt;&gt; createInfo-&gt;Skin\n+        &gt;&gt; createInfo-&gt;Face\n+        &gt;&gt; createInfo-&gt;HairStyle\n+        &gt;&gt; createInfo-&gt;HairColor\n+        &gt;&gt; createInfo-&gt;FacialHair\n+        &gt;&gt; createInfo-&gt;OutfitId;\n\n     if (AccountMgr::IsPlayerAccount(GetSecurity()))\n     {\n@@ -381,228 +371,233 @@ void WorldSession::HandleCharCreateOpcode(WorldPacket&amp; recvData)\n     stmt-&gt;SetData(0, createInfo-&gt;Name);\n\n     _queryProcessor.AddCallback(CharacterDatabase.AsyncQuery(stmt)\n-    .WithChainingPreparedCallback([this](QueryCallback&amp; queryCallback, PreparedQueryResult result)\n-    {\n-        if (result)\n-        {\n-            SendCharCreate(CHAR_CREATE_NAME_IN_USE);\n-            return;\n-        }\n-\n-        LoginDatabasePreparedStatement* stmt = LoginDatabase.GetPreparedStatement(LOGIN_SEL_SUM_REALM_CHARACTERS);\n-        stmt-&gt;SetData(0, GetAccountId());\n-        queryCallback.SetNextQuery(LoginDatabase.AsyncQuery(stmt));\n-    })\n-    .WithChainingPreparedCallback([this](QueryCallback&amp; queryCallback, PreparedQueryResult result)\n-    {\n-        uint64 acctCharCount = 0;\n-        if (result)\n-        {\n-            Field* fields = result-&gt;Fetch();\n-            acctCharCount = uint64(fields[0].Get&lt;double&gt;());\n-        }\n-\n-        if (acctCharCount &gt;= static_cast&lt;uint64&gt;(sWorld-&gt;getIntConfig(CONFIG_CHARACTERS_PER_ACCOUNT)))\n-        {\n-            SendCharCreate(CHAR_CREATE_ACCOUNT_LIMIT);\n-            return;\n-        }\n-\n-        CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_SEL_SUM_CHARS);\n-        stmt-&gt;SetData(0, GetAccountId());\n-        queryCallback.SetNextQuery(CharacterDatabase.AsyncQuery(stmt));\n-    })\n-    .WithChainingPreparedCallback([this, createInfo](QueryCallback&amp; queryCallback, PreparedQueryResult result)\n-    {\n-        if (result)\n-        {\n-            Field* fields = result-&gt;Fetch();\n-            createInfo-&gt;CharCount = uint8(fields[0].Get&lt;uint64&gt;()); // SQL's COUNT() returns uint64 but it will always be less than uint8.Max\n-\n-            if (createInfo-&gt;CharCount &gt;= sWorld-&gt;getIntConfig(CONFIG_CHARACTERS_PER_REALM))\n+        .WithChainingPreparedCallback([this](QueryCallback&amp; queryCallback, PreparedQueryResult result)\n             {\n-                SendCharCreate(CHAR_CREATE_SERVER_LIMIT);\n-                return;\n-            }\n-        }\n-\n-        bool allowTwoSideAccounts = !sWorld-&gt;IsPvPRealm() || sWorld-&gt;getBoolConfig(CONFIG_ALLOW_TWO_SIDE_ACCOUNTS) || !AccountMgr::IsPlayerAccount(GetSecurity());\n-        uint32 skipCinematics = sWorld-&gt;getIntConfig(CONFIG_SKIP_CINEMATICS);\n+                if (result)\n+                {\n+                    SendCharCreate(CHAR_CREATE_NAME_IN_USE);\n+                    return;\n+                }\n\n-        std::function&lt;void(PreparedQueryResult)&gt; finalizeCharacterCreation = [this, createInfo](PreparedQueryResult result)\n-        {\n-            if (!sScriptMgr-&gt;CanAccountCreateCharacter(GetAccountId(), createInfo-&gt;Race, createInfo-&gt;Class))\n-            {\n-                SendCharCreate(CHAR_CREATE_DISABLED);\n-                return;\n-            }\n-            bool haveSameRace = false;\n-            uint32 heroicReqLevel = sWorld-&gt;getIntConfig(CONFIG_CHARACTER_CREATING_MIN_LEVEL_FOR_HEROIC_CHARACTER);\n-            bool hasHeroicReqLevel = (heroicReqLevel == 0);\n-            bool allowTwoSideAccounts = !sWorld-&gt;IsPvPRealm() || sWorld-&gt;getBoolConfig(CONFIG_ALLOW_TWO_SIDE_ACCOUNTS) || !AccountMgr::IsPlayerAccount(GetSecurity());\n-            uint32 skipCinematics = sWorld-&gt;getIntConfig(CONFIG_SKIP_CINEMATICS);\n-            bool checkDeathKnightReqs = AccountMgr::IsPlayerAccount(GetSecurity()) &amp;&amp; createInfo-&gt;Class == CLASS_DEATH_KNIGHT;\n-\n-            if (result)\n+                LoginDatabasePreparedStatement* stmt = LoginDatabase.GetPreparedStatement(LOGIN_SEL_SUM_REALM_CHARACTERS);\n+                stmt-&gt;SetData(0, GetAccountId());\n+                queryCallback.SetNextQuery(LoginDatabase.AsyncQuery(stmt));\n+            })\n+        .WithChainingPreparedCallback([this](QueryCallback&amp; queryCallback, PreparedQueryResult result)\n             {\n-                TeamId teamId = Player::TeamIdForRace(createInfo-&gt;Race);\n-                uint32 freeDeathKnightSlots = sWorld-&gt;getIntConfig(CONFIG_HEROIC_CHARACTERS_PER_REALM);\n-\n-                Field* field = result-&gt;Fetch();\n-                uint8 accRace = field[1].Get&lt;uint8&gt;();\n-\n-                if (checkDeathKnightReqs)\n+                uint64 acctCharCount = 0;\n+                if (result)\n                 {\n-                    uint8 accClass = field[2].Get&lt;uint8&gt;();\n-                    if (accClass == CLASS_DEATH_KNIGHT)\n-                    {\n-                        if (freeDeathKnightSlots &gt; 0)\n-                            --freeDeathKnightSlots;\n-\n-                        if (freeDeathKnightSlots == 0)\n-                        {\n-                            SendCharCreate(CHAR_CREATE_UNIQUE_CLASS_LIMIT);\n-                            return;\n-                        }\n-                    }\n+                    Field* fields = result-&gt;Fetch();\n+                    acctCharCount = uint64(fields[0].Get&lt;double&gt;());\n+                }\n\n-                    if (!hasHeroicReqLevel)\n-                    {\n-                        uint8 accLevel = field[0].Get&lt;uint8&gt;();\n-                        if (accLevel &gt;= heroicReqLevel)\n-                            hasHeroicReqLevel = true;\n-                    }\n+                if (acctCharCount &gt;= static_cast&lt;uint64&gt;(sWorld-&gt;getIntConfig(CONFIG_CHARACTERS_PER_ACCOUNT)))\n+                {\n+                    SendCharCreate(CHAR_CREATE_ACCOUNT_LIMIT);\n+                    return;\n                 }\n\n-                // need to check team only for first character\n-                /// @todo what to if account already has characters of both races?\n-                if (!allowTwoSideAccounts)\n+                CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_SEL_SUM_CHARS);\n+                stmt-&gt;SetData(0, GetAccountId());\n+                queryCallback.SetNextQuery(CharacterDatabase.AsyncQuery(stmt));\n+            })\n+        .WithChainingPreparedCallback([this, createInfo](QueryCallback&amp; queryCallback, PreparedQueryResult result)\n+            {\n+                if (result)\n                 {\n-                    uint32 accTeam = 0;\n-                    if (accRace &gt; 0)\n-                        accTeam = Player::TeamIdForRace(accRace);\n+                    Field* fields = result-&gt;Fetch();\n+                    createInfo-&gt;CharCount = uint8(fields[0].Get&lt;uint64&gt;()); // SQL's COUNT() returns uint64 but it will always be less than uint8.Max\n\n-                    if (accTeam != teamId)\n+                    if (createInfo-&gt;CharCount &gt;= sWorld-&gt;getIntConfig(CONFIG_CHARACTERS_PER_REALM))\n                     {\n-                        SendCharCreate(CHAR_CREATE_PVP_TEAMS_VIOLATION);\n+                        SendCharCreate(CHAR_CREATE_SERVER_LIMIT);\n                         return;\n                     }\n                 }\n\n-                // search same race for cinematic or same class if need\n-                /// @todo check if cinematic already shown? (already logged in?; cinematic field)\n-                while ((skipCinematics == 1 &amp;&amp; !haveSameRace) || createInfo-&gt;Class == CLASS_DEATH_KNIGHT)\n-                {\n-                    if (!result-&gt;NextRow())\n-                        break;\n-\n-                    field = result-&gt;Fetch();\n-                    accRace = field[1].Get&lt;uint8&gt;();\n-\n-                    if (!haveSameRace)\n-                        haveSameRace = createInfo-&gt;Race == accRace;\n+                bool allowTwoSideAccounts = !sWorld-&gt;IsPvPRealm() || sWorld-&gt;getBoolConfig(CONFIG_ALLOW_TWO_SIDE_ACCOUNTS) || !AccountMgr::IsPlayerAccount(GetSecurity());\n+                uint32 skipCinematics = sWorld-&gt;getIntConfig(CONFIG_SKIP_CINEMATICS);\n\n-                    if (checkDeathKnightReqs)\n+                std::function&lt;void(PreparedQueryResult)&gt; finalizeCharacterCreation = [this, createInfo](PreparedQueryResult result)\n                     {\n-                        uint8 acc_class = field[2].Get&lt;uint8&gt;();\n-                        if (acc_class == CLASS_DEATH_KNIGHT)\n+                        if (!sScriptMgr-&gt;CanAccountCreateCharacter(GetAccountId(), createInfo-&gt;Race, createInfo-&gt;Class))\n+                        {\n+                            SendCharCreate(CHAR_CREATE_DISABLED);\n+                            return;\n+                        }\n+                        bool haveSameRace = false;\n+                        uint32 heroicReqLevel = sWorld-&gt;getIntConfig(CONFIG_CHARACTER_CREATING_MIN_LEVEL_FOR_HEROIC_CHARACTER);\n+                        bool hasHeroicReqLevel = (heroicReqLevel == 0);\n+                        bool allowTwoSideAccounts = !sWorld-&gt;IsPvPRealm() || sWorld-&gt;getBoolConfig(CONFIG_ALLOW_TWO_SIDE_ACCOUNTS) || !AccountMgr::IsPlayerAccount(GetSecurity());\n+                        uint32 skipCinematics = sWorld-&gt;getIntConfig(CONFIG_SKIP_CINEMATICS);\n+                        bool checkDeathKnightReqs = AccountMgr::IsPlayerAccount(GetSecurity()) &amp;&amp; createInfo-&gt;Class == CLASS_DEATH_KNIGHT;\n+\n+                        if (result)\n                         {\n-                            if (freeDeathKnightSlots &gt; 0)\n-                                --freeDeathKnightSlots;\n+                            TeamId teamId = Player::TeamIdForRace(createInfo-&gt;Race);\n+                            uint32 freeDeathKnightSlots = sWorld-&gt;getIntConfig(CONFIG_HEROIC_CHARACTERS_PER_REALM);\n+\n+                            Field* field = result-&gt;Fetch();\n+                            uint8 accRace = field[1].Get&lt;uint8&gt;();\n+\n+                            if (checkDeathKnightReqs)\n+                            {\n+                                uint8 accClass = field[2].Get&lt;uint8&gt;();\n+                                if (accClass == CLASS_DEATH_KNIGHT)\n+                                {\n+                                    if (freeDeathKnightSlots &gt; 0)\n+                                        --freeDeathKnightSlots;\n+\n+                                    if (freeDeathKnightSlots == 0)\n+                                    {\n+                                        SendCharCreate(CHAR_CREATE_UNIQUE_CLASS_LIMIT);\n+                                        return;\n+                                    }\n+                                }\n+\n+                                if (!hasHeroicReqLevel)\n+                                {\n+                                    uint8 accLevel = field[0].Get&lt;uint8&gt;();\n+                                    if (accLevel &gt;= heroicReqLevel)\n+                                        hasHeroicReqLevel = true;\n+                                }\n+                            }\n+\n+                            // need to check team only for first character\n+                            /// @todo what to if account already has characters of both races?\n+                            if (!allowTwoSideAccounts)\n+                            {\n+                                uint32 accTeam = 0;\n+                                if (accRace &gt; 0)\n+                                    accTeam = Player::TeamIdForRace(accRace);\n+\n+                                if (accTeam != teamId)\n+                                {\n+                                    SendCharCreate(CHAR_CREATE_PVP_TEAMS_VIOLATION);\n+                                    return;\n+                                }\n+                            }\n\n-                            if (freeDeathKnightSlots == 0)\n+                            // search same race for cinematic or same class if need\n+                            /// @todo check if cinematic already shown? (already logged in?; cinematic field)\n+                            while ((skipCinematics == 1 &amp;&amp; !haveSameRace) || createInfo-&gt;Class == CLASS_DEATH_KNIGHT)\n                             {\n-                                SendCharCreate(CHAR_CREATE_UNIQUE_CLASS_LIMIT);\n-                                return;\n+                                if (!result-&gt;NextRow())\n+                                    break;\n+\n+                                field = result-&gt;Fetch();\n+                                accRace = field[1].Get&lt;uint8&gt;();\n+\n+                                if (!haveSameRace)\n+                                    haveSameRace = createInfo-&gt;Race == accRace;\n+\n+                                if (checkDeathKnightReqs)\n+                                {\n+                                    uint8 acc_class = field[2].Get&lt;uint8&gt;();\n+                                    if (acc_class == CLASS_DEATH_KNIGHT)\n+                                    {\n+                                        if (freeDeathKnightSlots &gt; 0)\n+                                            --freeDeathKnightSlots;\n+\n+                                        if (freeDeathKnightSlots == 0)\n+                                        {\n+                                            SendCharCreate(CHAR_CREATE_UNIQUE_CLASS_LIMIT);\n+                                            return;\n+                                        }\n+                                    }\n+\n+                                    if (!hasHeroicReqLevel)\n+                                    {\n+                                        uint8 acc_level = field[0].Get&lt;uint8&gt;();\n+                                        if (acc_level &gt;= heroicReqLevel)\n+                                            hasHeroicReqLevel = true;\n+                                    }\n+                                }\n                             }\n                         }\n\n-                        if (!hasHeroicReqLevel)\n+                        if (checkDeathKnightReqs &amp;&amp; !hasHeroicReqLevel)\n                         {\n-                            uint8 acc_level = field[0].Get&lt;uint8&gt;();\n-                            if (acc_level &gt;= heroicReqLevel)\n-                                hasHeroicReqLevel = true;\n+                            SendCharCreate(CHAR_CREATE_LEVEL_REQUIREMENT);\n+                            return;\n                         }\n-                    }\n-                }\n-            }\n\n-            if (checkDeathKnightReqs &amp;&amp; !hasHeroicReqLevel)\n-            {\n-                SendCharCreate(CHAR_CREATE_LEVEL_REQUIREMENT);\n-                return;\n-            }\n+                        // Check name uniqueness in the same step as saving to database\n+                        if (sCharacterCache-&gt;GetCharacterGuidByName(createInfo-&gt;Name))\n+                        {\n+                            SendCharCreate(CHAR_CREATE_NAME_IN_USE);\n+                            return;\n+                        }\n\n-            // Check name uniqueness in the same step as saving to database\n-            if (sCharacterCache-&gt;GetCharacterGuidByName(createInfo-&gt;Name))\n-            {\n-                SendCharCreate(CHAR_CREATE_NAME_IN_USE);\n-                return;\n-            }\n+                        std::shared_ptr&lt;Player&gt; newChar(new Player(this), [](Player* ptr)\n+                            {\n+                                // Only when player is created correctly do clean\n+                                if (ptr-&gt;HasAtLoginFlag(AT_LOGIN_FIRST))\n+                                {\n+                                    ptr-&gt;CleanupsBeforeDelete();\n+                                }\n+                                delete ptr;\n+                            });\n+\n+                        newChar-&gt;GetMotionMaster()-&gt;Initialize();\n+                        if (!newChar-&gt;Create(sObjectMgr-&gt;GetGenerator&lt;HighGuid::Player&gt;().Generate(), createInfo.get()))\n+                        {\n+                            // Player not create (race/class/etc problem?)\n+                            SendCharCreate(CHAR_CREATE_ERROR);\n+                            return;\n+                        }\n\n-            std::shared_ptr&lt;Player&gt; newChar(new Player(this), [](Player* ptr)\n-            {\n-                // Only when player is created correctly do clean\n-                if (ptr-&gt;HasAtLoginFlag(AT_LOGIN_FIRST))\n-                {\n-                    ptr-&gt;CleanupsBeforeDelete();\n-                }\n-                delete ptr;\n-            });\n+                        if ((haveSameRace &amp;&amp; skipCinematics == 1) || skipCinematics == 2)\n+                            newChar-&gt;setCinematic(1);                         // not show intro\n\n-            newChar-&gt;GetMotionMaster()-&gt;Initialize();\n-            if (!newChar-&gt;Create(sObjectMgr-&gt;GetGenerator&lt;HighGuid::Player&gt;().Generate(), createInfo.get()))\n-            {\n-                // Player not create (race/class/etc problem?)\n-                SendCharCreate(CHAR_CREATE_ERROR);\n-                return;\n-            }\n+                        newChar-&gt;SetAtLoginFlag(AT_LOGIN_FIRST);              // First login\n\n-            if ((haveSameRace &amp;&amp; skipCinematics == 1) || skipCinematics == 2)\n-                newChar-&gt;setCinematic(1);                         // not show intro\n+                        CharacterDatabaseTransaction characterTransaction = CharacterDatabase.BeginTransaction();\n+                        LoginDatabaseTransaction trans = LoginDatabase.BeginTransaction();\n\n-            newChar-&gt;SetAtLoginFlag(AT_LOGIN_FIRST);              // First login\n+                        // Player created, save it now\n+                        newChar-&gt;SaveToDB(characterTransaction, true, false);\n+                        createInfo-&gt;CharCount++;\n\n-            CharacterDatabaseTransaction characterTransaction = CharacterDatabase.BeginTransaction();\n-            LoginDatabaseTransaction trans = LoginDatabase.BeginTransaction();\n+                        LoginDatabasePreparedStatement* stmt = LoginDatabase.GetPreparedStatement(LOGIN_DEL_REALM_CHARACTERS_BY_REALM);\n+                        stmt-&gt;SetData(0, GetAccountId());\n+                        stmt-&gt;SetData(1, realm.Id.Realm);\n+                        trans-&gt;Append(stmt);\n\n-            // Player created, save it now\n-            newChar-&gt;SaveToDB(characterTransaction, true, false);\n-            createInfo-&gt;CharCount++;\n+                        stmt = LoginDatabase.GetPreparedStatement(LOGIN_REP_REALM_CHARACTERS);\n+                        stmt-&gt;SetData(0, createInfo-&gt;CharCount);\n+                        stmt-&gt;SetData(1, GetAccountId());\n+                        stmt-&gt;SetData(2, realm.Id.Realm);\n+                        trans-&gt;Append(stmt);\n\n-            LoginDatabasePreparedStatement* stmt = LoginDatabase.GetPreparedStatement(LOGIN_REP_REALM_CHARACTERS);\n-            stmt-&gt;SetData(0, createInfo-&gt;CharCount);\n-            stmt-&gt;SetData(1, GetAccountId());\n-            stmt-&gt;SetData(2, realm.Id.Realm);\n-            trans-&gt;Append(stmt);\n+                        LoginDatabase.CommitTransaction(trans);\n\n-            LoginDatabase.CommitTransaction(trans);\n+                        AddTransactionCallback(CharacterDatabase.AsyncCommitTransaction(characterTransaction)).AfterComplete([this, newChar = std::move(newChar)](bool success)\n+                            {\n+                                if (success)\n+                                {\n+                                    LOG_INFO(\"entities.player.character\", \"Account: {} (IP: {}) Create Character: {} {}\", GetAccountId(), GetRemoteAddress(), newChar-&gt;GetName(), newChar-&gt;GetGUID().ToString());\n+                                    sScriptMgr-&gt;OnPlayerCreate(newChar.get());\n+                                    sCharacterCache-&gt;AddCharacterCacheEntry(newChar-&gt;GetGUID(), GetAccountId(), newChar-&gt;GetName(), newChar-&gt;getGender(), newChar-&gt;getRace(), newChar-&gt;getClass(), newChar-&gt;GetLevel());\n+                                    SendCharCreate(CHAR_CREATE_SUCCESS);\n+                                }\n+                                else\n+                                    SendCharCreate(CHAR_CREATE_ERROR);\n+                            });\n+                    };\n\n-            AddTransactionCallback(CharacterDatabase.AsyncCommitTransaction(characterTransaction)).AfterComplete([this, newChar = std::move(newChar)](bool success)\n-            {\n-                if (success)\n+                if (allowTwoSideAccounts &amp;&amp; !skipCinematics &amp;&amp; createInfo-&gt;Class != CLASS_DEATH_KNIGHT)\n                 {\n-                    LOG_INFO(\"entities.player.character\", \"Account: {} (IP: {}) Create Character: {} {}\", GetAccountId(), GetRemoteAddress(), newChar-&gt;GetName(), newChar-&gt;GetGUID().ToString());\n-                    sScriptMgr-&gt;OnPlayerCreate(newChar.get());\n-                    sCharacterCache-&gt;AddCharacterCacheEntry(newChar-&gt;GetGUID(), GetAccountId(), newChar-&gt;GetName(), newChar-&gt;getGender(), newChar-&gt;getRace(), newChar-&gt;getClass(), newChar-&gt;GetLevel());\n-                    SendCharCreate(CHAR_CREATE_SUCCESS);\n+                    finalizeCharacterCreation(PreparedQueryResult(nullptr));\n+                    return;\n                 }\n-                else\n-                    SendCharCreate(CHAR_CREATE_ERROR);\n-            });\n-        };\n\n-        if (allowTwoSideAccounts &amp;&amp; !skipCinematics &amp;&amp; createInfo-&gt;Class != CLASS_DEATH_KNIGHT)\n-        {\n-            finalizeCharacterCreation(PreparedQueryResult(nullptr));\n-            return;\n-        }\n-\n-        CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_SEL_CHAR_CREATE_INFO);\n-        stmt-&gt;SetData(0, GetAccountId());\n-        stmt-&gt;SetData(1, (skipCinematics == 1 || createInfo-&gt;Class == CLASS_DEATH_KNIGHT) ? 10 : 1);\n-        queryCallback.WithPreparedCallback(std::move(finalizeCharacterCreation)).SetNextQuery(CharacterDatabase.AsyncQuery(stmt));\n-    }));\n+                CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_SEL_CHAR_CREATE_INFO);\n+                stmt-&gt;SetData(0, GetAccountId());\n+                stmt-&gt;SetData(1, (skipCinematics == 1 || createInfo-&gt;Class == CLASS_DEATH_KNIGHT) ? 10 : 1);\n+                queryCallback.WithPreparedCallback(std::move(finalizeCharacterCreation)).SetNextQuery(CharacterDatabase.AsyncQuery(stmt));\n+            }));\n }\n\n void WorldSession::HandleCharDeleteOpcode(WorldPacket&amp; recvData)\n@@ -780,13 +775,14 @@ void WorldSession::HandlePlayerLoginOpcode(WorldPacket&amp; recvData)\n\n     m_playerLoading = true;\n     AddQueryHolderCallback(CharacterDatabase.DelayQueryHolder(holder)).AfterComplete([this](SQLQueryHolderBase const&amp; holder)\n-    {\n-        HandlePlayerLoginFromDB(static_cast&lt;LoginQueryHolder const&amp;&gt;(holder));\n-    });\n+        {\n+            HandlePlayerLoginFromDB(static_cast&lt;LoginQueryHolder const&amp;&gt;(holder));\n+        });\n }\n\n void WorldSession::HandlePlayerLoginFromDB(LoginQueryHolder const&amp; holder)\n {\n+    m_playerLoading = true;\n     ObjectGuid playerGuid = holder.GetGuid();\n\n     Player* pCurrChar = new Player(this);\n@@ -904,8 +900,7 @@ void WorldSession::HandlePlayerLoginFromDB(LoginQueryHolder const&amp; holder)\n     CharacterDatabase.Execute(stmt);\n\n     LoginDatabasePreparedStatement* loginStmt = LoginDatabase.GetPreparedStatement(LOGIN_UPD_ACCOUNT_ONLINE);\n-    loginStmt-&gt;SetData(0, realm.Id.Realm);\n-    loginStmt-&gt;SetData(1, GetAccountId());\n+    loginStmt-&gt;SetData(0, GetAccountId());\n     LoginDatabase.Execute(loginStmt);\n\n     pCurrChar-&gt;SetInGameTime(GameTime::GetGameTimeMS().count());\n@@ -956,7 +951,7 @@ void WorldSession::HandlePlayerLoginFromDB(LoginQueryHolder const&amp; holder)\n     if (sWorld-&gt;IsFFAPvPRealm() &amp;&amp; !pCurrChar-&gt;IsGameMaster() &amp;&amp; !pCurrChar-&gt;HasPlayerFlag(PLAYER_FLAGS_RESTING))\n         if (!pCurrChar-&gt;HasByteFlag(UNIT_FIELD_BYTES_2, 1, UNIT_BYTE2_FLAG_FFA_PVP))\n         {\n-            sScriptMgr-&gt;OnPlayerFfaPvpStateUpdate(pCurrChar,true);\n+            sScriptMgr-&gt;OnPlayerFfaPvpStateUpdate(pCurrChar, true);\n             pCurrChar-&gt;SetByteFlag(UNIT_FIELD_BYTES_2, 1, UNIT_BYTE2_FLAG_FFA_PVP);\n         }\n\n@@ -983,10 +978,10 @@ void WorldSession::HandlePlayerLoginFromDB(LoginQueryHolder const&amp; holder)\n     {\n         // If we process the check while players are loading they won't be notified of the changes.\n         pCurrChar-&gt;m_Events.AddEventAtOffset([pCurrChar]\n-        {\n-            pCurrChar-&gt;RemoveAtLoginFlag(AT_LOGIN_CHECK_ACHIEVS, true);\n-            pCurrChar-&gt;CheckAllAchievementCriteria();\n-        }, 1s);\n+            {\n+                pCurrChar-&gt;RemoveAtLoginFlag(AT_LOGIN_CHECK_ACHIEVS, true);\n+                pCurrChar-&gt;CheckAllAchievementCriteria();\n+            }, 1s);\n     }\n\n     bool firstLogin = pCurrChar-&gt;HasAtLoginFlag(AT_LOGIN_FIRST);\n@@ -1013,25 +1008,25 @@ void WorldSession::HandlePlayerLoginFromDB(LoginQueryHolder const&amp; holder)\n             ReputationMgr&amp; repMgr = pCurrChar-&gt;GetReputationMgr();\n\n             auto SendFullReputation = [&amp;repMgr](std::initializer_list&lt;uint32&gt; factionsList)\n-            {\n-                for (auto const&amp; itr : factionsList)\n                 {\n-                    repMgr.SetOneFactionReputation(sFactionStore.LookupEntry(itr), 42999.f, false);\n-                }\n-            };\n+                    for (auto const&amp; itr : factionsList)\n+                    {\n+                        repMgr.SetOneFactionReputation(sFactionStore.LookupEntry(itr), 42999.f, false);\n+                    }\n+                };\n\n             SendFullReputation({ 942, 935, 936, 1011, 970, 967, 989, 932, 934, 1038, 1077, 1106, 1104, 1090, 1098, 1156, 1073, 1105, 1119, 1091 });\n\n             switch (pCurrChar-&gt;GetFaction())\n             {\n-                case ALLIANCE:\n-                    SendFullReputation({ 72, 47, 69, 930, 730, 978, 54, 946, 1037, 1068, 1126, 1094, 1050 });\n-                    break;\n-                case HORDE:\n-                    SendFullReputation({ 76, 68, 81, 911, 729, 941, 530, 947, 1052, 1067, 1124, 1064, 1085 });\n-                    break;\n-                default:\n-                    break;\n+            case ALLIANCE:\n+                SendFullReputation({ 72, 47, 69, 930, 730, 978, 54, 946, 1037, 1068, 1126, 1094, 1050 });\n+                break;\n+            case HORDE:\n+                SendFullReputation({ 76, 68, 81, 911, 729, 941, 530, 947, 1052, 1067, 1124, 1064, 1085 });\n+                break;\n+            default:\n+                break;\n             }\n\n             repMgr.SendStates();\n@@ -1050,7 +1045,7 @@ void WorldSession::HandlePlayerLoginFromDB(LoginQueryHolder const&amp; holder)\n\n     std::string IP_str = GetRemoteAddress();\n     LOG_INFO(\"entities.player\", \"Account: {} (IP: {}) Login Character:[{}] ({}) Level: {}\",\n-                  GetAccountId(), IP_str, pCurrChar-&gt;GetName(), pCurrChar-&gt;GetGUID().ToString(), pCurrChar-&gt;GetLevel());\n+        GetAccountId(), IP_str, pCurrChar-&gt;GetName(), pCurrChar-&gt;GetGUID().ToString(), pCurrChar-&gt;GetLevel());\n\n     if (!pCurrChar-&gt;IsStandState() &amp;&amp; !pCurrChar-&gt;HasUnitState(UNIT_STATE_STUNNED))\n         pCurrChar-&gt;SetStandState(UNIT_STAND_STATE_STAND);\n@@ -1345,7 +1340,7 @@ void WorldSession::HandleCharRenameOpcode(WorldPacket&amp; recvData)\n     std::shared_ptr&lt;CharacterRenameInfo&gt; renameInfo = std::make_shared&lt;CharacterRenameInfo&gt;();\n\n     recvData &gt;&gt; renameInfo-&gt;Guid\n-             &gt;&gt; renameInfo-&gt;Name;\n+        &gt;&gt; renameInfo-&gt;Name;\n\n     // prevent character rename to invalid name\n     if (!normalizePlayerName(renameInfo-&gt;Name))\n@@ -1642,12 +1637,12 @@ void WorldSession::HandleCharCustomize(WorldPacket&amp; recvData)\n     }\n\n     recvData &gt;&gt; customizeInfo-&gt;Name\n-             &gt;&gt; customizeInfo-&gt;Gender\n-             &gt;&gt; customizeInfo-&gt;Skin\n-             &gt;&gt; customizeInfo-&gt;HairColor\n-             &gt;&gt; customizeInfo-&gt;HairStyle\n-             &gt;&gt; customizeInfo-&gt;FacialHair\n-             &gt;&gt; customizeInfo-&gt;Face;\n+        &gt;&gt; customizeInfo-&gt;Gender\n+        &gt;&gt; customizeInfo-&gt;Skin\n+        &gt;&gt; customizeInfo-&gt;HairColor\n+        &gt;&gt; customizeInfo-&gt;HairStyle\n+        &gt;&gt; customizeInfo-&gt;FacialHair\n+        &gt;&gt; customizeInfo-&gt;Face;\n\n     CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_SEL_CHAR_CUSTOMIZE_INFO);\n     stmt-&gt;SetData(0, customizeInfo-&gt;Guid.GetCounter());\n@@ -1779,10 +1774,10 @@ void WorldSession::HandleEquipmentSetSave(WorldPacket&amp; recvData)\n\n     EquipmentSet eqSet;\n\n-    eqSet.Guid      = setGuid;\n-    eqSet.Name      = name;\n-    eqSet.IconName  = iconName;\n-    eqSet.state     = EQUIPMENT_SET_NEW;\n+    eqSet.Guid = setGuid;\n+    eqSet.Name = name;\n+    eqSet.IconName = iconName;\n+    eqSet.state = EQUIPMENT_SET_NEW;\n\n     for (uint32 i = 0; i &lt; EQUIPMENT_SLOT_END; ++i)\n     {\n@@ -1937,13 +1932,13 @@ void WorldSession::HandleCharFactionOrRaceChange(WorldPacket&amp; recvData)\n     }\n\n     recvData &gt;&gt; factionChangeInfo-&gt;Name\n-             &gt;&gt; factionChangeInfo-&gt;Gender\n-             &gt;&gt; factionChangeInfo-&gt;Skin\n-             &gt;&gt; factionChangeInfo-&gt;HairColor\n-             &gt;&gt; factionChangeInfo-&gt;HairStyle\n-             &gt;&gt; factionChangeInfo-&gt;FacialHair\n-             &gt;&gt; factionChangeInfo-&gt;Face\n-             &gt;&gt; factionChangeInfo-&gt;Race;\n+        &gt;&gt; factionChangeInfo-&gt;Gender\n+        &gt;&gt; factionChangeInfo-&gt;Skin\n+        &gt;&gt; factionChangeInfo-&gt;HairColor\n+        &gt;&gt; factionChangeInfo-&gt;HairStyle\n+        &gt;&gt; factionChangeInfo-&gt;FacialHair\n+        &gt;&gt; factionChangeInfo-&gt;Face\n+        &gt;&gt; factionChangeInfo-&gt;Race;\n\n     // pussywizard:\n     if (ObjectAccessor::FindConnectedPlayer(factionChangeInfo-&gt;Guid) || sWorldSessionMgr-&gt;FindOfflineSessionForCharacterGUID(factionChangeInfo-&gt;Guid.GetCounter()))\n@@ -2221,16 +2216,16 @@ void WorldSession::HandleCharFactionOrRaceChangeCallback(std::shared_ptr&lt;Charact\n                 for (auto const&amp; itr : sTaxiPathSetBySource)\n                 {\n                     auto FillTaxiMask = [&amp;](uint8 field, uint32 mask)\n-                    {\n-                        if (playerClass == CLASS_DEATH_KNIGHT)\n-                        {\n-                            newTaxiMask[field] |= uint32(mask | (sDeathKnightTaxiNodesMask[field] &amp; mask));\n-                        }\n-                        else\n                         {\n-                            newTaxiMask[field] |= mask;\n-                        }\n-                    };\n+                            if (playerClass == CLASS_DEATH_KNIGHT)\n+                            {\n+                                newTaxiMask[field] |= uint32(mask | (sDeathKnightTaxiNodesMask[field] &amp; mask));\n+                            }\n+                            else\n+                            {\n+                                newTaxiMask[field] |= mask;\n+                            }\n+                        };\n\n                     uint32 nodeId = itr.first;\n                     uint8 field = (uint8)((nodeId - 1) / 32);\ndiff --git a/src/server/game/Handlers/ChatHandler.cpp b/src/server/game/Handlers/ChatHandler.cpp\nindex f191dc05ae2ae7..23417e1aaf9f50 100644\n--- a/src/server/game/Handlers/ChatHandler.cpp\n+++ b/src/server/game/Handlers/ChatHandler.cpp\n@@ -335,10 +335,13 @@ void WorldSession::HandleMessagechatOpcode(WorldPacket&amp; recvData)\n             msg.erase(end, msg.end());\n         }\n\n-        // Validate hyperlinks\n-        if (!ValidateHyperlinksAndMaybeKick(msg))\n+        // mod_playerbots: skip validation for playerbots module\n+        auto playerbotsHyperlink = msg.find(\"Hfound:\") != std::string::npos;\n+        if (!playerbotsHyperlink)\n         {\n-            return;\n+            // Validate hyperlinks\n+            if (!ValidateHyperlinksAndMaybeKick(msg))\n+                return;\n         }\n     }\n\ndiff --git a/src/server/game/Handlers/PetitionsHandler.cpp b/src/server/game/Handlers/PetitionsHandler.cpp\nindex 7ce5870153c617..464a9e06c6effd 100644\n--- a/src/server/game/Handlers/PetitionsHandler.cpp\n+++ b/src/server/game/Handlers/PetitionsHandler.cpp\n@@ -482,6 +482,8 @@ void WorldSession::HandlePetitionSignOpcode(WorldPacket&amp; recvData)\n             break;\n         }\n\n+    sScriptMgr-&gt;OnPlayerbotCheckPetitionAccount(_player, found);\n+\n     if (found)\n     {\n         WorldPacket data(SMSG_PETITION_SIGN_RESULTS, (8 + 8 + 4));\ndiff --git a/src/server/game/Maps/Map.cpp b/src/server/game/Maps/Map.cpp\nindex 0ea47ff8ab666c..6b82c16b811cf6 100644\n--- a/src/server/game/Maps/Map.cpp\n+++ b/src/server/game/Maps/Map.cpp\n@@ -1722,6 +1722,13 @@ void Map::SendObjectUpdates()\n     WorldPacket packet;                                     // here we allocate a std::vector with a size of 0x10000\n     for (UpdateDataMapType::iterator iter = update_players.begin(); iter != update_players.end(); ++iter)\n     {\n+        if (!sScriptMgr-&gt;OnPlayerbotCheckUpdatesToSend(iter-&gt;first))\n+        {\n+            iter-&gt;second.Clear();\n+            continue;\n+        }\n+\n+\n         iter-&gt;second.BuildPacket(packet);\n         iter-&gt;first-&gt;SendDirectMessage(&amp;packet);\n         packet.clear();                                     // clean the string\ndiff --git a/src/server/game/Misc/GameGraveyard.cpp b/src/server/game/Misc/GameGraveyard.cpp\nindex e497a92457b7b2..318632e2192047 100644\n--- a/src/server/game/Misc/GameGraveyard.cpp\n+++ b/src/server/game/Misc/GameGraveyard.cpp\n@@ -119,6 +119,11 @@ GraveyardStruct const* Graveyard::GetClosestGraveyard(Player* player, TeamId tea\n     uint32 areaId = 0;\n     player-&gt;GetZoneAndAreaId(zoneId, areaId);\n\n+    return GetClosestGraveyard(mapId, x, y, z, teamId, areaId, zoneId, player-&gt;getClass() == CLASS_DEATH_KNIGHT);\n+}\n+\n+GraveyardStruct const* Graveyard::GetClosestGraveyard(uint32 mapId, float x, float y, float z, TeamId teamId, uint32 areaId, uint32 zoneId, bool isDeathKnight)\n+{\n     if (!zoneId &amp;&amp; !areaId)\n     {\n         if (z &gt; -500)\n@@ -202,7 +207,7 @@ GraveyardStruct const* Graveyard::GetClosestGraveyard(Player* player, TeamId tea\n             GRAVEYARD_ARCHERUS  = 1405\n         };\n\n-        if (!player-&gt;IsClass(CLASS_DEATH_KNIGHT, CLASS_CONTEXT_GRAVEYARD) &amp;&amp; (graveyardLink.safeLocId == GRAVEYARD_EBON_HOLD || graveyardLink.safeLocId == GRAVEYARD_ARCHERUS))\n+        if (!isDeathKnight &amp;&amp; (graveyardLink.safeLocId == GRAVEYARD_EBON_HOLD || graveyardLink.safeLocId == GRAVEYARD_ARCHERUS))\n         {\n             continue;\n         }\ndiff --git a/src/server/game/Misc/GameGraveyard.h b/src/server/game/Misc/GameGraveyard.h\nindex 1ba22d1f728236..741dd0ea83be89 100644\n--- a/src/server/game/Misc/GameGraveyard.h\n+++ b/src/server/game/Misc/GameGraveyard.h\n@@ -57,6 +57,7 @@ class Graveyard\n     GraveyardStruct const* GetGraveyard(const std::string&amp; name) const;\n     GraveyardStruct const* GetDefaultGraveyard(TeamId teamId);\n     GraveyardStruct const* GetClosestGraveyard(Player* player, TeamId teamId, bool nearCorpse = false);\n+    GraveyardStruct const* GetClosestGraveyard(uint32 mapId, float x, float y, float z, TeamId teamId, uint32 areaId, uint32 zoneId, bool isDeathKnight);\n     GraveyardData const* FindGraveyardData(uint32 id, uint32 zone);\n     GraveyardContainer const&amp; GetGraveyardData() const { return _graveyardStore; }\n     bool AddGraveyardLink(uint32 id, uint32 zoneId, TeamId teamId, bool persist = true);\ndiff --git a/src/server/game/Movement/MotionMaster.cpp b/src/server/game/Movement/MotionMaster.cpp\nindex 8e4f91c16cea83..71d21d48a0c0e6 100644\n--- a/src/server/game/Movement/MotionMaster.cpp\n+++ b/src/server/game/Movement/MotionMaster.cpp\n@@ -923,6 +923,48 @@ void MotionMaster::MoveRotate(uint32 time, RotateDirection direction)\n     Mutate(new RotateMovementGenerator(time, direction), MOTION_SLOT_ACTIVE);\n }\n\n+#ifdef MOD_PLAYERBOTS\n+void MotionMaster::MoveKnockbackFromForPlayer(float srcX, float srcY, float speedXY, float speedZ)\n+{\n+    if (speedXY &lt;= 0.1f)\n+        return;\n+\n+    Position dest = _owner-&gt;GetPosition();\n+    float moveTimeHalf = speedZ / Movement::gravity;\n+    float dist = 2 * moveTimeHalf * speedXY;\n+    float max_height = -Movement::computeFallElevation(moveTimeHalf, false, -speedZ);\n+\n+    // Use a mmap raycast to get a valid destination.\n+    _owner-&gt;MovePositionToFirstCollision(dest, dist, _owner-&gt;GetRelativeAngle(srcX, srcY) + float(M_PI));\n+\n+    Movement::MoveSplineInit init(_owner);\n+    init.MoveTo(dest.GetPositionX(), dest.GetPositionY(), dest.GetPositionZ());\n+    init.SetParabolic(max_height, 0);\n+    init.SetOrientationFixed(true);\n+    init.SetVelocity(speedXY);\n+    Mutate(new EffectMovementGenerator(init, 0), MOTION_SLOT_CONTROLLED);\n+}\n+\n+// Similar to MovePoint except setting orientationInversed\n+void MotionMaster::MovePointBackwards(uint32 id, float x, float y, float z, bool generatePath, bool forceDestination, MovementSlot slot, float orientation /* = 0.0f*/)\n+{\n+    if (_owner-&gt;HasUnitFlag(UNIT_FLAG_DISABLE_MOVE))\n+        return;\n+\n+    if (_owner-&gt;IsPlayer())\n+    {\n+        LOG_DEBUG(\"movement.motionmaster\", \"Player ({}) targeted point (Id: {} X: {} Y: {} Z: {})\", _owner-&gt;GetGUID().ToString(), id, x, y, z);\n+        Mutate(new PointMovementGenerator&lt;Player&gt;(id, x, y, z, FORCED_MOVEMENT_NONE, 0.0f, orientation, nullptr, generatePath, forceDestination, std::nullopt, ObjectGuid::Empty, true), slot);\n+    }\n+    else\n+    {\n+        LOG_DEBUG(\"movement.motionmaster\", \"Creature ({}) targeted point (ID: {} X: {} Y: {} Z: {})\", _owner-&gt;GetGUID().ToString(), id, x, y, z);\n+        Mutate(new PointMovementGenerator&lt;Creature&gt;(id, x, y, z, FORCED_MOVEMENT_NONE, 0.0f, orientation, nullptr, generatePath, forceDestination, std::nullopt, ObjectGuid::Empty, true), slot);\n+    }\n+}\n+\n+#endif\n+\n void MotionMaster::propagateSpeedChange()\n {\n     /*Impl::container_type::iterator it = Impl::c.begin();\ndiff --git a/src/server/game/Movement/MotionMaster.h b/src/server/game/Movement/MotionMaster.h\nindex 4ac140260feef0..e4b2d2c20ce282 100644\n--- a/src/server/game/Movement/MotionMaster.h\n+++ b/src/server/game/Movement/MotionMaster.h\n@@ -262,7 +262,10 @@ class MotionMaster //: private std::stack&lt;MovementGenerator *&gt;\n     void MoveDistract(uint32 time);\n     void MoveWaypoint(uint32 path_id, bool repeatable, PathSource pathSource = PathSource::WAYPOINT_MGR);\n     void MoveRotate(uint32 time, RotateDirection direction);\n-\n+#ifdef MOD_PLAYERBOTS\n+    void MoveKnockbackFromForPlayer(float srcX, float srcY, float speedXY, float speedZ);\n+    void MovePointBackwards(uint32 id, float x, float y, float z, bool generatePath = true, bool forceDestination = true, MovementSlot slot = MOTION_SLOT_ACTIVE, float orientation = 0.0f);\n+#endif\n     [[nodiscard]] MovementGeneratorType GetCurrentMovementGeneratorType() const;\n     [[nodiscard]] MovementGeneratorType GetMotionSlotType(int slot) const;\n     bool HasMovementGeneratorType(MovementGeneratorType type) const;\ndiff --git a/src/server/game/Movement/MovementGenerators/PointMovementGenerator.cpp b/src/server/game/Movement/MovementGenerators/PointMovementGenerator.cpp\nindex 66ba79be5940c2..4851b52f61cb6b 100644\n--- a/src/server/game/Movement/MovementGenerators/PointMovementGenerator.cpp\n+++ b/src/server/game/Movement/MovementGenerators/PointMovementGenerator.cpp\n@@ -47,6 +47,11 @@ void PointMovementGenerator&lt;T&gt;::DoInitialize(T* unit)\n\n     i_recalculateSpeed = false;\n     Movement::MoveSplineInit init(unit);\n+\n+    // mod-playerbots\n+    if (_reverseOrientation)\n+        init.SetOrientationInversed();\n+\n     if (m_precomputedPath.size() &gt; 2) // pussywizard: for charge\n         init.MovebyPath(m_precomputedPath);\n     else if (_generatePath)\ndiff --git a/src/server/game/Scripting/ScriptDefines/DatabaseScript.cpp b/src/server/game/Scripting/ScriptDefines/DatabaseScript.cpp\nindex df84d21564ea97..e2831a9d1a2b04 100644\n--- a/src/server/game/Scripting/ScriptDefines/DatabaseScript.cpp\n+++ b/src/server/game/Scripting/ScriptDefines/DatabaseScript.cpp\n@@ -19,6 +19,21 @@\n #include \"ScriptMgr.h\"\n #include \"ScriptMgrMacros.h\"\n\n+bool ScriptMgr::OnDatabasesLoading()\n+{\n+    auto ret = IsValidBoolScript&lt;DatabaseScript&gt;([&amp;](DatabaseScript* script)\n+    {\n+        return !script-&gt;OnDatabasesLoading();\n+    });\n+\n+    if (ret &amp;&amp; *ret)\n+    {\n+        return false;\n+    }\n+\n+    return true;\n+}\n+\n void ScriptMgr::OnAfterDatabasesLoaded(uint32 updateFlags)\n {\n     CALL_ENABLED_HOOKS(DatabaseScript, DATABASEHOOK_ON_AFTER_DATABASES_LOADED, script-&gt;OnAfterDatabasesLoaded(updateFlags));\n@@ -29,6 +44,46 @@ void ScriptMgr::OnAfterDatabaseLoadCreatureTemplates(std::vector&lt;CreatureTemplat\n     CALL_ENABLED_HOOKS(DatabaseScript, DATABASEHOOK_ON_AFTER_DATABASE_LOAD_CREATURETEMPLATES, script-&gt;OnAfterDatabaseLoadCreatureTemplates(creatureTemplates));\n }\n\n+void ScriptMgr::OnDatabasesKeepAlive()\n+{\n+    ExecuteScript&lt;DatabaseScript&gt;([&amp;](DatabaseScript* script)\n+    {\n+        script-&gt;OnDatabasesKeepAlive();\n+    });\n+}\n+\n+void ScriptMgr::OnDatabasesClosing()\n+{\n+    ExecuteScript&lt;DatabaseScript&gt;([&amp;](DatabaseScript* script)\n+    {\n+        script-&gt;OnDatabasesClosing();\n+    });\n+}\n+\n+void ScriptMgr::OnDatabaseWarnAboutSyncQueries(bool apply)\n+{\n+    ExecuteScript&lt;DatabaseScript&gt;([&amp;](DatabaseScript* script)\n+    {\n+        script-&gt;OnDatabaseWarnAboutSyncQueries(apply);\n+    });\n+}\n+\n+void ScriptMgr::OnDatabaseSelectIndexLogout(Player* player, uint32&amp; statementIndex, uint32&amp; statementParam)\n+{\n+    ExecuteScript&lt;DatabaseScript&gt;([&amp;](DatabaseScript* script)\n+    {\n+        script-&gt;OnDatabaseSelectIndexLogout(player, statementIndex, statementParam);\n+    });\n+}\n+\n+void ScriptMgr::OnDatabaseGetDBRevision(std::string&amp; revision)\n+{\n+    ExecuteScript&lt;DatabaseScript&gt;([&amp;](DatabaseScript* script)\n+    {\n+        script-&gt;OnDatabaseGetDBRevision(revision);\n+    });\n+}\n+\n DatabaseScript::DatabaseScript(const char* name, std::vector&lt;uint16&gt; enabledHooks)\n     : ScriptObject(name, DATABASEHOOK_END)\n {\ndiff --git a/src/server/game/Scripting/ScriptDefines/DatabaseScript.h b/src/server/game/Scripting/ScriptDefines/DatabaseScript.h\nindex 708f0a986417f5..21b55ee8b4bc80 100644\n--- a/src/server/game/Scripting/ScriptDefines/DatabaseScript.h\n+++ b/src/server/game/Scripting/ScriptDefines/DatabaseScript.h\n@@ -52,6 +52,13 @@ class DatabaseScript : public ScriptObject\n      */\n     virtual void OnAfterDatabaseLoadCreatureTemplates(std::vector&lt;CreatureTemplate*&gt; /*creatureTemplates*/) { }\n\n+    [[nodiscard]] virtual bool OnDatabasesLoading() { return true; }\n+    virtual void OnDatabasesKeepAlive() { }\n+    virtual void OnDatabasesClosing() { }\n+    virtual void OnDatabaseWarnAboutSyncQueries(bool /*apply*/) { }\n+    virtual void OnDatabaseSelectIndexLogout(Player* /*player*/, uint32&amp; /*statementIndex*/, uint32&amp; /*statementParam*/) { }\n+    virtual void OnDatabaseGetDBRevision(std::string&amp; /*revision*/) { }\n+\n };\n\n #endif\ndiff --git a/src/server/game/Scripting/ScriptDefines/PlayerScript.cpp b/src/server/game/Scripting/ScriptDefines/PlayerScript.cpp\nindex 62439d2840ac51..c2afb5804171d3 100644\n--- a/src/server/game/Scripting/ScriptDefines/PlayerScript.cpp\n+++ b/src/server/game/Scripting/ScriptDefines/PlayerScript.cpp\n@@ -194,11 +194,17 @@ void ScriptMgr::OnPlayerBeforeUpdate(Player* player, uint32 p_time)\n     CALL_ENABLED_HOOKS(PlayerScript, PLAYERHOOK_ON_BEFORE_UPDATE, script-&gt;OnPlayerBeforeUpdate(player, p_time));\n }\n\n+void ScriptMgr::OnPlayerAfterUpdate(Player* player, uint32 p_time)\n+{\n+    CALL_ENABLED_HOOKS(PlayerScript, PLAYERHOOK_ON_AFTER_UPDATE, script-&gt;OnPlayerAfterUpdate(player, p_time));\n+}\n+\n void ScriptMgr::OnPlayerUpdate(Player* player, uint32 p_time)\n {\n     CALL_ENABLED_HOOKS(PlayerScript, PLAYERHOOK_ON_UPDATE, script-&gt;OnPlayerUpdate(player, p_time));\n }\n\n+\n void ScriptMgr::OnPlayerLogin(Player* player)\n {\n     CALL_ENABLED_HOOKS(PlayerScript, PLAYERHOOK_ON_LOGIN, script-&gt;OnPlayerLogin(player));\ndiff --git a/src/server/game/Scripting/ScriptDefines/PlayerScript.h b/src/server/game/Scripting/ScriptDefines/PlayerScript.h\nindex 5ee56e7ac62450..8177dea2cb05af 100644\n--- a/src/server/game/Scripting/ScriptDefines/PlayerScript.h\n+++ b/src/server/game/Scripting/ScriptDefines/PlayerScript.h\n@@ -45,6 +45,7 @@ enum PlayerHook\n     PLAYERHOOK_ON_AFTER_SPEC_SLOT_CHANGED,\n     PLAYERHOOK_ON_BEFORE_UPDATE,\n     PLAYERHOOK_ON_UPDATE,\n+    PLAYERHOOK_ON_AFTER_UPDATE,\n     PLAYERHOOK_ON_MONEY_CHANGED,\n     PLAYERHOOK_ON_BEFORE_LOOT_MONEY,\n     PLAYERHOOK_ON_GIVE_EXP,\n@@ -55,7 +56,12 @@ enum PlayerHook\n     PLAYERHOOK_ON_DUEL_REQUEST,\n     PLAYERHOOK_ON_DUEL_START,\n     PLAYERHOOK_ON_DUEL_END,\n+    PLAYERHOOK_ON_CHAT,\n     PLAYERHOOK_ON_BEFORE_SEND_CHAT_MESSAGE,\n+    PLAYERHOOK_ON_CHAT_WITH_RECEIVER,\n+    PLAYERHOOK_ON_CHAT_WITH_GROUP,\n+    PLAYERHOOK_ON_CHAT_WITH_GUILD,\n+    PLAYERHOOK_ON_CHAT_WITH_CHANNEL,\n     PLAYERHOOK_ON_EMOTE,\n     PLAYERHOOK_ON_TEXT_EMOTE,\n     PLAYERHOOK_ON_SPELL_CAST,\n@@ -263,6 +269,7 @@ class PlayerScript : public ScriptObject\n\n     // Called for player::update\n     virtual void OnPlayerBeforeUpdate(Player* /*player*/, uint32 /*p_time*/) { }\n+    virtual void OnPlayerAfterUpdate(Player* /*player*/, uint32 /*p_time*/) { }\n     virtual void OnPlayerUpdate(Player* /*player*/, uint32 /*p_time*/) { }\n\n     // Called when a player's money is modified (before the modification is done)\ndiff --git a/src/server/game/Scripting/ScriptDefines/PlayerbotsScript.cpp b/src/server/game/Scripting/ScriptDefines/PlayerbotsScript.cpp\nnew file mode 100644\nindex 00000000000000..22379a1fba02b5\n--- /dev/null\n+++ b/src/server/game/Scripting/ScriptDefines/PlayerbotsScript.cpp\n@@ -0,0 +1,105 @@\n+/*\n+ * This file is part of the AzerothCore Project. See AUTHORS file for Copyright information\n+ *\n+ * This program is free software; you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation; either version 2 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n+ * more details.\n+ *\n+ * You should have received a copy of the GNU General Public License along\n+ * with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.\n+ */\n+\n+#include \"ScriptMgr.h\"\n+#include \"ScriptMgrMacros.h\"\n+\n+bool ScriptMgr::OnPlayerbotCheckLFGQueue(lfg::Lfg5Guids const&amp; guidsList)\n+{\n+    auto ret = IsValidBoolScript&lt;PlayerbotScript&gt;([&amp;](PlayerbotScript* script)\n+    {\n+        return !script-&gt;OnPlayerbotCheckLFGQueue(guidsList);\n+    });\n+\n+    if (ret &amp;&amp; *ret)\n+    {\n+        return false;\n+    }\n+\n+    return true;\n+}\n+\n+void ScriptMgr::OnPlayerbotCheckKillTask(Player* player, Unit* victim)\n+{\n+    ExecuteScript&lt;PlayerbotScript&gt;([&amp;](PlayerbotScript* script)\n+    {\n+        script-&gt;OnPlayerbotCheckKillTask(player, victim);\n+    });\n+}\n+\n+void ScriptMgr::OnPlayerbotCheckPetitionAccount(Player* player, bool&amp; found)\n+{\n+    ExecuteScript&lt;PlayerbotScript&gt;([&amp;](PlayerbotScript* script)\n+    {\n+        script-&gt;OnPlayerbotCheckPetitionAccount(player, found);\n+    });\n+}\n+\n+bool ScriptMgr::OnPlayerbotCheckUpdatesToSend(Player* player)\n+{\n+    auto ret = IsValidBoolScript&lt;PlayerbotScript&gt;([&amp;](PlayerbotScript* script)\n+    {\n+        return !script-&gt;OnPlayerbotCheckUpdatesToSend(player);\n+    });\n+\n+    if (ret &amp;&amp; *ret)\n+    {\n+        return false;\n+    }\n+\n+    return true;\n+}\n+\n+void ScriptMgr::OnPlayerbotPacketSent(Player* player, WorldPacket const* packet)\n+{\n+    ExecuteScript&lt;PlayerbotScript&gt;([&amp;](PlayerbotScript* script)\n+    {\n+        script-&gt;OnPlayerbotPacketSent(player, packet);\n+    });\n+}\n+\n+void ScriptMgr::OnPlayerbotUpdate(uint32 diff)\n+{\n+    ExecuteScript&lt;PlayerbotScript&gt;([&amp;](PlayerbotScript* script)\n+    {\n+        script-&gt;OnPlayerbotUpdate(diff);\n+    });\n+}\n+\n+void ScriptMgr::OnPlayerbotUpdateSessions(Player* player)\n+{\n+    ExecuteScript&lt;PlayerbotScript&gt;([&amp;](PlayerbotScript* script)\n+    {\n+        script-&gt;OnPlayerbotUpdateSessions(player);\n+    });\n+}\n+\n+void ScriptMgr::OnPlayerbotLogout(Player* player)\n+{\n+    ExecuteScript&lt;PlayerbotScript&gt;([&amp;](PlayerbotScript* script)\n+    {\n+        script-&gt;OnPlayerbotLogout(player);\n+    });\n+}\n+\n+void ScriptMgr::OnPlayerbotLogoutBots()\n+{\n+    ExecuteScript&lt;PlayerbotScript&gt;([&amp;](PlayerbotScript* script)\n+    {\n+        script-&gt;OnPlayerbotLogoutBots();\n+    });\n+}\ndiff --git a/src/server/game/Scripting/ScriptDefines/ServerScript.cpp b/src/server/game/Scripting/ScriptDefines/ServerScript.cpp\nindex 74d49c5552b405..7c531081c60efa 100644\n--- a/src/server/game/Scripting/ScriptDefines/ServerScript.cpp\n+++ b/src/server/game/Scripting/ScriptDefines/ServerScript.cpp\n@@ -43,6 +43,15 @@ void ScriptMgr::OnSocketClose(std::shared_ptr&lt;WorldSocket&gt; const&amp; socket)\n     CALL_ENABLED_HOOKS(ServerScript, SERVERHOOK_ON_SOCKET_CLOSE, script-&gt;OnSocketClose(socket));\n }\n\n+void ScriptMgr::OnPacketReceived(WorldSession* session, WorldPacket const&amp; packet)\n+{\n+    WorldPacket copy(packet);\n+    ExecuteScript&lt;ServerScript&gt;([&amp;](ServerScript* script)\n+    {\n+        script-&gt;OnPacketReceived(session, copy);\n+    });\n+}\n+\n bool ScriptMgr::CanPacketSend(WorldSession* session, WorldPacket const&amp; packet)\n {\n     ASSERT(session);\ndiff --git a/src/server/game/Scripting/ScriptDefines/ServerScript.h b/src/server/game/Scripting/ScriptDefines/ServerScript.h\nindex 5125f231705e5f..ed5fd07cd24f8c 100644\n--- a/src/server/game/Scripting/ScriptDefines/ServerScript.h\n+++ b/src/server/game/Scripting/ScriptDefines/ServerScript.h\n@@ -70,6 +70,8 @@ class ServerScript : public ScriptObject\n      * @return True if you want to continue receive the packet, false if you want to disallow receive the packet\n      */\n     [[nodiscard]] virtual bool CanPacketReceive(WorldSession* /*session*/, WorldPacket&amp; /*packet*/) { return true; }\n+\n+    virtual void OnPacketReceived(WorldSession* /*session*/, WorldPacket const&amp; /*packet*/) { }\n };\n\n #endif\ndiff --git a/src/server/game/Scripting/ScriptMgr.cpp b/src/server/game/Scripting/ScriptMgr.cpp\nindex 34ad17546d7a4f..0d99f7fd05a246 100644\n--- a/src/server/game/Scripting/ScriptMgr.cpp\n+++ b/src/server/game/Scripting/ScriptMgr.cpp\n@@ -58,6 +58,11 @@ ScriptMgr* ScriptMgr::instance()\n     return &amp;instance;\n }\n\n+PlayerbotScript::PlayerbotScript(const char* name) : ScriptObject(name)\n+{\n+    ScriptRegistry&lt;PlayerbotScript&gt;::AddScript(this);\n+}\n+\n void ScriptMgr::Initialize()\n {\n     LOG_INFO(\"server.loading\", \"&gt; Loading C++ scripts\");\n@@ -143,6 +148,7 @@ void ScriptMgr::Unload()\n     SCR_CLEAR&lt;OutdoorPvPScript&gt;();\n     SCR_CLEAR&lt;PetScript&gt;();\n     SCR_CLEAR&lt;PlayerScript&gt;();\n+    SCR_CLEAR&lt;PlayerbotScript&gt;();\n     SCR_CLEAR&lt;ServerScript&gt;();\n     SCR_CLEAR&lt;SpellSC&gt;();\n     SCR_CLEAR&lt;SpellScriptLoader&gt;();\n@@ -227,6 +233,7 @@ void ScriptMgr::CheckIfScriptsInDatabaseExist()\n                 !ScriptRegistry&lt;ArenaScript&gt;::GetScriptById(sid) &amp;&amp;\n                 !ScriptRegistry&lt;GroupScript&gt;::GetScriptById(sid) &amp;&amp;\n                 !ScriptRegistry&lt;DatabaseScript&gt;::GetScriptById(sid) &amp;&amp;\n+                !ScriptRegistry&lt;PlayerbotScript&gt;::GetScriptById(sid) &amp;&amp;\n                 !ScriptRegistry&lt;TicketScript&gt;::GetScriptById(sid))\n                 {\n                     LOG_ERROR(\"sql.sql\", \"Script named '{}' is assigned in the database, but has no code!\", scriptName);\ndiff --git a/src/server/game/Scripting/ScriptMgr.h b/src/server/game/Scripting/ScriptMgr.h\nindex 056a44a576ed61..4e839a465f0793 100644\n--- a/src/server/game/Scripting/ScriptMgr.h\n+++ b/src/server/game/Scripting/ScriptMgr.h\n@@ -105,7 +105,26 @@ namespace Acore::ChatCommands\n\n */\n\n-// Manages registration, loading, and execution of scripts.\n+class PlayerbotScript : public ScriptObject\n+{\n+protected:\n+\n+    PlayerbotScript(const char* name);\n+\n+public:\n+    bool IsDatabaseBound() const { return false; }\n+\n+    [[nodiscard]] virtual bool OnPlayerbotCheckLFGQueue(lfg::Lfg5Guids const&amp; /*guidsList*/) { return true; }\n+    virtual void OnPlayerbotCheckKillTask(Player* /*player*/, Unit* /*victim*/) { }\n+    virtual void OnPlayerbotCheckPetitionAccount(Player* /*player*/, bool&amp; /*found*/) { }\n+    [[nodiscard]] virtual bool OnPlayerbotCheckUpdatesToSend(Player* /*player*/) { return true; }\n+    virtual void OnPlayerbotPacketSent(Player* /*player*/, WorldPacket const* /*packet*/) { }\n+    virtual void OnPlayerbotUpdate(uint32 /*diff*/) { }\n+    virtual void OnPlayerbotUpdateSessions(Player* /*player*/) { }\n+    virtual void OnPlayerbotLogout(Player* /*player*/) { }\n+    virtual void OnPlayerbotLogoutBots() { }\n+};\n+\n class ScriptMgr\n {\n     friend class ScriptObject;\n@@ -158,6 +177,7 @@ class ScriptMgr\n     void OnSocketOpen(std::shared_ptr&lt;WorldSocket&gt; const&amp; socket);\n     void OnSocketClose(std::shared_ptr&lt;WorldSocket&gt; const&amp; socket);\n     bool CanPacketReceive(WorldSession* session, WorldPacket const&amp; packet);\n+    void OnPacketReceived(WorldSession* session, WorldPacket const&amp; packet);\n     bool CanPacketSend(WorldSession* session, WorldPacket const&amp; packet);\n\n public: /* WorldScript */\n@@ -298,6 +318,7 @@ class ScriptMgr\n     void OnPlayerReleasedGhost(Player* player);\n     void OnPlayerSendInitialPacketsBeforeAddToMap(Player* player, WorldPacket&amp; data);\n     void OnPlayerBeforeUpdate(Player* player, uint32 p_time);\n+    void OnPlayerAfterUpdate(Player* player, uint32 diff);\n     void OnPlayerUpdate(Player* player, uint32 p_time);\n     void OnPlayerPVPKill(Player* killer, Player* killed);\n     void OnPlayerPVPFlagChange(Player* player, bool state);\n@@ -679,8 +700,14 @@ class ScriptMgr\n\n public: /* DatabaseScript */\n\n+    bool OnDatabasesLoading();\n     void OnAfterDatabasesLoaded(uint32 updateFlags);\n     void OnAfterDatabaseLoadCreatureTemplates(std::vector&lt;CreatureTemplate*&gt; creatureTemplateStore);\n+    void OnDatabasesKeepAlive();\n+    void OnDatabasesClosing();\n+    void OnDatabaseWarnAboutSyncQueries(bool apply);\n+    void OnDatabaseSelectIndexLogout(Player* player, uint32&amp; statementIndex, uint32&amp; statementParam);\n+    void OnDatabaseGetDBRevision(std::string&amp; revision);\n\n public: /* WorldObjectScript */\n\n@@ -698,6 +725,18 @@ class ScriptMgr\n\n     void OnLootMoney(Player* player, uint32 gold);\n\n+public: /* PlayerbotScript */\n+    \n+    bool OnPlayerbotCheckLFGQueue(lfg::Lfg5Guids const&amp; guidsList);\n+    void OnPlayerbotCheckKillTask(Player* player, Unit* victim);\n+    void OnPlayerbotCheckPetitionAccount(Player* player, bool&amp; found);\n+    bool OnPlayerbotCheckUpdatesToSend(Player* player);\n+    void OnPlayerbotPacketSent(Player* player, WorldPacket const* packet);\n+    void OnPlayerbotUpdate(uint32 diff);\n+    void OnPlayerbotUpdateSessions(Player* player);\n+    void OnPlayerbotLogout(Player* player);\n+    void OnPlayerbotLogoutBots();\n+\n public: /* TicketScript */\n\n     void OnTicketCreate(GmTicket* ticket);\ndiff --git a/src/server/game/Server/WorldSession.cpp b/src/server/game/Server/WorldSession.cpp\nindex 254328b80910fc..8a212f54669986 100644\n--- a/src/server/game/Server/WorldSession.cpp\n+++ b/src/server/game/Server/WorldSession.cpp\n@@ -105,7 +105,7 @@ bool WorldSessionFilter::Process(WorldPacket* packet)\n\n /// WorldSession constructor\n WorldSession::WorldSession(uint32 id, std::string&amp;&amp; name, uint32 accountFlags, std::shared_ptr&lt;WorldSocket&gt; sock, AccountTypes sec, uint8 expansion,\n-    time_t mute_time, LocaleConstant locale, uint32 recruiter, bool isARecruiter, bool skipQueue, uint32 TotalTime) :\n+    time_t mute_time, LocaleConstant locale, uint32 recruiter, bool isARecruiter, bool skipQueue, uint32 TotalTime, bool isBot) :\n     m_muteTime(mute_time),\n     m_timeOutTime(0),\n     AntiDOS(this),\n@@ -137,7 +137,8 @@ WorldSession::WorldSession(uint32 id, std::string&amp;&amp; name, uint32 accountFlags, s\n     _timeSyncClockDeltaQueue(6),\n     _timeSyncClockDelta(0),\n     _pendingTimeSyncRequests(),\n-    _orderCounter(0)\n+    _orderCounter(0),\n+    _isBot(isBot)\n {\n     memset(m_Tutorials, 0, sizeof(m_Tutorials));\n\n@@ -153,6 +154,10 @@ WorldSession::WorldSession(uint32 id, std::string&amp;&amp; name, uint32 accountFlags, s\n         ResetTimeOutTime(false);\n         LoginDatabase.Execute(\"UPDATE account SET online = 1 WHERE id = {};\", GetAccountId()); // One-time query\n     }\n+    else if (isBot)\n+    {\n+        m_Address = \"bot\";\n+    }\n }\n\n /// WorldSession destructor\n@@ -251,6 +256,14 @@ ObjectGuid::LowType WorldSession::GetGuidLow() const\n /// Send a packet to the client\n void WorldSession::SendPacket(WorldPacket const* packet)\n {\n+    if (packet-&gt;GetOpcode() == NULL_OPCODE)\n+    {\n+        LOG_ERROR(\"network.opcode\", \"{} send NULL_OPCODE\", GetPlayerInfo());\n+        return;\n+    }\n+\n+    sScriptMgr-&gt;OnPlayerbotPacketSent(GetPlayer(), packet);\n+\n     if (!m_Socket)\n         return;\n\n@@ -401,6 +414,9 @@ bool WorldSession::Update(uint32 diff, PacketFilter&amp; updater)\n\n                         opHandle-&gt;Call(this, *packet);\n                         LogUnprocessedTail(packet);\n+#ifdef MOD_PLAYERBOTS\n+                        sScriptMgr-&gt;OnPacketReceived(this, *packet);\n+#endif\n                     }\n\n                     // lag can cause STATUS_LOGGEDIN opcodes to arrive after the player started a transfer\n@@ -419,6 +435,9 @@ bool WorldSession::Update(uint32 diff, PacketFilter&amp; updater)\n\n                         opHandle-&gt;Call(this, *packet);\n                         LogUnprocessedTail(packet);\n+#ifdef MOD_PLAYERBOTS\n+                        sScriptMgr-&gt;OnPacketReceived(this, *packet);\n+#endif\n                     }\n                     break;\n                 case STATUS_TRANSFER:\n@@ -429,6 +448,9 @@ bool WorldSession::Update(uint32 diff, PacketFilter&amp; updater)\n\n                         opHandle-&gt;Call(this, *packet);\n                         LogUnprocessedTail(packet);\n+#ifdef MOD_PLAYERBOTS\n+                        sScriptMgr-&gt;OnPacketReceived(this, *packet);\n+#endif\n                     }\n                     break;\n                 case STATUS_AUTHED:\n@@ -445,6 +467,9 @@ bool WorldSession::Update(uint32 diff, PacketFilter&amp; updater)\n\n                     opHandle-&gt;Call(this, *packet);\n                     LogUnprocessedTail(packet);\n+#ifdef MOD_PLAYERBOTS\n+                    sScriptMgr-&gt;OnPacketReceived(this, *packet);\n+#endif\n                     break;\n                 case STATUS_NEVER:\n                     LOG_ERROR(\"network.opcode\", \"Received not allowed opcode {} from {}\",\n@@ -533,6 +558,8 @@ bool WorldSession::Update(uint32 diff, PacketFilter&amp; updater)\n     //logout procedure should happen only in World::UpdateSessions() method!!!\n     if (updater.ProcessUnsafe())\n     {\n+        sScriptMgr-&gt;OnPlayerbotUpdateSessions(GetPlayer());\n+\n         if (m_Socket &amp;&amp; m_Socket-&gt;IsOpen() &amp;&amp; _warden)\n         {\n             _warden-&gt;Update(diff);\n@@ -625,6 +652,8 @@ void WorldSession::LogoutPlayer(bool save)\n         if (ObjectGuid lguid = _player-&gt;GetLootGUID())\n             DoLootRelease(lguid);\n\n+        sScriptMgr-&gt;OnPlayerbotLogout(_player);\n+\n         ///- If the player just died before logging out, make him appear as a ghost\n         //FIXME: logout must be delayed in case lost connection with client in time of combat\n         if (_player-&gt;GetDeathTimer())\n@@ -757,6 +786,10 @@ void WorldSession::LogoutPlayer(bool save)\n         LOG_INFO(\"entities.player\", \"Account: {} (IP: {}) Logout Character:[{}] ({}) Level: {}\",\n             GetAccountId(), GetRemoteAddress(), _player-&gt;GetName(), _player-&gt;GetGUID().ToString(), _player-&gt;GetLevel());\n\n+        uint32 statementIndex = CHAR_UPD_ACCOUNT_ONLINE;\n+        uint32 statementParam = GetAccountId();\n+        sScriptMgr-&gt;OnDatabaseSelectIndexLogout(_player, statementIndex, statementParam);\n+\n         //! Remove the player from the world\n         // the player may not be in the world when logging out\n         // e.g if he got disconnected during a transfer to another map\n@@ -776,8 +809,8 @@ void WorldSession::LogoutPlayer(bool save)\n         LOG_DEBUG(\"network\", \"SESSION: Sent SMSG_LOGOUT_COMPLETE Message\");\n\n         //! Since each account can only have one online character at any given time, ensure all characters for active account are marked as offline\n-        CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CHAR_UPD_ACCOUNT_ONLINE);\n-        stmt-&gt;SetData(0, GetAccountId());\n+        CharacterDatabasePreparedStatement* stmt = CharacterDatabase.GetPreparedStatement(CharacterDatabaseStatements(statementIndex));\n+        stmt-&gt;SetData(0, statementParam);\n         CharacterDatabase.Execute(stmt);\n     }\n\n@@ -1516,3 +1549,8 @@ void WorldSession::SetPacketLogging(bool state)\n     if (m_Socket)\n         m_Socket-&gt;SetPacketLogging(state);\n }\n+\n+LockedQueue&lt;WorldPacket*&gt;&amp; WorldSession::GetPacketQueue()\n+{\n+    return _recvQueue;\n+}\ndiff --git a/src/server/game/Server/WorldSession.h b/src/server/game/Server/WorldSession.h\nindex 6a1c554ca2fe96..283a301b2ce4af 100644\n--- a/src/server/game/Server/WorldSession.h\n+++ b/src/server/game/Server/WorldSession.h\n@@ -29,6 +29,7 @@\n #include \"Common.h\"\n #include \"DatabaseEnv.h\"\n #include \"GossipDef.h\"\n+#include \"QueryHolder.h\"\n #include \"Packet.h\"\n #include \"SharedDefines.h\"\n #include \"World.h\"\n@@ -40,7 +41,6 @@ class Creature;\n class GameObject;\n class InstanceSave;\n class Item;\n-class LoginQueryHolder;\n class LoadPetFromDBQueryHolder;\n class Object;\n class Pet;\n@@ -270,6 +270,20 @@ enum CharterTypes\n     ARENA_TEAM_CHARTER_5v5_TYPE                   = 5\n };\n\n+class LoginQueryHolder : public CharacterDatabaseQueryHolder\n+{\n+    private:\n+        uint32 m_accountId;\n+        ObjectGuid m_guid;\n+\n+    public:\n+        LoginQueryHolder(uint32 accountId, ObjectGuid guid);\n+\n+        ObjectGuid GetGuid() const { return m_guid; }\n+        uint32 GetAccountId() const { return m_accountId; }\n+        bool Initialize();\n+};\n+\n //class to deal with packet processing\n //allows to determine if next packet is safe to be processed\n class PacketFilter\n@@ -314,6 +328,11 @@ class CharacterCreateInfo\n     friend class WorldSession;\n     friend class Player;\n\n+public:\n+    CharacterCreateInfo(std::string const name = \"\", uint8 _race = 0, uint8 _class = 0, uint8 gender = 0, uint8 skin = 0, uint8 face = 0,\n+        uint8 hairStyle = 0, uint8 hairColor = 0, uint8 facialHair = 0)\n+        : Name(name), Race(_race), Class(_class), Gender(gender), Skin(skin), Face(face), HairStyle(hairStyle), HairColor(hairColor), FacialHair(facialHair) { }\n+\n protected:\n     /// User specified variables\n     std::string Name;\n@@ -374,7 +393,7 @@ struct PacketCounter\n class WorldSession\n {\n public:\n-    WorldSession(uint32 id, std::string&amp;&amp; name, uint32 accountFlags, std::shared_ptr&lt;WorldSocket&gt; sock, AccountTypes sec, uint8 expansion, time_t mute_time, LocaleConstant locale, uint32 recruiter, bool isARecruiter, bool skipQueue, uint32 TotalTime);\n+    WorldSession(uint32 id, std::string&amp;&amp; name, uint32 accountFlags, std::shared_ptr&lt;WorldSocket&gt; sock, AccountTypes sec, uint8 expansion, time_t mute_time, LocaleConstant locale, uint32 recruiter, bool isARecruiter, bool skipQueue, uint32 TotalTime, bool is_bot = false);\n     ~WorldSession();\n\n     uint32 GetAccountFlags() const { return _accountFlags; }\n@@ -1132,6 +1151,8 @@ class WorldSession\n     void SetKicked(bool val) { _kicked = val; }\n     bool IsSocketClosed() const;\n\n+    void SetAddress(std::string const&amp; address) { m_Address = address; }\n+\n     /*\n      * CALLBACKS\n      */\n@@ -1145,6 +1166,13 @@ class WorldSession\n\n     void SetPacketLogging(bool state);\n\n+    LockedQueue&lt;WorldPacket*&gt;&amp; GetPacketQueue();\n+\n+    [[nodiscard]] bool IsBot() const\n+    {\n+        return _isBot;\n+    }\n+\n private:\n     void ProcessQueryCallbacks();\n\n@@ -1257,6 +1285,8 @@ class WorldSession\n\n     uint32 _orderCounter;\n\n+    bool _isBot;\n+\n     WorldSession(WorldSession const&amp; right) = delete;\n     WorldSession&amp; operator=(WorldSession const&amp; right) = delete;\n };\ndiff --git a/src/server/game/Server/WorldSessionMgr.cpp b/src/server/game/Server/WorldSessionMgr.cpp\nindex b430996692a3b2..91256db9b92ca7 100644\n--- a/src/server/game/Server/WorldSessionMgr.cpp\n+++ b/src/server/game/Server/WorldSessionMgr.cpp\n@@ -20,6 +20,7 @@\n #include \"GameTime.h\"\n #include \"Metric.h\"\n #include \"Player.h\"\n+#include \"ScriptMgr.h\"\n #include \"World.h\"\n #include \"WorldSession.h\"\n #include \"WorldSessionMgr.h\"\n@@ -190,6 +191,10 @@ void WorldSessionMgr::KickAll()\n     // pussywizard: kick offline sessions\n     for (SessionMap::const_iterator itr = _offlineSessions.begin(); itr != _offlineSessions.end(); ++itr)\n         itr-&gt;second-&gt;KickPlayer(\"KickAll offline sessions\");\n+\n+#ifdef MOD_PLAYERBOTS\n+    sScriptMgr-&gt;OnPlayerbotLogoutBots();\n+#endif\n }\n\n /// Kick (and save) all players with security level less `sec`\ndiff --git a/src/server/game/World/IWorld.h b/src/server/game/World/IWorld.h\nindex 03e70e55c1ed38..dc6c60681ba976 100644\n--- a/src/server/game/World/IWorld.h\n+++ b/src/server/game/World/IWorld.h\n@@ -22,6 +22,7 @@\n #include \"Common.h\"\n #include \"Duration.h\"\n #include \"ObjectGuid.h\"\n+#include \"QueryHolder.h\"\n #include \"SharedDefines.h\"\n #include \"WorldConfig.h\"\n #include &lt;unordered_map&gt;\n@@ -104,12 +105,16 @@ class IWorld\n     [[nodiscard]] virtual LocaleConstant GetAvailableDbcLocale(LocaleConstant locale) const = 0;\n     virtual void LoadDBVersion() = 0;\n     [[nodiscard]] virtual char const* GetDBVersion() const = 0;\n+#ifdef MOD_PLAYERBOTS\n+    [[nodiscard]] virtual char const* GetPlayerbotsDBRevision() const = 0;\n+#endif\n     virtual void UpdateAreaDependentAuras() = 0;\n     [[nodiscard]] virtual uint32 GetCleaningFlags() const = 0;\n     virtual void   SetCleaningFlags(uint32 flags) = 0;\n     virtual void   ResetEventSeasonalQuests(uint16 event_id) = 0;\n     [[nodiscard]] virtual std::string const&amp; GetRealmName() const = 0;\n     virtual void SetRealmName(std::string name) = 0;\n+    virtual SQLQueryHolderCallback&amp; AddQueryHolderCallback(SQLQueryHolderCallback&amp;&amp; callback) = 0;\n };\n\n #endif //AZEROTHCORE_IWORLD_H\ndiff --git a/src/server/game/World/World.cpp b/src/server/game/World/World.cpp\nindex e1de134a213c80..d072bd56f7c968 100644\n--- a/src/server/game/World/World.cpp\n+++ b/src/server/game/World/World.cpp\n@@ -67,6 +67,7 @@\n #include \"ObjectMgr.h\"\n #include \"Opcodes.h\"\n #include \"OutdoorPvPMgr.h\"\n+#include \"QueryHolder.h\"\n #include \"PetitionMgr.h\"\n #include \"Player.h\"\n #include \"PlayerDump.h\"\n@@ -1171,6 +1172,8 @@ void World::Update(uint32 diff)\n         ResetGuildCap();\n     }\n\n+    sScriptMgr-&gt;OnPlayerbotUpdate(diff);\n+\n     {\n         // pussywizard: handle expired auctions, auctions expired when realm was offline are also handled here (not during loading when many required things aren't loaded yet)\n         METRIC_TIMER(\"world_update_time\", METRIC_TAG(\"type\", \"Update expired auctions\"));\n@@ -1290,6 +1293,7 @@ void World::Update(uint32 diff)\n         CharacterDatabase.KeepAlive();\n         LoginDatabase.KeepAlive();\n         WorldDatabase.KeepAlive();\n+        sScriptMgr-&gt;OnDatabasesKeepAlive();\n     }\n\n     {\n@@ -1456,6 +1460,7 @@ void World::_UpdateGameTime()\n void World::ShutdownServ(uint32 time, uint32 options, uint8 exitcode, std::string const&amp; reason)\n {\n     // ignore if server shutdown at next tick\n+\n     if (IsStopped())\n         return;\n\n@@ -1803,6 +1808,12 @@ void World::UpdateAreaDependentAuras()\n void World::ProcessQueryCallbacks()\n {\n     _queryProcessor.ProcessReadyCallbacks();\n+    _queryHolderProcessor.ProcessReadyCallbacks();\n+}\n+\n+SQLQueryHolderCallback&amp; World::AddQueryHolderCallback(SQLQueryHolderCallback&amp;&amp; callback)\n+{\n+    return _queryHolderProcessor.AddCallback(std::move(callback));\n }\n\n bool World::IsPvPRealm() const\ndiff --git a/src/server/game/World/World.h b/src/server/game/World/World.h\nindex 942665b4df7a92..f42004e3019850 100644\n--- a/src/server/game/World/World.h\n+++ b/src/server/game/World/World.h\n@@ -229,6 +229,9 @@ class World: public IWorld\n     // used World DB version\n     void LoadDBVersion() override;\n     [[nodiscard]] char const* GetDBVersion() const override { return _dbVersion.c_str(); }\n+#ifdef MOD_PLAYERBOTS\n+    [[nodiscard]] char const* GetPlayerbotsDBRevision() const override { return m_PlayerbotsDBRevision.c_str(); }\n+#endif\n\n     void UpdateAreaDependentAuras() override;\n\n@@ -256,6 +259,9 @@ class World: public IWorld\n     void ResetRandomBG();\n     void CalendarDeleteOldEvents();\n     void ResetGuildCap();\n+\n+    SQLQueryHolderCallback&amp; AddQueryHolderCallback(SQLQueryHolderCallback&amp;&amp; callback) override;\n+\n private:\n     WorldConfig _worldConfig;\n\n@@ -300,9 +306,13 @@ class World: public IWorld\n     // used versions\n     std::string _dbVersion;\n     uint32 _dbClientCacheVersion;\n+#ifdef MOD_PLAYERBOTS\n+    std::string m_PlayerbotsDBRevision;\n+#endif\n\n     void ProcessQueryCallbacks();\n     QueryCallbackProcessor _queryProcessor;\n+    AsyncCallbackProcessor&lt;SQLQueryHolderCallback&gt; _queryHolderProcessor;\n\n     /**\n      * @brief Executed when a World Session is being finalized. Be it from a normal login or via queue popping.\ndiff --git a/src/server/scripts/Commands/cs_server.cpp b/src/server/scripts/Commands/cs_server.cpp\nindex 98bfbbac3dd0ed..63815aeec14b18 100644\n--- a/src/server/scripts/Commands/cs_server.cpp\n+++ b/src/server/scripts/Commands/cs_server.cpp\n@@ -213,6 +213,10 @@ class server_commandscript : public CommandScript\n         handler-&gt;PSendSysMessage(\"Default DBC locale: {}.\\nAll available DBC locales: {}\", localeNames[defaultLocale], availableLocales);\n\n         handler-&gt;PSendSysMessage(\"Using World DB: {}\", sWorld-&gt;GetDBVersion());\n+#ifdef MOD_PLAYERBOTS\n+        handler-&gt;PSendSysMessage(\"Using Playerbots DB Revision: {}\", sWorld-&gt;GetPlayerbotsDBRevision());\n+#endif\n+        \n\n         std::string lldb = \"No updates found!\";\n         if (QueryResult resL = LoginDatabase.Query(\"SELECT name FROM updates ORDER BY name DESC LIMIT 1\"))\n@@ -240,6 +244,10 @@ class server_commandscript : public CommandScript\n         handler-&gt;PSendSysMessage(\"LoginDatabase queue size: {}\", LoginDatabase.QueueSize());\n         handler-&gt;PSendSysMessage(\"CharacterDatabase queue size: {}\", CharacterDatabase.QueueSize());\n         handler-&gt;PSendSysMessage(\"WorldDatabase queue size: {}\", WorldDatabase.QueueSize());\n+#ifdef MOD_PLAYERBOTS\n+        handler-&gt;PSendSysMessage(\"PlayerbotsDatabase queue size: {}\", PlayerbotsDatabase.QueueSize());\n+#endif\n+        \n\n         if (Acore::Module::GetEnableModulesList().empty())\n             handler-&gt;PSendSysMessage(\"No modules are enabled\");\ndiff --git a/src/server/shared/DataStores/DBCDatabaseLoader.cpp b/src/server/shared/DataStores/DBCDatabaseLoader.cpp\nindex 44e65653d1a16a..883fe527f78cc6 100644\n--- a/src/server/shared/DataStores/DBCDatabaseLoader.cpp\n+++ b/src/server/shared/DataStores/DBCDatabaseLoader.cpp\n@@ -29,8 +29,7 @@ DBCDatabaseLoader::DBCDatabaseLoader(char const* tableName, char const* dbcForma\n       _stringPool(stringPool)\n {\n     // Get sql index position\n-    int32 indexPos = -1;\n-    _recordSize = DBCFileLoader::GetFormatRecordSize(_dbcFormat, &amp;indexPos);\n+    _recordSize = DBCFileLoader::GetFormatRecordSize(_dbcFormat, &amp;_sqlIndexPos);\n\n     ASSERT(_recordSize);\n }\n@@ -72,11 +71,11 @@ char* DBCDatabaseLoader::Load(uint32&amp; records, char**&amp; indexTable)\n     {\n         Field* fields = result-&gt;Fetch();\n         uint32 indexValue = fields[_sqlIndexPos].Get&lt;uint32&gt;();\n-        char* dataValue = indexTable[indexValue];\n+        char* oldDataValue = indexTable[indexValue];\n\n         // If exist in DBC file override from DB\n         newIndexes[newRecords] = indexValue;\n-        dataValue = &amp;dataTable[newRecords++ * _recordSize];\n+        char* dataValue = &amp;dataTable[newRecords++ * _recordSize];\n\n         uint32 dataOffset = 0;\n         uint32 sqlColumnNumber = 0;\n@@ -100,7 +99,15 @@ char* DBCDatabaseLoader::Load(uint32&amp; records, char**&amp; indexTable)\n                     dataOffset += sizeof(uint8);\n                     break;\n                 case FT_STRING:\n-                    *reinterpret_cast&lt;char**&gt;(&amp;dataValue[dataOffset]) = CloneStringToPool(fields[sqlColumnNumber].Get&lt;std::string&gt;());\n+                    // not override string if new string is empty\n+                    if (fields[sqlColumnNumber].Get&lt;std::string&gt;().empty() &amp;&amp; oldDataValue)\n+                    {\n+                        *reinterpret_cast&lt;char**&gt;(&amp;dataValue[dataOffset]) = *reinterpret_cast&lt;char**&gt;(&amp;oldDataValue[dataOffset]);\n+                    }\n+                    else\n+                    {\n+                        *reinterpret_cast&lt;char**&gt;(&amp;dataValue[dataOffset]) = CloneStringToPool(fields[sqlColumnNumber].Get&lt;std::string&gt;());\n+                    }\n                     dataOffset += sizeof(char*);\n                     break;\n                 case FT_SORT:\ndiff --git a/src/server/shared/DataStores/DBCStructure.h b/src/server/shared/DataStores/DBCStructure.h\nindex f72d4ead69cb90..06f3bf15375281 100644\n--- a/src/server/shared/DataStores/DBCStructure.h\n+++ b/src/server/shared/DataStores/DBCStructure.h\n@@ -628,6 +628,33 @@ struct CharStartOutfitEntry\n     //int32 ItemInventorySlot[MAX_OUTFIT_ITEMS];            // 53-76 not required at server side\n };\n\n+enum CharSectionFlags\n+{\n+   SECTION_FLAG_PLAYER         = 0x01,\n+   SECTION_FLAG_DEATH_KNIGHT   = 0x04\n+};\n+\n+enum CharSectionType\n+{\n+   SECTION_TYPE_SKIN           = 0,\n+   SECTION_TYPE_FACE           = 1,\n+   SECTION_TYPE_FACIAL_HAIR    = 2,\n+   SECTION_TYPE_HAIR           = 3,\n+   SECTION_TYPE_UNDERWEAR      = 4\n+};\n+\n+struct CharSectionsEntry\n+{\n+   //uint32 Id;\n+   uint32 Race;\n+   uint32 Gender;\n+   uint32 GenType;\n+   //char* TexturePath[3];\n+   uint32 Flags;\n+   uint32 Type;\n+   uint32 Color;\n+};\n+\n struct CharTitlesEntry\n {\n     uint32  ID;                                             // 0, title ids, for example in Quest::GetCharTitleId()\n@@ -903,6 +930,15 @@ struct EmotesTextEntry\n     uint32  textid;\n };\n\n+struct EmotesTextSoundEntry\n+{\n+   uint32 Id;                                              // 0\n+   uint32 EmotesTextId;                                    // 1\n+   uint32 RaceId;                                          // 2\n+   uint32 SexId;                                           // 3, 0 male / 1 female\n+   uint32 SoundId;                                         // 4\n+};\n+\n struct FactionEntry\n {\n     uint32      ID;                                         // 0        m_ID\ndiff --git a/src/server/shared/DataStores/DBCfmt.h b/src/server/shared/DataStores/DBCfmt.h\nindex 9a568d5bb1835d..b87dddb52a623e 100644\n--- a/src/server/shared/DataStores/DBCfmt.h\n+++ b/src/server/shared/DataStores/DBCfmt.h\n@@ -29,6 +29,7 @@ char constexpr BankBagSlotPricesEntryfmt[] = \"ni\";\n char constexpr BarberShopStyleEntryfmt[] = \"nixxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxiii\";\n char constexpr BattlemasterListEntryfmt[] = \"niiiiiiiiixssssssssssssssssxiixx\";\n char constexpr CharStartOutfitEntryfmt[] = \"dbbbXiiiiiiiiiiiiiiiiiiiiiiiixxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\";\n+char constexpr CharSectionsEntryfmt[] = \"diiixxxiii\";\n char constexpr CharTitlesEntryfmt[] = \"nxssssssssssssssssxssssssssssssssssxi\";\n char constexpr ChatChannelsEntryfmt[] = \"nixssssssssssssssssxxxxxxxxxxxxxxxxxx\"; // ChatChannelsEntryfmt, index not used (more compact store)\n char constexpr ChrClassesEntryfmt[] = \"nxixssssssssssssssssxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxixii\";\n@@ -48,6 +49,7 @@ char constexpr DurabilityCostsfmt[] = \"niiiiiiiiiiiiiiiiiiiiiiiiiiiii\";\n char constexpr DurabilityQualityfmt[] = \"nf\";\n char constexpr EmotesEntryfmt[] = \"nxxiiix\";\n char constexpr EmotesTextEntryfmt[] = \"nxixxxxxxxxxxxxxxxx\";\n+char constexpr EmotesTextSoundEntryfmt[] = \"niiii\";\n char constexpr FactionEntryfmt[] = \"niiiiiiiiiiiiiiiiiiffixssssssssssssssssxxxxxxxxxxxxxxxxxx\";\n char constexpr FactionTemplateEntryfmt[] = \"niiiiiiiiiiiii\";\n char constexpr GameObjectArtKitfmt[] = \"nxxxxxxx\";\ndiff --git a/src/server/shared/SharedDefines.h b/src/server/shared/SharedDefines.h\nindex b5a979dead96a3..527d5ae7b91dbe 100644\n--- a/src/server/shared/SharedDefines.h\n+++ b/src/server/shared/SharedDefines.h\n@@ -1378,7 +1378,7 @@ enum Mechanics : uint32\n     (1&lt;&lt;MECHANIC_SAPPED))\n\n // Spell dispel type\n-enum DispelType\n+enum DispelType : uint8\n {\n     DISPEL_NONE         = 0,\n     DISPEL_MAGIC        = 1,\n@@ -1642,7 +1642,7 @@ enum GameObjectDestructibleState\n };\n\n // EmotesText.dbc\n-enum TextEmotes\n+enum TextEmotes : uint32\n {\n     TEXT_EMOTE_AGREE                = 1,\n     TEXT_EMOTE_AMAZE                = 2,\n@@ -3386,7 +3386,7 @@ enum WeatherType\n #define MAX_WEATHER_TYPE 4\n\n // EnumUtils: DESCRIBE THIS\n-enum ChatMsg\n+enum ChatMsg : uint32\n {\n     CHAT_MSG_ADDON                  = 0xFFFFFFFF,\n     CHAT_MSG_SYSTEM                 = 0x00,\n</code></pre>"},{"location":"execution-flows/","title":"2 \u2014 Major execution flows","text":"<p>This page documents the runtime flows that most contributors need to understand first: the per\u2011bot update loop, login/attach, command routing, packet routing, and random bot lifecycle. All flows are based on the current code in <code>src/Bot/</code> and <code>src/Script/</code>.</p>"},{"location":"execution-flows/#21-ai-tick-updateai-updateaiinternal-donextaction","title":"2.1 \u2014 AI tick (UpdateAI \u2192 UpdateAIInternal \u2192 DoNextAction)","text":"<p>Entry points - <code>PlayerbotsPlayerScript::OnPlayerAfterUpdate</code> calls <code>PlayerbotAI::UpdateAI(diff)</code> for bots. - <code>PlayerbotAI::UpdateAI(uint32 elapsed, bool minimal)</code> is the per\u2011bot tick function.</p> <p>Flow (text sequence) 1. <code>PlayerbotAI::UpdateAI</code> applies early exits (session/world/teleport/logout checks) and timing gates. 2. It applies optional cheat\u2011driven fixes (health/power). 3. It validates <code>CanUpdateAI()</code> and handles current spell state checks. 4. It calls <code>UpdateAIInternal(elapsed, minimal)</code>. 5. <code>UpdateAIInternal</code> processes queued chat/commands, logout logic, and packet queues. 6. It ends with <code>DoNextAction(minimal)</code> which delegates to the current engine.</p> <pre><code>sequenceDiagram\n  participant PS as \"PlayerbotsPlayerScript\"\n  participant AI as \"PlayerbotAI\"\n  participant Engine as \"Engine\"\n\n  PS-&gt;&gt;AI: \"UpdateAI(diff)\"\n  AI-&gt;&gt;AI: \"UpdateAIInternal(elapsed)\"\n  AI-&gt;&gt;AI: \"HandleCommands + packet queues\"\n  AI-&gt;&gt;Engine: \"DoNextAction(minimal)\"</code></pre>"},{"location":"execution-flows/#22-bot-login-attach-flow-master-bots-and-random-bots","title":"2.2 \u2014 Bot login / attach flow (master bots and random bots)","text":"<p>Entry points - <code>PlayerbotHolder::AddPlayerBot(ObjectGuid, masterAccountId)</code> starts login for a bot. - Login completion goes through <code>PlayerbotHolder::HandlePlayerBotLoginCallback</code>.</p> <p>Flow (text sequence) 1. <code>AddPlayerBot</code> validates permissions (account/guild/linked/addclass rules) and queues a login query holder. 2. The login callback creates a <code>WorldSession</code> and calls <code>HandlePlayerLoginFromDB</code>. 3. The bot is registered via <code>sRandomPlayerbotMgr.OnPlayerLogin(bot)</code>. 4. An <code>OnBotLoginOperation</code> is queued in the world thread processor. 5. <code>OnBotLoginOperation::Execute</code> selects the correct holder (random vs master\u2011bound) and calls <code>holder-&gt;OnBotLogin(bot)</code>. 6. <code>PlayerbotHolder::OnBotLogin</code> adds the bot to <code>playerBots</code> and calls <code>OnBotLoginInternal</code>.</p> <pre><code>sequenceDiagram\n  participant Holder as \"PlayerbotHolder\"\n  participant World as \"WorldSession\"\n  participant Rnd as \"RandomPlayerbotMgr\"\n  participant Op as \"OnBotLoginOperation\"\n\n  Holder-&gt;&gt;Holder: \"AddPlayerBot(guid, masterAccountId)\"\n  Holder-&gt;&gt;World: \"HandlePlayerLoginFromDB(holder)\"\n  World--&gt;&gt;Holder: \"bot Player created\"\n  Holder-&gt;&gt;Rnd: \"OnPlayerLogin(bot)\"\n  Holder-&gt;&gt;Op: \"Queue OnBotLoginOperation\"\n  Op-&gt;&gt;Holder: \"OnBotLogin(bot)\"</code></pre>"},{"location":"execution-flows/#23-player-command-bot-chat-and-channel-routing","title":"2.3 \u2014 Player command \u2192 bot (chat and channel routing)","text":"<p>Entry points - Chat hooks in <code>PlayerbotsPlayerScript::OnPlayerCanUseChat</code> handle whisper, group, guild, and channel messages. - <code>PlayerbotMgr::HandleCommand</code> dispatches to all master\u2011controlled bots. - <code>RandomPlayerbotMgr::HandleCommand</code> dispatches to random bots.</p> <p>Flow (text sequence) 1. A player sends chat (whisper/group/guild/channel). 2. The hook detects a bot recipient and calls <code>HandleCommand</code>. 3. <code>PlayerbotMgr::HandleCommand</code> splits by command separator and forwards to <code>PlayerbotAI::HandleCommand</code>. 4. <code>RandomPlayerbotMgr::HandleCommand</code> forwards to <code>PlayerbotAI::HandleCommand</code> for random bots.</p> <pre><code>sequenceDiagram\n  participant Chat as \"OnPlayerCanUseChat\"\n  participant Mgr as \"PlayerbotMgr\"\n  participant Rnd as \"RandomPlayerbotMgr\"\n  participant AI as \"PlayerbotAI\"\n\n  Chat-&gt;&gt;Mgr: \"HandleCommand(type, text)\"\n  Mgr-&gt;&gt;AI: \"HandleCommand(type, text, master)\"\n  Chat-&gt;&gt;Rnd: \"HandleCommand(type, text, player)\"\n  Rnd-&gt;&gt;AI: \"HandleCommand(type, text, player)\"</code></pre>"},{"location":"execution-flows/#24-packet-routing-master-bot","title":"2.4 \u2014 Packet routing (master \u2194 bot)","text":"<p>Entry points - <code>PlayerbotsServerScript::OnPacketReceived</code> routes incoming packets to the master\u2019s <code>PlayerbotMgr</code>. - <code>PlayerbotsScript::OnPlayerbotPacketSent</code> routes outgoing packets to bot AI and master manager.</p> <p>Flow (text sequence) 1. Incoming master packets are forwarded to each bot AI via <code>HandleMasterIncomingPacket</code>. 2. Outgoing bot packets are captured and forwarded via <code>HandleBotOutgoingPacket</code> and <code>HandleMasterOutgoingPacket</code>.</p> <pre><code>sequenceDiagram\n  participant Server as \"PlayerbotsServerScript\"\n  participant Mgr as \"PlayerbotMgr\"\n  participant AI as \"PlayerbotAI\"\n  participant Script as \"PlayerbotsScript\"\n\n  Server-&gt;&gt;Mgr: \"HandleMasterIncomingPacket(packet)\"\n  Mgr-&gt;&gt;AI: \"HandleMasterIncomingPacket(packet)\"\n  Script-&gt;&gt;AI: \"HandleBotOutgoingPacket(packet)\"\n  Script-&gt;&gt;Mgr: \"HandleMasterOutgoingPacket(packet)\"</code></pre>"},{"location":"execution-flows/#25-random-bot-lifecycle-world-tick-loginlogout-queues","title":"2.5 \u2014 Random bot lifecycle (world tick, login/logout, queues)","text":"<p>Entry points - <code>PlayerbotsWorldScript::OnUpdate</code> runs the world\u2011thread tick. - <code>RandomPlayerbotMgr::UpdateAIInternal</code> orchestrates the random bot lifecycle.</p> <p>Flow (text sequence) 1. <code>OnUpdate</code> calls <code>sRandomPlayerbotMgr.UpdateAI(diff)</code> (world thread). 2. <code>UpdateAIInternal</code> computes target bot counts and (if allowed) triggers logins via <code>AddRandomBots</code>. 3. It periodically checks players, BG queue, and LFG queue timers. 4. It calls <code>ProcessBot</code> for updates and logins. 5. It triggers logouts (<code>LogoutAllBots</code>) when required by configuration or no real players online.</p> <pre><code>sequenceDiagram\n  participant World as \"PlayerbotsWorldScript\"\n  participant Rnd as \"RandomPlayerbotMgr\"\n\n  World-&gt;&gt;Rnd: \"UpdateAI(diff)\"\n  Rnd-&gt;&gt;Rnd: \"UpdateAIInternal(elapsed)\"\n  Rnd-&gt;&gt;Rnd: \"AddRandomBots / ProcessBot\"\n  Rnd-&gt;&gt;Rnd: \"CheckPlayers / CheckBgQueue / CheckLfgQueue\"\n  Rnd-&gt;&gt;Rnd: \"LogoutAllBots (if needed)\"</code></pre>"},{"location":"gameplay-specific-systems/","title":"4 \u2014 Gameplay\u2011specific systems","text":"<p>This page maps the gameplay systems that sit on top of the core AI architecture described in Phase 3.</p>"},{"location":"gameplay-specific-systems/#41-pathfinding-movement","title":"4.1 \u2014 Pathfinding / Movement","text":"<p>Role - Handles movement commands, path choices, follow behavior, and special movement logic (BG paths, raid mechanics).</p> <p>Key components - Movement actions under <code>src/Ai/Base/Actions/MovementActions.*</code> and specialized movement actions in raid files. - Travel system: <code>TravelMgr</code> (<code>src/Mgr/Travel/</code>) and <code>TravelTarget</code> values (<code>\"travel target\"</code> value in AI context). - BG movement: <code>BattleGroundTactics</code> (<code>src/Ai/Base/Actions/BattleGroundTactics.cpp</code>) with prebuilt paths.</p> <p>How it works (high level) 1. Strategies enqueue movement actions (e.g., follow, move to, flee, BG pathing). 2. Movement actions call helpers like <code>MoveTo</code> / <code>MoveNear</code>. 3. <code>TravelMgr</code> provides destinations for RPG/quest travel and updates <code>TravelTarget</code>.</p> <p>Extension points - Add new movement behaviors as <code>MovementAction</code> subclasses. - Register new travel destinations or logic in <code>TravelMgr</code>. - Extend BG pathing by adding paths/waypoints in <code>BattleGroundTactics</code>.</p> <p>Risks / pitfalls - Movement is sensitive to world state; avoid forcing movement when a bot is already in flight, teleporting, or logging out. - Prefer existing movement helpers and flags rather than manual movement flag hacks.</p> <pre><code>flowchart TD\n  A[\"Strategy / Trigger\"] --&gt; B[\"MovementAction (MoveTo/MoveNear)\"]\n  B --&gt; C[\"MotionMaster / Movement flags\"]\n  B --&gt; D[\"TravelTarget value\"]\n  D --&gt; E[\"TravelMgr destinations\"]\n  B --&gt; F[\"BattleGroundTactics paths\"]</code></pre>"},{"location":"gameplay-specific-systems/#42-combat-melee-ranged-heal","title":"4.2 \u2014 Combat (melee / ranged / heal)","text":"<p>Role - Defines the combat decision\u2011making for different classes, roles, and situations.</p> <p>Key components - Class strategies under <code>src/Ai/Class/*/Strategy/</code> (combat logic per class/spec). - Default engine composition in <code>AiFactory</code> (<code>src/Bot/Factory/AiFactory.cpp</code>). - Core combat actions under <code>src/Ai/Base/Actions/</code> (generic attacks, interrupts, buffs).</p> <p>How it works (high level) 1. <code>AiFactory</code> builds the combat engine and attaches default strategies. 2. Class strategies define triggers and default actions (e.g., warrior DPS rotation). 3. The engine selects the highest\u2011priority action and executes it.</p> <p>Extension points - Add or adjust class strategies for new rotations or smarter responses. - Add new combat actions and expose them via the AI context.</p> <p>Risks / pitfalls - Avoid duplicating existing combat checks (use shared helpers and values). - Keep action relevance balanced to prevent \u201cspammy\u201d or unsafe actions.</p> <pre><code>flowchart TD\n  A[\"AiFactory combat engine\"] --&gt; B[\"Combat strategies\"]\n  B --&gt; C[\"Triggers -&gt; NextAction\"]\n  C --&gt; D[\"Action::Execute\"]\n  D --&gt; E[\"Spell/Combat helpers\"]</code></pre>"},{"location":"gameplay-specific-systems/#43-group-raid-logic","title":"4.3 \u2014 Group / Raid logic","text":"<p>Role - Coordinates bots in groups and raids, including raid\u2011specific boss logic.</p> <p>Key components - Raid strategies and raid action contexts under <code>src/Ai/Raid/</code>. - Raid trigger/action pairs for encounter logic (e.g., ICC, Magtheridon). - Group behaviors in base strategies (assist, follow, heal, tank).</p> <p>How it works (high level) 1. Raid strategy contexts register encounter strategies. 2. Encounter strategies add triggers tied to boss mechanics. 3. Actions implement positioning, target selection, and special mechanics.</p> <p>Extension points - Add new raid strategies and register them in <code>RaidStrategyContext</code>. - Add encounter actions/triggers in the relevant raid folder.</p> <p>Risks / pitfalls - Raid logic often relies on movement timing; keep movement changes minimal and tested. - Avoid hard\u2011coding actions that conflict with generic combat logic.</p> <pre><code>flowchart TD\n  A[\"RaidStrategyContext\"] --&gt; B[\"Encounter strategy\"]\n  B --&gt; C[\"Raid triggers\"]\n  C --&gt; D[\"Raid actions\"]\n  D --&gt; E[\"Movement/target selection\"]</code></pre>"},{"location":"gameplay-specific-systems/#44-lfg-bg-arena","title":"4.4 \u2014 LFG / BG / Arena","text":"<p>Role - Manages bots in group finder, battlegrounds, and arena contexts.</p> <p>Key components - RandomPlayerbotMgr queue checks: BG/LFG periodic checks and join logic. - BattleGroundTactics for BG pathing and objectives. - Arena strategies via combat/non\u2011combat engine strategy switches.</p> <p>How it works (high level) 1. <code>RandomPlayerbotMgr::UpdateAIInternal</code> schedules BG/LFG checks. 2. BG logic uses path tables and objective selection in <code>BattleGroundTactics</code>. 3. Arena adds/adjusts strategies via <code>AiFactory</code> (arena strategy flags).</p> <p>Extension points - Add/adjust BG tactics (paths, flags, objectives). - Extend queue logic and scheduling in <code>RandomPlayerbotMgr</code>.</p> <p>Risks / pitfalls - BG paths must exist for the target BG; missing paths can cause movement failures. - Arena strategy tuning should stay consistent with core combat expectations.</p> <pre><code>flowchart TD\n  A[\"RandomPlayerbotMgr\"] --&gt; B[\"BG/LFG checks\"]\n  B --&gt; C[\"Join/queue logic\"]\n  C --&gt; D[\"BattleGroundTactics\"]\n  D --&gt; E[\"Paths/objectives\"]</code></pre>"},{"location":"gameplay-specific-systems/#45-random-bot-rpg-logic","title":"4.5 \u2014 Random bot RPG logic","text":"<p>Role - Drives autonomous \u201clife\u2011like\u201d behavior: travel, grinding, questing, and roaming.</p> <p>Key components - RPG strategies in <code>src/Ai/World/Rpg/</code>. - TravelMgr and travel targets for destination planning. - RandomPlayerbotMgr randomization and teleport helpers.</p> <p>How it works (high level) 1. Random bots select an RPG strategy (classic RPG or new RPG). 2. Travel targets are chosen and movement actions are issued to reach them. 3. Random bot lifecycle updates (login/refresh/teleport) keep population active.</p> <p>Extension points - Add new RPG actions or triggers (e.g., smarter roam, safer grinding). - Add or improve travel destinations and selection criteria.</p> <p>Risks / pitfalls - Avoid heavy computations every tick; prefer cached values with intervals. - Respect existing random bot scheduling to avoid server load spikes.</p> <pre><code>flowchart TD\n  A[\"RPG strategy\"] --&gt; B[\"TravelTarget selection\"]\n  B --&gt; C[\"TravelMgr destinations\"]\n  C --&gt; D[\"Movement actions\"]\n  A --&gt; E[\"RandomPlayerbotMgr scheduling\"]</code></pre>"},{"location":"high-level-architecture/","title":"1 - High-level architecture","text":""},{"location":"high-level-architecture/#1a-macro-component-map","title":"1.A \u2014 Macro component map","text":""},{"location":"high-level-architecture/#core-entry-points-and-orchestrators","title":"Core entry points and orchestrators","text":"Component Responsibility Primary location PlayerbotAI Per-bot decision controller. Owns the AI context and switches between combat / non-combat / dead engines. <code>src/Bot/PlayerbotAI.*</code> PlayerbotMgr Manages bots linked to a real player (chat/command routing, login/logout). <code>src/Bot/PlayerbotMgr.*</code> RandomPlayerbotMgr Manages autonomous bots (population, lifecycle, scheduling). <code>src/Bot/RandomPlayerbotMgr.*</code> PlayerbotAIConfig Centralized configuration and tunables loaded at server startup. <code>src/PlayerbotAIConfig.*</code>"},{"location":"high-level-architecture/#ai-decision-stack-inside-one-bot","title":"AI decision stack (inside one bot)","text":"Layer Responsibility Primary location AiObjectContext Registry/factory for actions, triggers, values, strategies. <code>src/Bot/Factory/</code> Engines Combat / non-combat / dead engines that execute strategies and actions. <code>src/Bot/Engine/</code> Strategies Behavior bundles that add triggers and actions. <code>src/Ai/</code> Actions Atomic behaviors executed by the engine (cast, move, loot, travel). <code>src/Ai/</code> Triggers &amp; Values Conditions and data providers that decide which actions run. <code>src/Ai/</code>"},{"location":"high-level-architecture/#supporting-systems-shared-services","title":"Supporting systems (shared services)","text":"System Responsibility Primary location TravelMgr Travel destinations, RPG locations, routing helpers for movement. <code>src/Mgr/Travel/</code> Guild / Item / Move / Security / Talent / Text Cross-cutting managers used by AI logic. <code>src/Mgr/</code> Repositories &amp; caches Data access and precomputed caches for AI decisions. <code>src/Db/</code> Scripts AzerothCore script hooks and module wiring. <code>src/Script/</code>"},{"location":"high-level-architecture/#high-level-interaction-diagram","title":"High-level interaction diagram","text":"<pre><code>flowchart TD\n  A[PlayerbotMgr] --&gt;|master commands| B[PlayerbotAI]\n  C[RandomPlayerbotMgr] --&gt;|lifecycle/ticks| B\n  B --&gt; D[AiObjectContext]\n  D --&gt; E[Engines]\n  E --&gt; F[Strategies / Triggers / Values]\n  F --&gt; G[Actions]\n  B --&gt; H[PlayerbotAIConfig]\n  B --&gt; I[Mgr/* services]\n  B --&gt; J[Db/* repositories]\n  B --&gt; K[Script/* hooks]</code></pre>"},{"location":"high-level-architecture/#1b-roles-and-interactions","title":"1.B \u2014 Roles and interactions","text":""},{"location":"high-level-architecture/#playerbotai-per-bot-ai-core","title":"PlayerbotAI \u2014 per-bot AI core","text":"<ul> <li>Construction and AI wiring</li> <li>Each bot builds an <code>AiObjectContext</code>, then creates three engines (combat, non-combat, dead) through     <code>AiFactory::createCombatEngine</code>, <code>createNonCombatEngine</code>, and <code>createDeadEngine</code>. The current engine starts     in non-combat by default.  </li> <li>Packet handlers for master incoming/outgoing and bot outgoing queues are registered during construction.</li> <li>Per-tick AI loop</li> <li><code>PlayerbotAI::UpdateAI</code> prepares state and calls <code>UpdateAIInternal</code>.</li> <li><code>UpdateAIInternal</code> processes queued chat replies, runs <code>HandleCommands</code>, handles logout rules, then processes     packet handler queues and ends with <code>DoNextAction(minimal)</code> to execute the engine decision.</li> <li>Packet queues / handlers</li> <li>masterIncomingPacketHandlers: parses master-to-bot packets (game object use, taxi, quest, etc.).</li> <li>masterOutgoingPacketHandlers: forwards bot-related responses back to the master (party/raid events, quest     details).</li> <li>botOutgoingPacketHandlers: observes bot-&gt;server responses and triggers AI reactions (loot, trade, BG/LFG).</li> <li>Master management</li> <li><code>UpdateAIGroupMaster</code> enforces group/master rules, including reassigning masters for random bots when necessary.</li> <li>Logout logic (inside <code>UpdateAIInternal</code>)</li> <li>If the bot session is logging out, the AI checks <code>ShouldLogOut()</code> and multiple fast-exit cases:<ul> <li>bot or master resting, in flight, or master session permissions allow instant logout.</li> </ul> </li> <li>If logout is confirmed, the bot is logged out via <code>PlayerbotMgr::LogoutPlayerBot</code> (master bots) or     <code>RandomPlayerbotMgr::LogoutPlayerBot</code> (random bots), and the tick exits early.</li> </ul>"},{"location":"high-level-architecture/#playerbotmgr-master-bound-bot-orchestration","title":"PlayerbotMgr \u2014 master-bound bot orchestration","text":"<ul> <li>Command fan-out</li> <li><code>PlayerbotMgr::HandleCommand</code> splits multi-commands and forwards them to each bot AI (including random bots     currently bound to the same master).</li> <li>Packet fan-out</li> <li><code>PlayerbotMgr::HandleMasterIncomingPacket</code> forwards master packets to each bot AI and reacts to login/logout     opcodes by logging bots in or out.</li> <li>Periodic update</li> <li><code>PlayerbotMgr::UpdateAIInternal</code> only maintains error notifications and timing, deferring AI decisions to     each bot\u2019s <code>PlayerbotAI</code> instance.</li> </ul>"},{"location":"high-level-architecture/#randomplayerbotmgr-autonomous-population-manager","title":"RandomPlayerbotMgr \u2014 autonomous population manager","text":"<ul> <li>Population control</li> <li><code>RandomPlayerbotMgr::UpdateAIInternal</code> computes target bot counts, manages login/logout, and schedules which bots     will be updated on each cycle.</li> <li>Queue integrations</li> <li>The same update loop triggers background checks for BG and LFG queues based on configured timers.</li> <li>Bot processing</li> <li>Selected bots are processed via <code>ProcessBot</code>, which decides whether to update an online bot or log in a new one.</li> </ul>"},{"location":"high-level-architecture/#interaction-sketch-textual-consolidated","title":"Interaction sketch (textual, consolidated)","text":"<ol> <li>Bot creation / login: <code>PlayerbotMgr</code> or <code>RandomPlayerbotMgr</code> brings a bot online and constructs <code>PlayerbotAI</code>.</li> <li>AI wiring: <code>PlayerbotAI</code> builds <code>AiObjectContext</code>, initializes engines, and registers packet handlers.</li> <li>Per-tick: <code>PlayerbotAI::UpdateAI</code> \u2192 <code>UpdateAIInternal</code> \u2192 <code>DoNextAction</code> drives decision-making.</li> <li>Master commands: <code>PlayerbotMgr::HandleCommand</code> fans out text commands to bot AIs.</li> <li>Autonomous lifecycle: <code>RandomPlayerbotMgr::UpdateAIInternal</code> schedules bot updates and logins.</li> </ol>"},{"location":"high-level-architecture/#mini-timeline-who-calls-who","title":"Mini timeline (who calls who)","text":"<pre><code>sequenceDiagram\n  participant M as PlayerbotMgr\n  participant R as RandomPlayerbotMgr\n  participant A as PlayerbotAI\n  participant F as AiFactory\n  participant E as Engine\n\n  M-&gt;&gt;A: Construct PlayerbotAI (master bots)\n  R-&gt;&gt;A: Construct PlayerbotAI (random bots)\n  A-&gt;&gt;F: createAiObjectContext + create*Engine\n  A-&gt;&gt;A: Register packet handlers\n  A-&gt;&gt;A: UpdateAI\n  A-&gt;&gt;A: UpdateAIInternal\n  A-&gt;&gt;E: DoNextAction</code></pre>"},{"location":"high-level-architecture/#flow-table-core-interactions","title":"Flow table (core interactions)","text":"Trigger Orchestrator Key calls Outcome Master chat command <code>PlayerbotMgr</code> <code>HandleCommand</code> \u2192 <code>PlayerbotAI::HandleCommand</code> Bot strategy/action update Bot tick <code>PlayerbotAI</code> <code>UpdateAI</code> \u2192 <code>UpdateAIInternal</code> \u2192 <code>DoNextAction</code> Action selection and execution Master packet <code>PlayerbotMgr</code> <code>HandleMasterIncomingPacket</code> \u2192 <code>PlayerbotAI::HandleMasterIncomingPacket</code> Bot reacts to master Random bot tick <code>RandomPlayerbotMgr</code> <code>UpdateAIInternal</code> \u2192 <code>ProcessBot</code> Update existing bots / login new bots"},{"location":"high-level-architecture/#1c-notes-for-diagram","title":"1.C \u2014 Notes for diagram","text":"<ul> <li>AI engine construction &amp; strategy injection</li> <li><code>PlayerbotAI::PlayerbotAI(Player* bot)</code> creates the AI context with     <code>AiFactory::createAiObjectContext</code>, then builds the combat, non-combat, and dead     engines using <code>AiFactory::createCombatEngine</code>, <code>createNonCombatEngine</code>, and <code>createDeadEngine</code>.</li> <li>Each engine is assembled in <code>AiFactory</code>, where default strategies are attached     (<code>AddDefaultCombatStrategies</code>, <code>AddDefaultNonCombatStrategies</code>, <code>AddDefaultDeadStrategies</code>),     followed by <code>Engine::Init()</code> to finalize triggers and actions.</li> <li>Update tick entry point</li> <li><code>PlayerbotAI::UpdateAI</code> is the per-bot tick. It runs early guards (world/session state, transport),     updates group/master state, and then calls <code>UpdateAIInternal</code>.</li> <li><code>PlayerbotAI::UpdateAIInternal</code> processes chat replies, runs <code>HandleCommands</code>, applies logout rules,     processes packet handler queues, then calls <code>DoNextAction(minimal)</code> to dispatch the next AI action.</li> <li>Manager ticks: <code>PlayerbotMgr::UpdateAIInternal</code> handles master-bot error reporting timers, while     <code>RandomPlayerbotMgr::UpdateAIInternal</code> drives random-bot population updates and scheduling.</li> <li>Random bot data stores (state/queues/caches)</li> <li>Battle/queue tracking: <code>BattlegroundData</code>, <code>VisualBots</code>, <code>Supporters</code>, <code>LfgDungeons</code>.</li> <li>Caching: <code>BattleMastersCache</code>, <code>eventCache</code>, <code>rpgLocsCacheLevel</code>, <code>zone2LevelBracket</code>,     <code>locsPerLevelCache</code>, <code>allianceStarterPerLevelCache</code>, <code>hordeStarterPerLevelCache</code>,     <code>bankerLocsPerLevelCache</code>, <code>addclassCache</code>.</li> <li>Runtime lists: <code>players</code>, <code>currentBots</code>, plus inherited <code>playerBots</code> from <code>PlayerbotHolder</code>.</li> </ul>"},{"location":"high-level-architecture/#diagram","title":"Diagram","text":"<pre><code>flowchart TD\n  subgraph Construction[AI engine construction]\n    A[\"PlayerbotAI::PlayerbotAI\"] --&gt; B[\"AiFactory::createAiObjectContext\"]\n    A --&gt; C[\"AiFactory::createCombatEngine\"]\n    A --&gt; D[\"AiFactory::createNonCombatEngine\"]\n    A --&gt; E[\"AiFactory::createDeadEngine\"]\n    C --&gt; F[\"AddDefaultCombatStrategies\"]\n    D --&gt; G[\"AddDefaultNonCombatStrategies\"]\n    E --&gt; H[\"AddDefaultDeadStrategies\"]\n    F --&gt; I[\"Engine::Init\"]\n    G --&gt; I\n    H --&gt; I\n  end\n\n  subgraph Tick[Per-bot update tick]\n    J[\"PlayerbotAI::UpdateAI\"] --&gt; K[\"UpdateAIInternal\"]\n    K --&gt; L[\"Packet queues + command handling\"]\n    K --&gt; M[\"Logout logic\"]\n    K --&gt; N[\"DoNextAction(minimal)\"]\n  end\n\n  subgraph Managers[Manager ticks]\n    O[\"PlayerbotMgr::UpdateAIInternal\"] --&gt; P[\"Master-bound error notification timers\"]\n    Q[\"RandomPlayerbotMgr::UpdateAIInternal\"] --&gt; R[\"Random bot lifecycle + scheduling\"]\n  end\n\n  subgraph RandomData[Random bot data stores]\n    S[\"BattlegroundData / VisualBots / Supporters / LfgDungeons\"]\n    T[\"BattleMastersCache / eventCache / RPG caches\"]\n    U[\"players / currentBots / playerBots\"]\n  end\n\n  J -.-&gt;|uses| O\n  J -.-&gt;|uses| Q\n  Q -.-&gt;|reads/writes| S\n  Q -.-&gt;|reads/writes| T\n  Q -.-&gt;|reads/writes| U</code></pre> Open full-size diagram <pre><code>flowchart TD\n  subgraph Construction[AI engine construction]\n    A[\"PlayerbotAI::PlayerbotAI\"] --&gt; B[\"AiFactory::createAiObjectContext\"]\n    A --&gt; C[\"AiFactory::createCombatEngine\"]\n    A --&gt; D[\"AiFactory::createNonCombatEngine\"]\n    A --&gt; E[\"AiFactory::createDeadEngine\"]\n    C --&gt; F[\"AddDefaultCombatStrategies\"]\n    D --&gt; G[\"AddDefaultNonCombatStrategies\"]\n    E --&gt; H[\"AddDefaultDeadStrategies\"]\n    F --&gt; I[\"Engine::Init\"]\n    G --&gt; I\n    H --&gt; I\n  end\n\n  subgraph Tick[Per-bot update tick]\n    J[\"PlayerbotAI::UpdateAI\"] --&gt; K[\"UpdateAIInternal\"]\n    K --&gt; L[\"Packet queues + command handling\"]\n    K --&gt; M[\"Logout logic\"]\n    K --&gt; N[\"DoNextAction(minimal)\"]\n  end\n\n  subgraph Managers[Manager ticks]\n    O[\"PlayerbotMgr::UpdateAIInternal\"] --&gt; P[\"Master-bound error notification timers\"]\n    Q[\"RandomPlayerbotMgr::UpdateAIInternal\"] --&gt; R[\"Random bot lifecycle + scheduling\"]\n  end\n\n  subgraph RandomData[Random bot data stores]\n    S[\"BattlegroundData / VisualBots / Supporters / LfgDungeons\"]\n    T[\"BattleMastersCache / eventCache / RPG caches\"]\n    U[\"players / currentBots / playerBots\"]\n  end\n\n  J -.-&gt;|uses| O\n  J -.-&gt;|uses| Q\n  Q -.-&gt;|reads/writes| S\n  Q -.-&gt;|reads/writes| T\n  Q -.-&gt;|reads/writes| U</code></pre>"},{"location":"module-map-and-glossary/","title":"Module map &amp; glossary","text":""},{"location":"module-map-and-glossary/#module-map-folders-roles","title":"Module map (folders &amp; roles)","text":"Folder Role <code>src/Ai/</code> AI logic: strategies, actions, triggers, values, class/dungeon/raid/world specializations. <code>src/Bot/</code> Bot core: <code>PlayerbotAI</code>, bot managers, engine factories, command handling. <code>src/Db/</code> Data access and persistence logic for playerbots. <code>src/Mgr/</code> Managers and cross\u2011cutting systems (services used across bot subsystems). <code>src/Script/</code> Script bindings/integration points with AzerothCore. <code>src/Util/</code> Shared utility helpers used across the module. <code>src/PlayerbotAIConfig.*</code> Central configuration and tunables for bot behavior."},{"location":"module-map-and-glossary/#srcai-subfolders","title":"<code>src/Ai/</code> (subfolders)","text":"<ul> <li><code>Base/</code> \u2014 shared base AI logic (actions, triggers, values).</li> <li><code>Class/</code> \u2014 class-specific AI logic.</li> <li><code>Dungeon/</code> \u2014 dungeon-specific strategies/triggers/actions.</li> <li><code>Raid/</code> \u2014 raid-specific strategies/triggers/actions.</li> <li><code>World/</code> \u2014 world/overworld behavior logic.</li> </ul>"},{"location":"module-map-and-glossary/#srcbot-subfolders-key-files","title":"<code>src/Bot/</code> (subfolders + key files)","text":"<ul> <li><code>Cmd/</code> \u2014 command handling helpers.</li> <li><code>Debug/</code> \u2014 debugging utilities for bots.</li> <li><code>Engine/</code> \u2014 decision engine core (strategies/actions orchestration).</li> <li><code>Factory/</code> \u2014 AI context/engine factories and default strategy wiring.</li> <li><code>PlayerbotAI.*</code> \u2014 main bot AI entry point.</li> <li><code>PlayerbotMgr.*</code> \u2014 master-bound bot manager.</li> <li><code>RandomPlayerbotMgr.*</code> \u2014 random bot manager.</li> </ul>"},{"location":"module-map-and-glossary/#srcdb-repositoriescaches","title":"<code>src/Db/</code> (repositories/caches)","text":"<ul> <li><code>FlightMasterCache.*</code></li> <li><code>PlayerbotDungeonRepository.*</code></li> <li><code>PlayerbotRepository.*</code></li> <li><code>PlayerbotSpellRepository.*</code></li> </ul>"},{"location":"module-map-and-glossary/#srcmgr-subfolders","title":"<code>src/Mgr/</code> (subfolders)","text":"<ul> <li><code>Guild/</code></li> <li><code>Item/</code></li> <li><code>Move/</code></li> <li><code>Security/</code></li> <li><code>Talent/</code></li> <li><code>Text/</code></li> <li><code>Travel/</code></li> </ul>"},{"location":"module-map-and-glossary/#srcscript-scripts","title":"<code>src/Script/</code> (scripts)","text":"<ul> <li><code>PlayerbotCommandScript.*</code></li> <li><code>Playerbots.*</code></li> <li><code>PlayerbotsSecureLogin.*</code></li> <li><code>playerbots_loader.cpp</code></li> <li><code>WorldThr/</code></li> </ul>"},{"location":"module-map-and-glossary/#srcutil-helpers","title":"<code>src/Util/</code> (helpers)","text":"<ul> <li><code>BroadcastHelper.*</code></li> <li><code>Helpers.*</code></li> <li><code>LazyCalculatedValue.h</code></li> <li><code>PlaceholderHelper.*</code></li> <li><code>ServerFacade.*</code></li> </ul>"},{"location":"module-map-and-glossary/#detailed-file-index-current-repository","title":"Detailed file index (current repository)","text":"<p>Generated from the current repository layout to avoid manual searching.</p> src/ (top-level files) <pre><code>src/PlayerbotAIConfig.cpp\nsrc/PlayerbotAIConfig.h\n</code></pre> src/Bot/ (all files) <pre><code>src/Bot/Cmd/ChatFilter.cpp\nsrc/Bot/Cmd/ChatFilter.h\nsrc/Bot/Cmd/ChatHelper.cpp\nsrc/Bot/Cmd/ChatHelper.h\nsrc/Bot/Cmd/PlayerbotCommandServer.cpp\nsrc/Bot/Cmd/PlayerbotCommandServer.h\nsrc/Bot/Debug/PerfMonitor.cpp\nsrc/Bot/Debug/PerfMonitor.h\nsrc/Bot/Engine/Action/Action.cpp\nsrc/Bot/Engine/Action/Action.h\nsrc/Bot/Engine/AiObject.cpp\nsrc/Bot/Engine/AiObject.h\nsrc/Bot/Engine/AiObjectContext.cpp\nsrc/Bot/Engine/AiObjectContext.h\nsrc/Bot/Engine/Engine.cpp\nsrc/Bot/Engine/Engine.h\nsrc/Bot/Engine/ExternalEventHelper.cpp\nsrc/Bot/Engine/ExternalEventHelper.h\nsrc/Bot/Engine/Multiplier.h\nsrc/Bot/Engine/NamedObjectContext.cpp\nsrc/Bot/Engine/NamedObjectContext.h\nsrc/Bot/Engine/PassiveMultiplier.cpp\nsrc/Bot/Engine/PassiveMultiplier.h\nsrc/Bot/Engine/PlayerbotAIAware.h\nsrc/Bot/Engine/PlayerbotAIBase.cpp\nsrc/Bot/Engine/PlayerbotAIBase.h\nsrc/Bot/Engine/Strategy/CustomStrategy.cpp\nsrc/Bot/Engine/Strategy/CustomStrategy.h\nsrc/Bot/Engine/Strategy/Strategy.cpp\nsrc/Bot/Engine/Strategy/Strategy.h\nsrc/Bot/Engine/Trigger/Trigger.cpp\nsrc/Bot/Engine/Trigger/Trigger.h\nsrc/Bot/Engine/Value/Value.cpp\nsrc/Bot/Engine/Value/Value.h\nsrc/Bot/Engine/WorldPacket/Event.cpp\nsrc/Bot/Engine/WorldPacket/Event.h\nsrc/Bot/Factory/AiFactory.cpp\nsrc/Bot/Factory/AiFactory.h\nsrc/Bot/Factory/PlayerbotFactory.cpp\nsrc/Bot/Factory/PlayerbotFactory.h\nsrc/Bot/Factory/RandomPlayerbotFactory.cpp\nsrc/Bot/Factory/RandomPlayerbotFactory.h\nsrc/Bot/PlayerbotAI.cpp\nsrc/Bot/PlayerbotAI.h\nsrc/Bot/PlayerbotMgr.cpp\nsrc/Bot/PlayerbotMgr.h\nsrc/Bot/RandomPlayerbotMgr.cpp\nsrc/Bot/RandomPlayerbotMgr.h\n</code></pre> src/Db/ (all files) <pre><code>src/Db/FlightMasterCache.cpp\nsrc/Db/FlightMasterCache.h\nsrc/Db/PlayerbotDungeonRepository.cpp\nsrc/Db/PlayerbotDungeonRepository.h\nsrc/Db/PlayerbotRepository.cpp\nsrc/Db/PlayerbotRepository.h\nsrc/Db/PlayerbotSpellRepository.cpp\nsrc/Db/PlayerbotSpellRepository.h\n</code></pre> src/Mgr/ (all files) <pre><code>src/Mgr/Guild/GuildTaskMgr.cpp\nsrc/Mgr/Guild/GuildTaskMgr.h\nsrc/Mgr/Guild/PlayerbotGuildMgr.cpp\nsrc/Mgr/Guild/PlayerbotGuildMgr.h\nsrc/Mgr/Item/ItemVisitors.cpp\nsrc/Mgr/Item/ItemVisitors.h\nsrc/Mgr/Item/LootObjectStack.cpp\nsrc/Mgr/Item/LootObjectStack.h\nsrc/Mgr/Item/RandomItemMgr.cpp\nsrc/Mgr/Item/RandomItemMgr.h\nsrc/Mgr/Item/StatsCollector.cpp\nsrc/Mgr/Item/StatsCollector.h\nsrc/Mgr/Item/StatsWeightCalculator.cpp\nsrc/Mgr/Item/StatsWeightCalculator.h\nsrc/Mgr/Move/FleeManager.cpp\nsrc/Mgr/Move/FleeManager.h\nsrc/Mgr/Security/PlayerbotSecurity.cpp\nsrc/Mgr/Security/PlayerbotSecurity.h\nsrc/Mgr/Talent/Talentspec.cpp\nsrc/Mgr/Talent/Talentspec.h\nsrc/Mgr/Text/PlayerbotTextMgr.cpp\nsrc/Mgr/Text/PlayerbotTextMgr.h\nsrc/Mgr/Travel/TravelMgr.cpp\nsrc/Mgr/Travel/TravelMgr.h\nsrc/Mgr/Travel/TravelNode.cpp\nsrc/Mgr/Travel/TravelNode.h\n</code></pre> src/Script/ (all files) <pre><code>src/Script/PlayerbotCommandScript.cpp\nsrc/Script/PlayerbotCommandScript.h\nsrc/Script/Playerbots.cpp\nsrc/Script/Playerbots.h\nsrc/Script/PlayerbotsSecureLogin.cpp\nsrc/Script/WorldThr/PlayerbotOperation.h\nsrc/Script/WorldThr/PlayerbotOperations.h\nsrc/Script/WorldThr/PlayerbotWorldThreadProcessor.cpp\nsrc/Script/WorldThr/PlayerbotWorldThreadProcessor.h\nsrc/Script/WorldThr/Queue.cpp\nsrc/Script/WorldThr/Queue.h\nsrc/Script/playerbots_loader.cpp\n</code></pre> src/Util/ (all files) <pre><code>src/Util/BroadcastHelper.cpp\nsrc/Util/BroadcastHelper.h\nsrc/Util/Helpers.cpp\nsrc/Util/Helpers.h\nsrc/Util/LazyCalculatedValue.h\nsrc/Util/PlaceholderHelper.cpp\nsrc/Util/PlaceholderHelper.h\nsrc/Util/ServerFacade.cpp\nsrc/Util/ServerFacade.h\n</code></pre> src/Ai/Base/ (all files) <pre><code>src/Ai/Base/ActionContext.h\nsrc/Ai/Base/Actions/AcceptBattlegroundInvitationAction.cpp\nsrc/Ai/Base/Actions/AcceptBattlegroundInvitationAction.h\nsrc/Ai/Base/Actions/AcceptDuelAction.cpp\nsrc/Ai/Base/Actions/AcceptDuelAction.h\nsrc/Ai/Base/Actions/AcceptInvitationAction.cpp\nsrc/Ai/Base/Actions/AcceptInvitationAction.h\nsrc/Ai/Base/Actions/AcceptQuestAction.cpp\nsrc/Ai/Base/Actions/AcceptQuestAction.h\nsrc/Ai/Base/Actions/AcceptResurrectAction.cpp\nsrc/Ai/Base/Actions/AcceptResurrectAction.h\nsrc/Ai/Base/Actions/AddLootAction.cpp\nsrc/Ai/Base/Actions/AddLootAction.h\nsrc/Ai/Base/Actions/AreaTriggerAction.cpp\nsrc/Ai/Base/Actions/AreaTriggerAction.h\nsrc/Ai/Base/Actions/ArenaTeamActions.cpp\nsrc/Ai/Base/Actions/ArenaTeamActions.h\nsrc/Ai/Base/Actions/AttackAction.cpp\nsrc/Ai/Base/Actions/AttackAction.h\nsrc/Ai/Base/Actions/AutoMaintenanceOnLevelupAction.cpp\nsrc/Ai/Base/Actions/AutoMaintenanceOnLevelupAction.h\nsrc/Ai/Base/Actions/BankAction.cpp\nsrc/Ai/Base/Actions/BankAction.h\nsrc/Ai/Base/Actions/BattleGroundJoinAction.cpp\nsrc/Ai/Base/Actions/BattleGroundJoinAction.h\nsrc/Ai/Base/Actions/BattleGroundTactics.cpp\nsrc/Ai/Base/Actions/BattleGroundTactics.h\nsrc/Ai/Base/Actions/BossAuraActions.cpp\nsrc/Ai/Base/Actions/BossAuraActions.h\nsrc/Ai/Base/Actions/BuffAction.cpp\nsrc/Ai/Base/Actions/BuffAction.h\nsrc/Ai/Base/Actions/BuyAction.cpp\nsrc/Ai/Base/Actions/BuyAction.h\nsrc/Ai/Base/Actions/CancelChannelAction.cpp\nsrc/Ai/Base/Actions/CancelChannelAction.h\nsrc/Ai/Base/Actions/CastCustomSpellAction.cpp\nsrc/Ai/Base/Actions/CastCustomSpellAction.h\nsrc/Ai/Base/Actions/ChangeChatAction.cpp\nsrc/Ai/Base/Actions/ChangeChatAction.h\nsrc/Ai/Base/Actions/ChangeStrategyAction.cpp\nsrc/Ai/Base/Actions/ChangeStrategyAction.h\nsrc/Ai/Base/Actions/ChangeTalentsAction.cpp\nsrc/Ai/Base/Actions/ChangeTalentsAction.h\nsrc/Ai/Base/Actions/ChatShortcutActions.cpp\nsrc/Ai/Base/Actions/ChatShortcutActions.h\nsrc/Ai/Base/Actions/CheatAction.cpp\nsrc/Ai/Base/Actions/CheatAction.h\nsrc/Ai/Base/Actions/CheckMailAction.cpp\nsrc/Ai/Base/Actions/CheckMailAction.h\nsrc/Ai/Base/Actions/CheckMountStateAction.cpp\nsrc/Ai/Base/Actions/CheckMountStateAction.h\nsrc/Ai/Base/Actions/CheckValuesAction.cpp\nsrc/Ai/Base/Actions/CheckValuesAction.h\nsrc/Ai/Base/Actions/ChooseRpgTargetAction.cpp\nsrc/Ai/Base/Actions/ChooseRpgTargetAction.h\nsrc/Ai/Base/Actions/ChooseTargetActions.cpp\nsrc/Ai/Base/Actions/ChooseTargetActions.h\nsrc/Ai/Base/Actions/ChooseTravelTargetAction.cpp\nsrc/Ai/Base/Actions/ChooseTravelTargetAction.h\nsrc/Ai/Base/Actions/CombatActions.cpp\nsrc/Ai/Base/Actions/CombatActions.h\nsrc/Ai/Base/Actions/CustomStrategyEditAction.cpp\nsrc/Ai/Base/Actions/CustomStrategyEditAction.h\nsrc/Ai/Base/Actions/DebugAction.cpp\nsrc/Ai/Base/Actions/DebugAction.h\nsrc/Ai/Base/Actions/DelayAction.cpp\nsrc/Ai/Base/Actions/DelayAction.h\nsrc/Ai/Base/Actions/DestroyItemAction.cpp\nsrc/Ai/Base/Actions/DestroyItemAction.h\nsrc/Ai/Base/Actions/DropQuestAction.cpp\nsrc/Ai/Base/Actions/DropQuestAction.h\nsrc/Ai/Base/Actions/EmoteAction.cpp\nsrc/Ai/Base/Actions/EmoteAction.h\nsrc/Ai/Base/Actions/EquipAction.cpp\nsrc/Ai/Base/Actions/EquipAction.h\nsrc/Ai/Base/Actions/EquipGlyphsAction.cpp\nsrc/Ai/Base/Actions/EquipGlyphsAction.h\nsrc/Ai/Base/Actions/FishingAction.cpp\nsrc/Ai/Base/Actions/FishingAction.h\nsrc/Ai/Base/Actions/FlagAction.cpp\nsrc/Ai/Base/Actions/FlagAction.h\nsrc/Ai/Base/Actions/FollowActions.cpp\nsrc/Ai/Base/Actions/FollowActions.h\nsrc/Ai/Base/Actions/GenericActions.cpp\nsrc/Ai/Base/Actions/GenericActions.h\nsrc/Ai/Base/Actions/GenericBuffUtils.cpp\nsrc/Ai/Base/Actions/GenericBuffUtils.h\nsrc/Ai/Base/Actions/GenericSpellActions.cpp\nsrc/Ai/Base/Actions/GenericSpellActions.h\nsrc/Ai/Base/Actions/GiveItemAction.cpp\nsrc/Ai/Base/Actions/GiveItemAction.h\nsrc/Ai/Base/Actions/GoAction.cpp\nsrc/Ai/Base/Actions/GoAction.h\nsrc/Ai/Base/Actions/GossipHelloAction.cpp\nsrc/Ai/Base/Actions/GossipHelloAction.h\nsrc/Ai/Base/Actions/GreetAction.cpp\nsrc/Ai/Base/Actions/GreetAction.h\nsrc/Ai/Base/Actions/GuildAcceptAction.cpp\nsrc/Ai/Base/Actions/GuildAcceptAction.h\nsrc/Ai/Base/Actions/GuildBankAction.cpp\nsrc/Ai/Base/Actions/GuildBankAction.h\nsrc/Ai/Base/Actions/GuildCreateActions.cpp\nsrc/Ai/Base/Actions/GuildCreateActions.h\nsrc/Ai/Base/Actions/GuildManagementActions.cpp\nsrc/Ai/Base/Actions/GuildManagementActions.h\nsrc/Ai/Base/Actions/HelpAction.cpp\nsrc/Ai/Base/Actions/HelpAction.h\nsrc/Ai/Base/Actions/HireAction.cpp\nsrc/Ai/Base/Actions/HireAction.h\nsrc/Ai/Base/Actions/ImbueAction.cpp\nsrc/Ai/Base/Actions/ImbueAction.h\nsrc/Ai/Base/Actions/InventoryAction.cpp\nsrc/Ai/Base/Actions/InventoryAction.h\nsrc/Ai/Base/Actions/InventoryChangeFailureAction.cpp\nsrc/Ai/Base/Actions/InventoryChangeFailureAction.h\nsrc/Ai/Base/Actions/InviteToGroupAction.cpp\nsrc/Ai/Base/Actions/InviteToGroupAction.h\nsrc/Ai/Base/Actions/LeaveGroupAction.cpp\nsrc/Ai/Base/Actions/LeaveGroupAction.h\nsrc/Ai/Base/Actions/LfgActions.cpp\nsrc/Ai/Base/Actions/LfgActions.h\nsrc/Ai/Base/Actions/ListQuestsActions.cpp\nsrc/Ai/Base/Actions/ListQuestsActions.h\nsrc/Ai/Base/Actions/ListSpellsAction.cpp\nsrc/Ai/Base/Actions/ListSpellsAction.h\nsrc/Ai/Base/Actions/LogLevelAction.cpp\nsrc/Ai/Base/Actions/LogLevelAction.h\nsrc/Ai/Base/Actions/LootAction.cpp\nsrc/Ai/Base/Actions/LootAction.h\nsrc/Ai/Base/Actions/LootRollAction.cpp\nsrc/Ai/Base/Actions/LootRollAction.h\nsrc/Ai/Base/Actions/LootStrategyAction.cpp\nsrc/Ai/Base/Actions/LootStrategyAction.h\nsrc/Ai/Base/Actions/MailAction.cpp\nsrc/Ai/Base/Actions/MailAction.h\nsrc/Ai/Base/Actions/MoveToRpgTargetAction.cpp\nsrc/Ai/Base/Actions/MoveToRpgTargetAction.h\nsrc/Ai/Base/Actions/MoveToTravelTargetAction.cpp\nsrc/Ai/Base/Actions/MoveToTravelTargetAction.h\nsrc/Ai/Base/Actions/MovementActions.cpp\nsrc/Ai/Base/Actions/MovementActions.h\nsrc/Ai/Base/Actions/NonCombatActions.cpp\nsrc/Ai/Base/Actions/NonCombatActions.h\nsrc/Ai/Base/Actions/OpenItemAction.cpp\nsrc/Ai/Base/Actions/OpenItemAction.h\nsrc/Ai/Base/Actions/OutfitAction.cpp\nsrc/Ai/Base/Actions/OutfitAction.h\nsrc/Ai/Base/Actions/PassLeadershipToMasterAction.cpp\nsrc/Ai/Base/Actions/PassLeadershipToMasterAction.h\nsrc/Ai/Base/Actions/PetitionSignAction.cpp\nsrc/Ai/Base/Actions/PetitionSignAction.h\nsrc/Ai/Base/Actions/PetsAction.cpp\nsrc/Ai/Base/Actions/PetsAction.h\nsrc/Ai/Base/Actions/PositionAction.cpp\nsrc/Ai/Base/Actions/PositionAction.h\nsrc/Ai/Base/Actions/QueryItemUsageAction.cpp\nsrc/Ai/Base/Actions/QueryItemUsageAction.h\nsrc/Ai/Base/Actions/QueryQuestAction.cpp\nsrc/Ai/Base/Actions/QueryQuestAction.h\nsrc/Ai/Base/Actions/QuestAction.cpp\nsrc/Ai/Base/Actions/QuestAction.h\nsrc/Ai/Base/Actions/QuestConfirmAcceptAction.cpp\nsrc/Ai/Base/Actions/QuestConfirmAcceptAction.h\nsrc/Ai/Base/Actions/RandomBotUpdateAction.cpp\nsrc/Ai/Base/Actions/RandomBotUpdateAction.h\nsrc/Ai/Base/Actions/RangeAction.cpp\nsrc/Ai/Base/Actions/RangeAction.h\nsrc/Ai/Base/Actions/ReachTargetActions.cpp\nsrc/Ai/Base/Actions/ReachTargetActions.h\nsrc/Ai/Base/Actions/ReadyCheckAction.cpp\nsrc/Ai/Base/Actions/ReadyCheckAction.h\nsrc/Ai/Base/Actions/ReleaseSpiritAction.cpp\nsrc/Ai/Base/Actions/ReleaseSpiritAction.h\nsrc/Ai/Base/Actions/RememberTaxiAction.cpp\nsrc/Ai/Base/Actions/RememberTaxiAction.h\nsrc/Ai/Base/Actions/RemoveAuraAction.cpp\nsrc/Ai/Base/Actions/RemoveAuraAction.h\nsrc/Ai/Base/Actions/RepairAllAction.cpp\nsrc/Ai/Base/Actions/RepairAllAction.h\nsrc/Ai/Base/Actions/ResetAiAction.cpp\nsrc/Ai/Base/Actions/ResetAiAction.h\nsrc/Ai/Base/Actions/ResetInstancesAction.cpp\nsrc/Ai/Base/Actions/ResetInstancesAction.h\nsrc/Ai/Base/Actions/RevealGatheringItemAction.cpp\nsrc/Ai/Base/Actions/RevealGatheringItemAction.h\nsrc/Ai/Base/Actions/ReviveFromCorpseAction.cpp\nsrc/Ai/Base/Actions/ReviveFromCorpseAction.h\nsrc/Ai/Base/Actions/RewardAction.cpp\nsrc/Ai/Base/Actions/RewardAction.h\nsrc/Ai/Base/Actions/RpgAction.cpp\nsrc/Ai/Base/Actions/RpgAction.h\nsrc/Ai/Base/Actions/RpgSubActions.cpp\nsrc/Ai/Base/Actions/RpgSubActions.h\nsrc/Ai/Base/Actions/RpgValues.h\nsrc/Ai/Base/Actions/RtiAction.cpp\nsrc/Ai/Base/Actions/RtiAction.h\nsrc/Ai/Base/Actions/RtscAction.cpp\nsrc/Ai/Base/Actions/RtscAction.h\nsrc/Ai/Base/Actions/SaveManaAction.cpp\nsrc/Ai/Base/Actions/SaveManaAction.h\nsrc/Ai/Base/Actions/SayAction.cpp\nsrc/Ai/Base/Actions/SayAction.h\nsrc/Ai/Base/Actions/SecurityCheckAction.cpp\nsrc/Ai/Base/Actions/SecurityCheckAction.h\nsrc/Ai/Base/Actions/SeeSpellAction.cpp\nsrc/Ai/Base/Actions/SeeSpellAction.h\nsrc/Ai/Base/Actions/SellAction.cpp\nsrc/Ai/Base/Actions/SellAction.h\nsrc/Ai/Base/Actions/SendMailAction.cpp\nsrc/Ai/Base/Actions/SendMailAction.h\nsrc/Ai/Base/Actions/SetCraftAction.cpp\nsrc/Ai/Base/Actions/SetCraftAction.h\nsrc/Ai/Base/Actions/SetHomeAction.cpp\nsrc/Ai/Base/Actions/SetHomeAction.h\nsrc/Ai/Base/Actions/ShareQuestAction.cpp\nsrc/Ai/Base/Actions/ShareQuestAction.h\nsrc/Ai/Base/Actions/SkipSpellsListAction.cpp\nsrc/Ai/Base/Actions/SkipSpellsListAction.h\nsrc/Ai/Base/Actions/StatsAction.cpp\nsrc/Ai/Base/Actions/StatsAction.h\nsrc/Ai/Base/Actions/StayActions.cpp\nsrc/Ai/Base/Actions/StayActions.h\nsrc/Ai/Base/Actions/SuggestWhatToDoAction.cpp\nsrc/Ai/Base/Actions/SuggestWhatToDoAction.h\nsrc/Ai/Base/Actions/TalkToQuestGiverAction.cpp\nsrc/Ai/Base/Actions/TalkToQuestGiverAction.h\nsrc/Ai/Base/Actions/TameAction.cpp\nsrc/Ai/Base/Actions/TameAction.h\nsrc/Ai/Base/Actions/TaxiAction.cpp\nsrc/Ai/Base/Actions/TaxiAction.h\nsrc/Ai/Base/Actions/TeleportAction.cpp\nsrc/Ai/Base/Actions/TeleportAction.h\nsrc/Ai/Base/Actions/TellCastFailedAction.cpp\nsrc/Ai/Base/Actions/TellCastFailedAction.h\nsrc/Ai/Base/Actions/TellGlyphsAction.cpp\nsrc/Ai/Base/Actions/TellGlyphsAction.h\nsrc/Ai/Base/Actions/TellItemCountAction.cpp\nsrc/Ai/Base/Actions/TellItemCountAction.h\nsrc/Ai/Base/Actions/TellLosAction.cpp\nsrc/Ai/Base/Actions/TellLosAction.h\nsrc/Ai/Base/Actions/TellMasterAction.cpp\nsrc/Ai/Base/Actions/TellMasterAction.h\nsrc/Ai/Base/Actions/TellPvpStatsAction.cpp\nsrc/Ai/Base/Actions/TellPvpStatsAction.h\nsrc/Ai/Base/Actions/TellReputationAction.cpp\nsrc/Ai/Base/Actions/TellReputationAction.h\nsrc/Ai/Base/Actions/TellTargetAction.cpp\nsrc/Ai/Base/Actions/TellTargetAction.h\nsrc/Ai/Base/Actions/TradeAction.cpp\nsrc/Ai/Base/Actions/TradeAction.h\nsrc/Ai/Base/Actions/TradeStatusAction.cpp\nsrc/Ai/Base/Actions/TradeStatusAction.h\nsrc/Ai/Base/Actions/TradeStatusExtendedAction.cpp\nsrc/Ai/Base/Actions/TradeStatusExtendedAction.h\nsrc/Ai/Base/Actions/TradeValues.cpp\nsrc/Ai/Base/Actions/TradeValues.h\nsrc/Ai/Base/Actions/TrainerAction.cpp\nsrc/Ai/Base/Actions/TrainerAction.h\nsrc/Ai/Base/Actions/TravelAction.cpp\nsrc/Ai/Base/Actions/TravelAction.h\nsrc/Ai/Base/Actions/UnequipAction.cpp\nsrc/Ai/Base/Actions/UnequipAction.h\nsrc/Ai/Base/Actions/UnlockItemAction.cpp\nsrc/Ai/Base/Actions/UnlockItemAction.h\nsrc/Ai/Base/Actions/UnlockTradedItemAction.cpp\nsrc/Ai/Base/Actions/UnlockTradedItemAction.h\nsrc/Ai/Base/Actions/UseItemAction.cpp\nsrc/Ai/Base/Actions/UseItemAction.h\nsrc/Ai/Base/Actions/UseMeetingStoneAction.cpp\nsrc/Ai/Base/Actions/UseMeetingStoneAction.h\nsrc/Ai/Base/Actions/VehicleActions.cpp\nsrc/Ai/Base/Actions/VehicleActions.h\nsrc/Ai/Base/Actions/WhoAction.cpp\nsrc/Ai/Base/Actions/WhoAction.h\nsrc/Ai/Base/Actions/WipeAction.cpp\nsrc/Ai/Base/Actions/WipeAction.h\nsrc/Ai/Base/Actions/WorldBuffAction.cpp\nsrc/Ai/Base/Actions/WorldBuffAction.h\nsrc/Ai/Base/Actions/WtsAction.cpp\nsrc/Ai/Base/Actions/WtsAction.h\nsrc/Ai/Base/Actions/XpGainAction.cpp\nsrc/Ai/Base/Actions/XpGainAction.h\nsrc/Ai/Base/ChatActionContext.h\nsrc/Ai/Base/ChatTriggerContext.h\nsrc/Ai/Base/SharedValueContext.h\nsrc/Ai/Base/Strategy/AttackEnemyPlayersStrategy.cpp\nsrc/Ai/Base/Strategy/AttackEnemyPlayersStrategy.h\nsrc/Ai/Base/Strategy/BattlegroundStrategy.cpp\nsrc/Ai/Base/Strategy/BattlegroundStrategy.h\nsrc/Ai/Base/Strategy/CastTimeStrategy.cpp\nsrc/Ai/Base/Strategy/CastTimeStrategy.h\nsrc/Ai/Base/Strategy/ChatCommandHandlerStrategy.cpp\nsrc/Ai/Base/Strategy/ChatCommandHandlerStrategy.h\nsrc/Ai/Base/Strategy/CombatStrategy.cpp\nsrc/Ai/Base/Strategy/CombatStrategy.h\nsrc/Ai/Base/Strategy/ConserveManaStrategy.cpp\nsrc/Ai/Base/Strategy/ConserveManaStrategy.h\nsrc/Ai/Base/Strategy/DeadStrategy.cpp\nsrc/Ai/Base/Strategy/DeadStrategy.h\nsrc/Ai/Base/Strategy/DebugStrategy.cpp\nsrc/Ai/Base/Strategy/DebugStrategy.h\nsrc/Ai/Base/Strategy/DpsAssistStrategy.cpp\nsrc/Ai/Base/Strategy/DpsAssistStrategy.h\nsrc/Ai/Base/Strategy/DuelStrategy.cpp\nsrc/Ai/Base/Strategy/DuelStrategy.h\nsrc/Ai/Base/Strategy/EmoteStrategy.cpp\nsrc/Ai/Base/Strategy/EmoteStrategy.h\nsrc/Ai/Base/Strategy/FleeStrategy.cpp\nsrc/Ai/Base/Strategy/FleeStrategy.h\nsrc/Ai/Base/Strategy/FollowMasterStrategy.cpp\nsrc/Ai/Base/Strategy/FollowMasterStrategy.h\nsrc/Ai/Base/Strategy/GrindingStrategy.cpp\nsrc/Ai/Base/Strategy/GrindingStrategy.h\nsrc/Ai/Base/Strategy/GroupStrategy.cpp\nsrc/Ai/Base/Strategy/GroupStrategy.h\nsrc/Ai/Base/Strategy/GuardStrategy.cpp\nsrc/Ai/Base/Strategy/GuardStrategy.h\nsrc/Ai/Base/Strategy/GuildStrategy.cpp\nsrc/Ai/Base/Strategy/GuildStrategy.h\nsrc/Ai/Base/Strategy/KiteStrategy.cpp\nsrc/Ai/Base/Strategy/KiteStrategy.h\nsrc/Ai/Base/Strategy/LfgStrategy.cpp\nsrc/Ai/Base/Strategy/LfgStrategy.h\nsrc/Ai/Base/Strategy/LootNonCombatStrategy.cpp\nsrc/Ai/Base/Strategy/LootNonCombatStrategy.h\nsrc/Ai/Base/Strategy/MaintenanceStrategy.cpp\nsrc/Ai/Base/Strategy/MaintenanceStrategy.h\nsrc/Ai/Base/Strategy/MarkRtiStrategy.cpp\nsrc/Ai/Base/Strategy/MarkRtiStrategy.h\nsrc/Ai/Base/Strategy/MeleeCombatStrategy.cpp\nsrc/Ai/Base/Strategy/MeleeCombatStrategy.h\nsrc/Ai/Base/Strategy/MoveFromGroupStrategy.cpp\nsrc/Ai/Base/Strategy/MoveFromGroupStrategy.h\nsrc/Ai/Base/Strategy/NonCombatStrategy.cpp\nsrc/Ai/Base/Strategy/NonCombatStrategy.h\nsrc/Ai/Base/Strategy/PassTroughStrategy.cpp\nsrc/Ai/Base/Strategy/PassTroughStrategy.h\nsrc/Ai/Base/Strategy/PassiveStrategy.cpp\nsrc/Ai/Base/Strategy/PassiveStrategy.h\nsrc/Ai/Base/Strategy/PullStrategy.cpp\nsrc/Ai/Base/Strategy/PullStrategy.h\nsrc/Ai/Base/Strategy/QuestStrategies.cpp\nsrc/Ai/Base/Strategy/QuestStrategies.h\nsrc/Ai/Base/Strategy/RTSCStrategy.cpp\nsrc/Ai/Base/Strategy/RTSCStrategy.h\nsrc/Ai/Base/Strategy/RacialsStrategy.cpp\nsrc/Ai/Base/Strategy/RacialsStrategy.h\nsrc/Ai/Base/Strategy/RangedCombatStrategy.cpp\nsrc/Ai/Base/Strategy/RangedCombatStrategy.h\nsrc/Ai/Base/Strategy/ReturnStrategy.cpp\nsrc/Ai/Base/Strategy/ReturnStrategy.h\nsrc/Ai/Base/Strategy/RpgStrategy.cpp\nsrc/Ai/Base/Strategy/RpgStrategy.h\nsrc/Ai/Base/Strategy/RunawayStrategy.cpp\nsrc/Ai/Base/Strategy/RunawayStrategy.h\nsrc/Ai/Base/Strategy/SayStrategy.cpp\nsrc/Ai/Base/Strategy/SayStrategy.h\nsrc/Ai/Base/Strategy/StayStrategy.cpp\nsrc/Ai/Base/Strategy/StayStrategy.h\nsrc/Ai/Base/Strategy/TankAssistStrategy.cpp\nsrc/Ai/Base/Strategy/TankAssistStrategy.h\nsrc/Ai/Base/Strategy/TellTargetStrategy.cpp\nsrc/Ai/Base/Strategy/TellTargetStrategy.h\nsrc/Ai/Base/Strategy/ThreatStrategy.cpp\nsrc/Ai/Base/Strategy/ThreatStrategy.h\nsrc/Ai/Base/Strategy/TravelStrategy.cpp\nsrc/Ai/Base/Strategy/TravelStrategy.h\nsrc/Ai/Base/Strategy/UseFoodStrategy.cpp\nsrc/Ai/Base/Strategy/UseFoodStrategy.h\nsrc/Ai/Base/Strategy/UsePotionsStrategy.cpp\nsrc/Ai/Base/Strategy/UsePotionsStrategy.h\nsrc/Ai/Base/Strategy/WorldPacketHandlerStrategy.cpp\nsrc/Ai/Base/Strategy/WorldPacketHandlerStrategy.h\nsrc/Ai/Base/StrategyContext.h\nsrc/Ai/Base/Trigger/BossAuraTriggers.cpp\nsrc/Ai/Base/Trigger/BossAuraTriggers.h\nsrc/Ai/Base/Trigger/ChatCommandTrigger.cpp\nsrc/Ai/Base/Trigger/ChatCommandTrigger.h\nsrc/Ai/Base/Trigger/CureTriggers.cpp\nsrc/Ai/Base/Trigger/CureTriggers.h\nsrc/Ai/Base/Trigger/FishingTriggers.cpp\nsrc/Ai/Base/Trigger/FishingTriggers.h\nsrc/Ai/Base/Trigger/GenericTriggers.cpp\nsrc/Ai/Base/Trigger/GenericTriggers.h\nsrc/Ai/Base/Trigger/GuildTriggers.cpp\nsrc/Ai/Base/Trigger/GuildTriggers.h\nsrc/Ai/Base/Trigger/HealthTriggers.cpp\nsrc/Ai/Base/Trigger/HealthTriggers.h\nsrc/Ai/Base/Trigger/LfgTriggers.cpp\nsrc/Ai/Base/Trigger/LfgTriggers.h\nsrc/Ai/Base/Trigger/LootTriggers.cpp\nsrc/Ai/Base/Trigger/LootTriggers.h\nsrc/Ai/Base/Trigger/PvpTriggers.cpp\nsrc/Ai/Base/Trigger/PvpTriggers.h\nsrc/Ai/Base/Trigger/RangeTriggers.cpp\nsrc/Ai/Base/Trigger/RangeTriggers.h\nsrc/Ai/Base/Trigger/RpgTriggers.cpp\nsrc/Ai/Base/Trigger/RpgTriggers.h\nsrc/Ai/Base/Trigger/RtiTriggers.cpp\nsrc/Ai/Base/Trigger/RtiTriggers.h\nsrc/Ai/Base/Trigger/StuckTriggers.cpp\nsrc/Ai/Base/Trigger/StuckTriggers.h\nsrc/Ai/Base/Trigger/TravelTriggers.cpp\nsrc/Ai/Base/Trigger/TravelTriggers.h\nsrc/Ai/Base/Trigger/WithinAreaTrigger.cpp\nsrc/Ai/Base/Trigger/WithinAreaTrigger.h\nsrc/Ai/Base/Trigger/WorldPacketTrigger.cpp\nsrc/Ai/Base/Trigger/WorldPacketTrigger.h\nsrc/Ai/Base/TriggerContext.h\nsrc/Ai/Base/Value/ActiveSpellValue.cpp\nsrc/Ai/Base/Value/ActiveSpellValue.h\nsrc/Ai/Base/Value/AlwaysLootListValue.cpp\nsrc/Ai/Base/Value/AlwaysLootListValue.h\nsrc/Ai/Base/Value/AoeHealValues.cpp\nsrc/Ai/Base/Value/AoeHealValues.h\nsrc/Ai/Base/Value/AoeValues.cpp\nsrc/Ai/Base/Value/AoeValues.h\nsrc/Ai/Base/Value/Arrow.cpp\nsrc/Ai/Base/Value/Arrow.h\nsrc/Ai/Base/Value/AttackerCountValues.cpp\nsrc/Ai/Base/Value/AttackerCountValues.h\nsrc/Ai/Base/Value/AttackerWithoutAuraTargetValue.cpp\nsrc/Ai/Base/Value/AttackerWithoutAuraTargetValue.h\nsrc/Ai/Base/Value/AttackersValue.cpp\nsrc/Ai/Base/Value/AttackersValue.h\nsrc/Ai/Base/Value/AvailableLootValue.cpp\nsrc/Ai/Base/Value/AvailableLootValue.h\nsrc/Ai/Base/Value/BudgetValues.cpp\nsrc/Ai/Base/Value/BudgetValues.h\nsrc/Ai/Base/Value/CcTargetValue.cpp\nsrc/Ai/Base/Value/CcTargetValue.h\nsrc/Ai/Base/Value/ChatValue.h\nsrc/Ai/Base/Value/CollisionValue.cpp\nsrc/Ai/Base/Value/CollisionValue.h\nsrc/Ai/Base/Value/CraftValue.h\nsrc/Ai/Base/Value/CurrentCcTargetValue.cpp\nsrc/Ai/Base/Value/CurrentCcTargetValue.h\nsrc/Ai/Base/Value/CurrentTargetValue.cpp\nsrc/Ai/Base/Value/CurrentTargetValue.h\nsrc/Ai/Base/Value/DistanceValue.cpp\nsrc/Ai/Base/Value/DistanceValue.h\nsrc/Ai/Base/Value/DpsTargetValue.cpp\nsrc/Ai/Base/Value/DpsTargetValue.h\nsrc/Ai/Base/Value/DuelTargetValue.cpp\nsrc/Ai/Base/Value/DuelTargetValue.h\nsrc/Ai/Base/Value/EnemyHealerTargetValue.cpp\nsrc/Ai/Base/Value/EnemyHealerTargetValue.h\nsrc/Ai/Base/Value/EnemyPlayerValue.cpp\nsrc/Ai/Base/Value/EnemyPlayerValue.h\nsrc/Ai/Base/Value/EstimatedLifetimeValue.cpp\nsrc/Ai/Base/Value/EstimatedLifetimeValue.h\nsrc/Ai/Base/Value/FishValues.cpp\nsrc/Ai/Base/Value/FishValues.h\nsrc/Ai/Base/Value/Formations.cpp\nsrc/Ai/Base/Value/Formations.h\nsrc/Ai/Base/Value/GrindTargetValue.cpp\nsrc/Ai/Base/Value/GrindTargetValue.h\nsrc/Ai/Base/Value/GroupLeaderValue.cpp\nsrc/Ai/Base/Value/GroupLeaderValue.h\nsrc/Ai/Base/Value/GroupValues.cpp\nsrc/Ai/Base/Value/GroupValues.h\nsrc/Ai/Base/Value/GuildValues.cpp\nsrc/Ai/Base/Value/GuildValues.h\nsrc/Ai/Base/Value/HasAvailableLootValue.cpp\nsrc/Ai/Base/Value/HasAvailableLootValue.h\nsrc/Ai/Base/Value/HasTotemValue.cpp\nsrc/Ai/Base/Value/HasTotemValue.h\nsrc/Ai/Base/Value/InvalidTargetValue.cpp\nsrc/Ai/Base/Value/InvalidTargetValue.h\nsrc/Ai/Base/Value/IsBehindValue.cpp\nsrc/Ai/Base/Value/IsBehindValue.h\nsrc/Ai/Base/Value/IsFacingValue.cpp\nsrc/Ai/Base/Value/IsFacingValue.h\nsrc/Ai/Base/Value/IsMovingValue.cpp\nsrc/Ai/Base/Value/IsMovingValue.h\nsrc/Ai/Base/Value/ItemCountValue.cpp\nsrc/Ai/Base/Value/ItemCountValue.h\nsrc/Ai/Base/Value/ItemForSpellValue.cpp\nsrc/Ai/Base/Value/ItemForSpellValue.h\nsrc/Ai/Base/Value/ItemUsageValue.cpp\nsrc/Ai/Base/Value/ItemUsageValue.h\nsrc/Ai/Base/Value/LastMovementValue.cpp\nsrc/Ai/Base/Value/LastMovementValue.h\nsrc/Ai/Base/Value/LastSaidValue.h\nsrc/Ai/Base/Value/LastSpellCastTimeValue.h\nsrc/Ai/Base/Value/LastSpellCastValue.cpp\nsrc/Ai/Base/Value/LastSpellCastValue.h\nsrc/Ai/Base/Value/LeastHpTargetValue.cpp\nsrc/Ai/Base/Value/LeastHpTargetValue.h\nsrc/Ai/Base/Value/LfgValues.h\nsrc/Ai/Base/Value/LineTargetValue.cpp\nsrc/Ai/Base/Value/LineTargetValue.h\nsrc/Ai/Base/Value/LogLevelValue.h\nsrc/Ai/Base/Value/LootStrategyValue.cpp\nsrc/Ai/Base/Value/LootStrategyValue.h\nsrc/Ai/Base/Value/LootValues.cpp\nsrc/Ai/Base/Value/LootValues.h\nsrc/Ai/Base/Value/MaintenanceValues.cpp\nsrc/Ai/Base/Value/MaintenanceValues.h\nsrc/Ai/Base/Value/ManaSaveLevelValue.h\nsrc/Ai/Base/Value/NearestAdsValue.cpp\nsrc/Ai/Base/Value/NearestAdsValue.h\nsrc/Ai/Base/Value/NearestCorpsesValue.cpp\nsrc/Ai/Base/Value/NearestCorpsesValue.h\nsrc/Ai/Base/Value/NearestFriendlyPlayersValue.cpp\nsrc/Ai/Base/Value/NearestFriendlyPlayersValue.h\nsrc/Ai/Base/Value/NearestGameObjects.cpp\nsrc/Ai/Base/Value/NearestGameObjects.h\nsrc/Ai/Base/Value/NearestNonBotPlayersValue.cpp\nsrc/Ai/Base/Value/NearestNonBotPlayersValue.h\nsrc/Ai/Base/Value/NearestNpcsValue.cpp\nsrc/Ai/Base/Value/NearestNpcsValue.h\nsrc/Ai/Base/Value/NearestUnitsValue.cpp\nsrc/Ai/Base/Value/NearestUnitsValue.h\nsrc/Ai/Base/Value/NewPlayerNearbyValue.cpp\nsrc/Ai/Base/Value/NewPlayerNearbyValue.h\nsrc/Ai/Base/Value/OutfitListValue.cpp\nsrc/Ai/Base/Value/OutfitListValue.h\nsrc/Ai/Base/Value/PartyMemberToDispel.cpp\nsrc/Ai/Base/Value/PartyMemberToDispel.h\nsrc/Ai/Base/Value/PartyMemberToHeal.cpp\nsrc/Ai/Base/Value/PartyMemberToHeal.h\nsrc/Ai/Base/Value/PartyMemberToResurrect.cpp\nsrc/Ai/Base/Value/PartyMemberToResurrect.h\nsrc/Ai/Base/Value/PartyMemberValue.cpp\nsrc/Ai/Base/Value/PartyMemberValue.h\nsrc/Ai/Base/Value/PartyMemberWithoutAuraValue.cpp\nsrc/Ai/Base/Value/PartyMemberWithoutAuraValue.h\nsrc/Ai/Base/Value/PartyMemberWithoutItemValue.cpp\nsrc/Ai/Base/Value/PartyMemberWithoutItemValue.h\nsrc/Ai/Base/Value/PetTargetValue.cpp\nsrc/Ai/Base/Value/PetTargetValue.h\nsrc/Ai/Base/Value/PositionValue.cpp\nsrc/Ai/Base/Value/PositionValue.h\nsrc/Ai/Base/Value/PossibleRpgTargetsValue.cpp\nsrc/Ai/Base/Value/PossibleRpgTargetsValue.h\nsrc/Ai/Base/Value/PossibleTargetsValue.cpp\nsrc/Ai/Base/Value/PossibleTargetsValue.h\nsrc/Ai/Base/Value/PvpValues.cpp\nsrc/Ai/Base/Value/PvpValues.h\nsrc/Ai/Base/Value/QuestValues.cpp\nsrc/Ai/Base/Value/QuestValues.h\nsrc/Ai/Base/Value/RTSCValues.cpp\nsrc/Ai/Base/Value/RTSCValues.h\nsrc/Ai/Base/Value/RandomBotUpdateValue.h\nsrc/Ai/Base/Value/RangeValues.cpp\nsrc/Ai/Base/Value/RangeValues.h\nsrc/Ai/Base/Value/RtiTargetValue.cpp\nsrc/Ai/Base/Value/RtiTargetValue.h\nsrc/Ai/Base/Value/RtiValue.cpp\nsrc/Ai/Base/Value/RtiValue.h\nsrc/Ai/Base/Value/SelfTargetValue.cpp\nsrc/Ai/Base/Value/SelfTargetValue.h\nsrc/Ai/Base/Value/SkipSpellsListValue.cpp\nsrc/Ai/Base/Value/SkipSpellsListValue.h\nsrc/Ai/Base/Value/SnareTargetValue.cpp\nsrc/Ai/Base/Value/SnareTargetValue.h\nsrc/Ai/Base/Value/SpellCastUsefulValue.cpp\nsrc/Ai/Base/Value/SpellCastUsefulValue.h\nsrc/Ai/Base/Value/SpellIdValue.cpp\nsrc/Ai/Base/Value/SpellIdValue.h\nsrc/Ai/Base/Value/Stances.cpp\nsrc/Ai/Base/Value/Stances.h\nsrc/Ai/Base/Value/StatsValues.cpp\nsrc/Ai/Base/Value/StatsValues.h\nsrc/Ai/Base/Value/TankTargetValue.cpp\nsrc/Ai/Base/Value/TankTargetValue.h\nsrc/Ai/Base/Value/TargetValue.cpp\nsrc/Ai/Base/Value/TargetValue.h\nsrc/Ai/Base/Value/ThreatValues.cpp\nsrc/Ai/Base/Value/ThreatValues.h\nsrc/Ai/Base/ValueContext.h\nsrc/Ai/Base/WorldPacketActionContext.h\nsrc/Ai/Base/WorldPacketTriggerContext.h\n</code></pre> src/Ai/Class/ (all files) <pre><code>src/Ai/Class/Dk/Action/DKActions.cpp\nsrc/Ai/Class/Dk/Action/DKActions.h\nsrc/Ai/Class/Dk/DKAiObjectContext.cpp\nsrc/Ai/Class/Dk/DKAiObjectContext.h\nsrc/Ai/Class/Dk/Strategy/BloodDKStrategy.cpp\nsrc/Ai/Class/Dk/Strategy/BloodDKStrategy.h\nsrc/Ai/Class/Dk/Strategy/FrostDKStrategy.cpp\nsrc/Ai/Class/Dk/Strategy/FrostDKStrategy.h\nsrc/Ai/Class/Dk/Strategy/GenericDKNonCombatStrategy.cpp\nsrc/Ai/Class/Dk/Strategy/GenericDKNonCombatStrategy.h\nsrc/Ai/Class/Dk/Strategy/GenericDKStrategy.cpp\nsrc/Ai/Class/Dk/Strategy/GenericDKStrategy.h\nsrc/Ai/Class/Dk/Strategy/UnholyDKStrategy.cpp\nsrc/Ai/Class/Dk/Strategy/UnholyDKStrategy.h\nsrc/Ai/Class/Dk/Trigger/DKTriggers.cpp\nsrc/Ai/Class/Dk/Trigger/DKTriggers.h\nsrc/Ai/Class/Druid/Action/DruidActions.cpp\nsrc/Ai/Class/Druid/Action/DruidActions.h\nsrc/Ai/Class/Druid/Action/DruidBearActions.cpp\nsrc/Ai/Class/Druid/Action/DruidBearActions.h\nsrc/Ai/Class/Druid/Action/DruidCatActions.cpp\nsrc/Ai/Class/Druid/Action/DruidCatActions.h\nsrc/Ai/Class/Druid/Action/DruidShapeshiftActions.cpp\nsrc/Ai/Class/Druid/Action/DruidShapeshiftActions.h\nsrc/Ai/Class/Druid/DruidAiObjectContext.cpp\nsrc/Ai/Class/Druid/DruidAiObjectContext.h\nsrc/Ai/Class/Druid/Strategy/BearTankDruidStrategy.cpp\nsrc/Ai/Class/Druid/Strategy/BearTankDruidStrategy.h\nsrc/Ai/Class/Druid/Strategy/CasterDruidStrategy.cpp\nsrc/Ai/Class/Druid/Strategy/CasterDruidStrategy.h\nsrc/Ai/Class/Druid/Strategy/CatDpsDruidStrategy.cpp\nsrc/Ai/Class/Druid/Strategy/CatDpsDruidStrategy.h\nsrc/Ai/Class/Druid/Strategy/FeralDruidStrategy.cpp\nsrc/Ai/Class/Druid/Strategy/FeralDruidStrategy.h\nsrc/Ai/Class/Druid/Strategy/GenericDruidNonCombatStrategy.cpp\nsrc/Ai/Class/Druid/Strategy/GenericDruidNonCombatStrategy.h\nsrc/Ai/Class/Druid/Strategy/GenericDruidStrategy.cpp\nsrc/Ai/Class/Druid/Strategy/GenericDruidStrategy.h\nsrc/Ai/Class/Druid/Strategy/HealDruidStrategy.cpp\nsrc/Ai/Class/Druid/Strategy/HealDruidStrategy.h\nsrc/Ai/Class/Druid/Strategy/MeleeDruidStrategy.cpp\nsrc/Ai/Class/Druid/Strategy/MeleeDruidStrategy.h\nsrc/Ai/Class/Druid/Strategy/OffhealDruidCatStrategy.cpp\nsrc/Ai/Class/Druid/Strategy/OffhealDruidCatStrategy.h\nsrc/Ai/Class/Druid/Trigger/DruidTriggers.cpp\nsrc/Ai/Class/Druid/Trigger/DruidTriggers.h\nsrc/Ai/Class/Hunter/Action/HunterActions.cpp\nsrc/Ai/Class/Hunter/Action/HunterActions.h\nsrc/Ai/Class/Hunter/HunterAiObjectContext.cpp\nsrc/Ai/Class/Hunter/HunterAiObjectContext.h\nsrc/Ai/Class/Hunter/Strategy/BeastMasteryHunterStrategy.cpp\nsrc/Ai/Class/Hunter/Strategy/BeastMasteryHunterStrategy.h\nsrc/Ai/Class/Hunter/Strategy/GenericHunterNonCombatStrategy.cpp\nsrc/Ai/Class/Hunter/Strategy/GenericHunterNonCombatStrategy.h\nsrc/Ai/Class/Hunter/Strategy/GenericHunterStrategy.cpp\nsrc/Ai/Class/Hunter/Strategy/GenericHunterStrategy.h\nsrc/Ai/Class/Hunter/Strategy/HunterBuffStrategies.cpp\nsrc/Ai/Class/Hunter/Strategy/HunterBuffStrategies.h\nsrc/Ai/Class/Hunter/Strategy/MarksmanshipHunterStrategy.cpp\nsrc/Ai/Class/Hunter/Strategy/MarksmanshipHunterStrategy.h\nsrc/Ai/Class/Hunter/Strategy/SurvivalHunterStrategy.cpp\nsrc/Ai/Class/Hunter/Strategy/SurvivalHunterStrategy.h\nsrc/Ai/Class/Hunter/Trigger/HunterTriggers.cpp\nsrc/Ai/Class/Hunter/Trigger/HunterTriggers.h\nsrc/Ai/Class/Mage/Action/MageActions.cpp\nsrc/Ai/Class/Mage/Action/MageActions.h\nsrc/Ai/Class/Mage/MageAiObjectContext.cpp\nsrc/Ai/Class/Mage/MageAiObjectContext.h\nsrc/Ai/Class/Mage/Strategy/ArcaneMageStrategy.cpp\nsrc/Ai/Class/Mage/Strategy/ArcaneMageStrategy.h\nsrc/Ai/Class/Mage/Strategy/FireMageStrategy.cpp\nsrc/Ai/Class/Mage/Strategy/FireMageStrategy.h\nsrc/Ai/Class/Mage/Strategy/FrostFireMageStrategy.cpp\nsrc/Ai/Class/Mage/Strategy/FrostFireMageStrategy.h\nsrc/Ai/Class/Mage/Strategy/FrostMageStrategy.cpp\nsrc/Ai/Class/Mage/Strategy/FrostMageStrategy.h\nsrc/Ai/Class/Mage/Strategy/GenericMageNonCombatStrategy.cpp\nsrc/Ai/Class/Mage/Strategy/GenericMageNonCombatStrategy.h\nsrc/Ai/Class/Mage/Strategy/GenericMageStrategy.cpp\nsrc/Ai/Class/Mage/Strategy/GenericMageStrategy.h\nsrc/Ai/Class/Mage/Trigger/MageTriggers.cpp\nsrc/Ai/Class/Mage/Trigger/MageTriggers.h\nsrc/Ai/Class/Paladin/Action/PaladinActions.cpp\nsrc/Ai/Class/Paladin/Action/PaladinActions.h\nsrc/Ai/Class/Paladin/PaladinAiObjectContext.cpp\nsrc/Ai/Class/Paladin/PaladinAiObjectContext.h\nsrc/Ai/Class/Paladin/Strategy/DpsPaladinStrategy.cpp\nsrc/Ai/Class/Paladin/Strategy/DpsPaladinStrategy.h\nsrc/Ai/Class/Paladin/Strategy/GenericPaladinNonCombatStrategy.cpp\nsrc/Ai/Class/Paladin/Strategy/GenericPaladinNonCombatStrategy.h\nsrc/Ai/Class/Paladin/Strategy/GenericPaladinStrategy.cpp\nsrc/Ai/Class/Paladin/Strategy/GenericPaladinStrategy.h\nsrc/Ai/Class/Paladin/Strategy/GenericPaladinStrategyActionNodeFactory.h\nsrc/Ai/Class/Paladin/Strategy/HealPaladinStrategy.cpp\nsrc/Ai/Class/Paladin/Strategy/HealPaladinStrategy.h\nsrc/Ai/Class/Paladin/Strategy/OffhealRetPaladinStrategy.cpp\nsrc/Ai/Class/Paladin/Strategy/OffhealRetPaladinStrategy.h\nsrc/Ai/Class/Paladin/Strategy/PaladinBuffStrategies.cpp\nsrc/Ai/Class/Paladin/Strategy/PaladinBuffStrategies.h\nsrc/Ai/Class/Paladin/Strategy/TankPaladinStrategy.cpp\nsrc/Ai/Class/Paladin/Strategy/TankPaladinStrategy.h\nsrc/Ai/Class/Paladin/Trigger/PaladinTriggers.cpp\nsrc/Ai/Class/Paladin/Trigger/PaladinTriggers.h\nsrc/Ai/Class/Priest/Action/PriestActions.cpp\nsrc/Ai/Class/Priest/Action/PriestActions.h\nsrc/Ai/Class/Priest/PriestAiObjectContext.cpp\nsrc/Ai/Class/Priest/PriestAiObjectContext.h\nsrc/Ai/Class/Priest/Strategy/GenericPriestStrategy.cpp\nsrc/Ai/Class/Priest/Strategy/GenericPriestStrategy.h\nsrc/Ai/Class/Priest/Strategy/GenericPriestStrategyActionNodeFactory.h\nsrc/Ai/Class/Priest/Strategy/HealPriestStrategy.cpp\nsrc/Ai/Class/Priest/Strategy/HealPriestStrategy.h\nsrc/Ai/Class/Priest/Strategy/HolyPriestStrategy.cpp\nsrc/Ai/Class/Priest/Strategy/HolyPriestStrategy.h\nsrc/Ai/Class/Priest/Strategy/PriestNonCombatStrategy.cpp\nsrc/Ai/Class/Priest/Strategy/PriestNonCombatStrategy.h\nsrc/Ai/Class/Priest/Strategy/PriestNonCombatStrategyActionNodeFactory.h\nsrc/Ai/Class/Priest/Strategy/ShadowPriestStrategy.cpp\nsrc/Ai/Class/Priest/Strategy/ShadowPriestStrategy.h\nsrc/Ai/Class/Priest/Strategy/ShadowPriestStrategyActionNodeFactory.h\nsrc/Ai/Class/Priest/Trigger/PriestTriggers.cpp\nsrc/Ai/Class/Priest/Trigger/PriestTriggers.h\nsrc/Ai/Class/Rogue/Action/RogueActions.cpp\nsrc/Ai/Class/Rogue/Action/RogueActions.h\nsrc/Ai/Class/Rogue/Action/RogueComboActions.cpp\nsrc/Ai/Class/Rogue/Action/RogueComboActions.h\nsrc/Ai/Class/Rogue/Action/RogueFinishingActions.h\nsrc/Ai/Class/Rogue/Action/RogueOpeningActions.cpp\nsrc/Ai/Class/Rogue/Action/RogueOpeningActions.h\nsrc/Ai/Class/Rogue/RogueAiObjectContext.cpp\nsrc/Ai/Class/Rogue/RogueAiObjectContext.h\nsrc/Ai/Class/Rogue/Strategy/AssassinationRogueStrategy.cpp\nsrc/Ai/Class/Rogue/Strategy/AssassinationRogueStrategy.h\nsrc/Ai/Class/Rogue/Strategy/DpsRogueStrategy.cpp\nsrc/Ai/Class/Rogue/Strategy/DpsRogueStrategy.h\nsrc/Ai/Class/Rogue/Strategy/GenericRogueNonCombatStrategy.cpp\nsrc/Ai/Class/Rogue/Strategy/GenericRogueNonCombatStrategy.h\nsrc/Ai/Class/Rogue/Trigger/RogueTriggers.cpp\nsrc/Ai/Class/Rogue/Trigger/RogueTriggers.h\nsrc/Ai/Class/Shaman/Action/ShamanActions.cpp\nsrc/Ai/Class/Shaman/Action/ShamanActions.h\nsrc/Ai/Class/Shaman/ShamanAiObjectContext.cpp\nsrc/Ai/Class/Shaman/ShamanAiObjectContext.h\nsrc/Ai/Class/Shaman/Strategy/ElementalShamanStrategy.cpp\nsrc/Ai/Class/Shaman/Strategy/ElementalShamanStrategy.h\nsrc/Ai/Class/Shaman/Strategy/EnhancementShamanStrategy.cpp\nsrc/Ai/Class/Shaman/Strategy/EnhancementShamanStrategy.h\nsrc/Ai/Class/Shaman/Strategy/GenericShamanStrategy.cpp\nsrc/Ai/Class/Shaman/Strategy/GenericShamanStrategy.h\nsrc/Ai/Class/Shaman/Strategy/RestoShamanStrategy.cpp\nsrc/Ai/Class/Shaman/Strategy/RestoShamanStrategy.h\nsrc/Ai/Class/Shaman/Strategy/ShamanNonCombatStrategy.cpp\nsrc/Ai/Class/Shaman/Strategy/ShamanNonCombatStrategy.h\nsrc/Ai/Class/Shaman/Strategy/TotemsShamanStrategy.cpp\nsrc/Ai/Class/Shaman/Strategy/TotemsShamanStrategy.h\nsrc/Ai/Class/Shaman/Trigger/ShamanTriggers.cpp\nsrc/Ai/Class/Shaman/Trigger/ShamanTriggers.h\nsrc/Ai/Class/Warlock/Action/WarlockActions.cpp\nsrc/Ai/Class/Warlock/Action/WarlockActions.h\nsrc/Ai/Class/Warlock/Strategy/AfflictionWarlockStrategy.cpp\nsrc/Ai/Class/Warlock/Strategy/AfflictionWarlockStrategy.h\nsrc/Ai/Class/Warlock/Strategy/DemonologyWarlockStrategy.cpp\nsrc/Ai/Class/Warlock/Strategy/DemonologyWarlockStrategy.h\nsrc/Ai/Class/Warlock/Strategy/DestructionWarlockStrategy.cpp\nsrc/Ai/Class/Warlock/Strategy/DestructionWarlockStrategy.h\nsrc/Ai/Class/Warlock/Strategy/GenericWarlockNonCombatStrategy.cpp\nsrc/Ai/Class/Warlock/Strategy/GenericWarlockNonCombatStrategy.h\nsrc/Ai/Class/Warlock/Strategy/GenericWarlockStrategy.cpp\nsrc/Ai/Class/Warlock/Strategy/GenericWarlockStrategy.h\nsrc/Ai/Class/Warlock/Strategy/TankWarlockStrategy.cpp\nsrc/Ai/Class/Warlock/Strategy/TankWarlockStrategy.h\nsrc/Ai/Class/Warlock/Trigger/WarlockTriggers.cpp\nsrc/Ai/Class/Warlock/Trigger/WarlockTriggers.h\nsrc/Ai/Class/Warlock/WarlockAiObjectContext.cpp\nsrc/Ai/Class/Warlock/WarlockAiObjectContext.h\nsrc/Ai/Class/Warrior/Action/WarriorActions.cpp\nsrc/Ai/Class/Warrior/Action/WarriorActions.h\nsrc/Ai/Class/Warrior/Strategy/ArmsWarriorStrategy.cpp\nsrc/Ai/Class/Warrior/Strategy/ArmsWarriorStrategy.h\nsrc/Ai/Class/Warrior/Strategy/FuryWarriorStrategy.cpp\nsrc/Ai/Class/Warrior/Strategy/FuryWarriorStrategy.h\nsrc/Ai/Class/Warrior/Strategy/GenericWarriorNonCombatStrategy.cpp\nsrc/Ai/Class/Warrior/Strategy/GenericWarriorNonCombatStrategy.h\nsrc/Ai/Class/Warrior/Strategy/GenericWarriorStrategy.cpp\nsrc/Ai/Class/Warrior/Strategy/GenericWarriorStrategy.h\nsrc/Ai/Class/Warrior/Strategy/TankWarriorStrategy.cpp\nsrc/Ai/Class/Warrior/Strategy/TankWarriorStrategy.h\nsrc/Ai/Class/Warrior/Trigger/WarriorTriggers.cpp\nsrc/Ai/Class/Warrior/Trigger/WarriorTriggers.h\nsrc/Ai/Class/Warrior/WarriorAiObjectContext.cpp\nsrc/Ai/Class/Warrior/WarriorAiObjectContext.h\n</code></pre> src/Ai/Dungeon/ (all files) <pre><code>src/Ai/Dungeon/AzjolNerub/Action/AzjolNerubActions.cpp\nsrc/Ai/Dungeon/AzjolNerub/Action/AzjolNerubActions.h\nsrc/Ai/Dungeon/AzjolNerub/AzjolNerubActionContext.h\nsrc/Ai/Dungeon/AzjolNerub/AzjolNerubTriggerContext.h\nsrc/Ai/Dungeon/AzjolNerub/Multiplier/AzjolNerubMultipliers.cpp\nsrc/Ai/Dungeon/AzjolNerub/Multiplier/AzjolNerubMultipliers.h\nsrc/Ai/Dungeon/AzjolNerub/Strategy/AzjolNerubStrategy.cpp\nsrc/Ai/Dungeon/AzjolNerub/Strategy/AzjolNerubStrategy.h\nsrc/Ai/Dungeon/AzjolNerub/Trigger/AzjolNerubTriggers.cpp\nsrc/Ai/Dungeon/AzjolNerub/Trigger/AzjolNerubTriggers.h\nsrc/Ai/Dungeon/CullingOfStratholme/Action/CullingOfStratholmeActions.cpp\nsrc/Ai/Dungeon/CullingOfStratholme/Action/CullingOfStratholmeActions.h\nsrc/Ai/Dungeon/CullingOfStratholme/CullingOfStratholmeActionContext.h\nsrc/Ai/Dungeon/CullingOfStratholme/CullingOfStratholmeTriggerContext.h\nsrc/Ai/Dungeon/CullingOfStratholme/Multiplier/CullingOfStratholmeMultipliers.cpp\nsrc/Ai/Dungeon/CullingOfStratholme/Multiplier/CullingOfStratholmeMultipliers.h\nsrc/Ai/Dungeon/CullingOfStratholme/Strategy/CullingOfStratholmeStrategy.cpp\nsrc/Ai/Dungeon/CullingOfStratholme/Strategy/CullingOfStratholmeStrategy.h\nsrc/Ai/Dungeon/CullingOfStratholme/Trigger/CullingOfStratholmeTriggers.cpp\nsrc/Ai/Dungeon/CullingOfStratholme/Trigger/CullingOfStratholmeTriggers.h\nsrc/Ai/Dungeon/DraktharonKeep/Action/DrakTharonKeepActions.cpp\nsrc/Ai/Dungeon/DraktharonKeep/Action/DrakTharonKeepActions.h\nsrc/Ai/Dungeon/DraktharonKeep/DrakTharonKeepActionContext.h\nsrc/Ai/Dungeon/DraktharonKeep/DrakTharonKeepTriggerContext.h\nsrc/Ai/Dungeon/DraktharonKeep/Multiplier/DrakTharonKeepMultipliers.cpp\nsrc/Ai/Dungeon/DraktharonKeep/Multiplier/DrakTharonKeepMultipliers.h\nsrc/Ai/Dungeon/DraktharonKeep/Strategy/DrakTharonKeepStrategy.cpp\nsrc/Ai/Dungeon/DraktharonKeep/Strategy/DrakTharonKeepStrategy.h\nsrc/Ai/Dungeon/DraktharonKeep/Trigger/DrakTharonKeepTriggers.cpp\nsrc/Ai/Dungeon/DraktharonKeep/Trigger/DrakTharonKeepTriggers.h\nsrc/Ai/Dungeon/DungeonStrategyContext.h\nsrc/Ai/Dungeon/DungeonStrategyUtils.h\nsrc/Ai/Dungeon/ForgeOfSouls/Action/ForgeOfSoulsActions.cpp\nsrc/Ai/Dungeon/ForgeOfSouls/Action/ForgeOfSoulsActions.h\nsrc/Ai/Dungeon/ForgeOfSouls/ForgeOfSoulsActionContext.h\nsrc/Ai/Dungeon/ForgeOfSouls/ForgeOfSoulsTriggerContext.h\nsrc/Ai/Dungeon/ForgeOfSouls/Multiplier/ForgeOfSoulsMultipliers.cpp\nsrc/Ai/Dungeon/ForgeOfSouls/Multiplier/ForgeOfSoulsMultipliers.h\nsrc/Ai/Dungeon/ForgeOfSouls/Strategy/ForgeOfSoulsStrategy.cpp\nsrc/Ai/Dungeon/ForgeOfSouls/Strategy/ForgeOfSoulsStrategy.h\nsrc/Ai/Dungeon/ForgeOfSouls/Trigger/ForgeOfSoulsTriggers.cpp\nsrc/Ai/Dungeon/ForgeOfSouls/Trigger/ForgeOfSoulsTriggers.h\nsrc/Ai/Dungeon/Gundrak/Action/GundrakActions.cpp\nsrc/Ai/Dungeon/Gundrak/Action/GundrakActions.h\nsrc/Ai/Dungeon/Gundrak/GundrakActionContext.h\nsrc/Ai/Dungeon/Gundrak/GundrakTriggerContext.h\nsrc/Ai/Dungeon/Gundrak/Multiplier/GundrakMultipliers.cpp\nsrc/Ai/Dungeon/Gundrak/Multiplier/GundrakMultipliers.h\nsrc/Ai/Dungeon/Gundrak/Strategy/GundrakStrategy.cpp\nsrc/Ai/Dungeon/Gundrak/Strategy/GundrakStrategy.h\nsrc/Ai/Dungeon/Gundrak/Trigger/GundrakTriggers.cpp\nsrc/Ai/Dungeon/Gundrak/Trigger/GundrakTriggers.h\nsrc/Ai/Dungeon/HallsOfLightning/Action/HallsOfLightningActions.cpp\nsrc/Ai/Dungeon/HallsOfLightning/Action/HallsOfLightningActions.h\nsrc/Ai/Dungeon/HallsOfLightning/HallsOfLightningActionContext.h\nsrc/Ai/Dungeon/HallsOfLightning/HallsOfLightningTriggerContext.h\nsrc/Ai/Dungeon/HallsOfLightning/Multiplier/HallsOfLightningMultipliers.cpp\nsrc/Ai/Dungeon/HallsOfLightning/Multiplier/HallsOfLightningMultipliers.h\nsrc/Ai/Dungeon/HallsOfLightning/Strategy/HallsOfLightningStrategy.cpp\nsrc/Ai/Dungeon/HallsOfLightning/Strategy/HallsOfLightningStrategy.h\nsrc/Ai/Dungeon/HallsOfLightning/Trigger/HallsOfLightningTriggers.cpp\nsrc/Ai/Dungeon/HallsOfLightning/Trigger/HallsOfLightningTriggers.h\nsrc/Ai/Dungeon/HallsOfReflection/TODO\nsrc/Ai/Dungeon/HallsOfStone/Action/HallsOfStoneActions.cpp\nsrc/Ai/Dungeon/HallsOfStone/Action/HallsOfStoneActions.h\nsrc/Ai/Dungeon/HallsOfStone/HallsOfStoneActionContext.h\nsrc/Ai/Dungeon/HallsOfStone/HallsOfStoneTriggerContext.h\nsrc/Ai/Dungeon/HallsOfStone/Multiplier/HallsOfStoneMultipliers.cpp\nsrc/Ai/Dungeon/HallsOfStone/Multiplier/HallsOfStoneMultipliers.h\nsrc/Ai/Dungeon/HallsOfStone/Strategy/HallsOfStoneStrategy.cpp\nsrc/Ai/Dungeon/HallsOfStone/Strategy/HallsOfStoneStrategy.h\nsrc/Ai/Dungeon/HallsOfStone/Trigger/HallsOfStoneTriggers.cpp\nsrc/Ai/Dungeon/HallsOfStone/Trigger/HallsOfStoneTriggers.h\nsrc/Ai/Dungeon/Nexus/Action/NexusActions.cpp\nsrc/Ai/Dungeon/Nexus/Action/NexusActions.h\nsrc/Ai/Dungeon/Nexus/Multiplier/NexusMultipliers.cpp\nsrc/Ai/Dungeon/Nexus/Multiplier/NexusMultipliers.h\nsrc/Ai/Dungeon/Nexus/NexusActionContext.h\nsrc/Ai/Dungeon/Nexus/NexusTriggerContext.h\nsrc/Ai/Dungeon/Nexus/Strategy/NexusStrategy.cpp\nsrc/Ai/Dungeon/Nexus/Strategy/NexusStrategy.h\nsrc/Ai/Dungeon/Nexus/Trigger/NexusTriggers.cpp\nsrc/Ai/Dungeon/Nexus/Trigger/NexusTriggers.h\nsrc/Ai/Dungeon/Oculus/Action/OculusActions.cpp\nsrc/Ai/Dungeon/Oculus/Action/OculusActions.h\nsrc/Ai/Dungeon/Oculus/Multiplier/OculusMultipliers.cpp\nsrc/Ai/Dungeon/Oculus/Multiplier/OculusMultipliers.h\nsrc/Ai/Dungeon/Oculus/OculusActionContext.h\nsrc/Ai/Dungeon/Oculus/OculusTriggerContext.h\nsrc/Ai/Dungeon/Oculus/Strategy/OculusStrategy.cpp\nsrc/Ai/Dungeon/Oculus/Strategy/OculusStrategy.h\nsrc/Ai/Dungeon/Oculus/Trigger/OculusTriggers.cpp\nsrc/Ai/Dungeon/Oculus/Trigger/OculusTriggers.h\nsrc/Ai/Dungeon/OldKingdom/Action/OldKingdomActions.cpp\nsrc/Ai/Dungeon/OldKingdom/Action/OldKingdomActions.h\nsrc/Ai/Dungeon/OldKingdom/Multiplier/OldKingdomMultipliers.cpp\nsrc/Ai/Dungeon/OldKingdom/Multiplier/OldKingdomMultipliers.h\nsrc/Ai/Dungeon/OldKingdom/OldKingdomActionContext.h\nsrc/Ai/Dungeon/OldKingdom/OldKingdomTriggerContext.h\nsrc/Ai/Dungeon/OldKingdom/Strategy/OldKingdomStrategy.cpp\nsrc/Ai/Dungeon/OldKingdom/Strategy/OldKingdomStrategy.h\nsrc/Ai/Dungeon/OldKingdom/Trigger/OldKingdomTriggers.cpp\nsrc/Ai/Dungeon/OldKingdom/Trigger/OldKingdomTriggers.h\nsrc/Ai/Dungeon/PitOfSaron/Action/PitOfSaronActions.cpp\nsrc/Ai/Dungeon/PitOfSaron/Action/PitOfSaronActions.h\nsrc/Ai/Dungeon/PitOfSaron/Multiplier/PitOfSaronMultipliers.cpp\nsrc/Ai/Dungeon/PitOfSaron/Multiplier/PitOfSaronMultipliers.h\nsrc/Ai/Dungeon/PitOfSaron/PitOfSaronActionContext.h\nsrc/Ai/Dungeon/PitOfSaron/PitOfSaronTriggerContext.h\nsrc/Ai/Dungeon/PitOfSaron/Strategy/PitOfSaronStrategy.cpp\nsrc/Ai/Dungeon/PitOfSaron/Strategy/PitOfSaronStrategy.h\nsrc/Ai/Dungeon/PitOfSaron/Trigger/PitOfSaronTriggers.cpp\nsrc/Ai/Dungeon/PitOfSaron/Trigger/PitOfSaronTriggers.h\nsrc/Ai/Dungeon/TrialOfTheChampion/Action/TrialOfTheChampionActions.cpp\nsrc/Ai/Dungeon/TrialOfTheChampion/Action/TrialOfTheChampionActions.h\nsrc/Ai/Dungeon/TrialOfTheChampion/Multiplier/TrialOfTheChampionMultipliers.cpp\nsrc/Ai/Dungeon/TrialOfTheChampion/Multiplier/TrialOfTheChampionMultipliers.h\nsrc/Ai/Dungeon/TrialOfTheChampion/Strategy/TrialOfTheChampionStrategy.cpp\nsrc/Ai/Dungeon/TrialOfTheChampion/Strategy/TrialOfTheChampionStrategy.h\nsrc/Ai/Dungeon/TrialOfTheChampion/TrialOfTheChampionActionContext.h\nsrc/Ai/Dungeon/TrialOfTheChampion/TrialOfTheChampionTriggerContext.h\nsrc/Ai/Dungeon/TrialOfTheChampion/Trigger/TrialOfTheChampionTriggers.cpp\nsrc/Ai/Dungeon/TrialOfTheChampion/Trigger/TrialOfTheChampionTriggers.h\nsrc/Ai/Dungeon/UtgardeKeep/Action/UtgardeKeepActions.cpp\nsrc/Ai/Dungeon/UtgardeKeep/Action/UtgardeKeepActions.h\nsrc/Ai/Dungeon/UtgardeKeep/Multiplier/UtgardeKeepMultipliers.cpp\nsrc/Ai/Dungeon/UtgardeKeep/Multiplier/UtgardeKeepMultipliers.h\nsrc/Ai/Dungeon/UtgardeKeep/Strategy/UtgardeKeepStrategy.cpp\nsrc/Ai/Dungeon/UtgardeKeep/Strategy/UtgardeKeepStrategy.h\nsrc/Ai/Dungeon/UtgardeKeep/Trigger/UtgardeKeepTriggers.cpp\nsrc/Ai/Dungeon/UtgardeKeep/Trigger/UtgardeKeepTriggers.h\nsrc/Ai/Dungeon/UtgardeKeep/UtgardeKeepActionContext.h\nsrc/Ai/Dungeon/UtgardeKeep/UtgardeKeepTriggerContext.h\nsrc/Ai/Dungeon/UtgardePinnacle/Action/UtgardePinnacleActions.cpp\nsrc/Ai/Dungeon/UtgardePinnacle/Action/UtgardePinnacleActions.h\nsrc/Ai/Dungeon/UtgardePinnacle/Multiplier/UtgardePinnacleMultipliers.cpp\nsrc/Ai/Dungeon/UtgardePinnacle/Multiplier/UtgardePinnacleMultipliers.h\nsrc/Ai/Dungeon/UtgardePinnacle/Strategy/UtgardePinnacleStrategy.cpp\nsrc/Ai/Dungeon/UtgardePinnacle/Strategy/UtgardePinnacleStrategy.h\nsrc/Ai/Dungeon/UtgardePinnacle/Trigger/UtgardePinnacleTriggers.cpp\nsrc/Ai/Dungeon/UtgardePinnacle/Trigger/UtgardePinnacleTriggers.h\nsrc/Ai/Dungeon/UtgardePinnacle/UtgardePinnacleActionContext.h\nsrc/Ai/Dungeon/UtgardePinnacle/UtgardePinnacleTriggerContext.h\nsrc/Ai/Dungeon/VioletHold/Action/VioletHoldActions.cpp\nsrc/Ai/Dungeon/VioletHold/Action/VioletHoldActions.h\nsrc/Ai/Dungeon/VioletHold/Multiplier/VioletHoldMultipliers.cpp\nsrc/Ai/Dungeon/VioletHold/Multiplier/VioletHoldMultipliers.h\nsrc/Ai/Dungeon/VioletHold/Strategy/VioletHoldStrategy.cpp\nsrc/Ai/Dungeon/VioletHold/Strategy/VioletHoldStrategy.h\nsrc/Ai/Dungeon/VioletHold/Trigger/VioletHoldTriggers.cpp\nsrc/Ai/Dungeon/VioletHold/Trigger/VioletHoldTriggers.h\nsrc/Ai/Dungeon/VioletHold/VioletHoldActionContext.h\nsrc/Ai/Dungeon/VioletHold/VioletHoldTriggerContext.h\nsrc/Ai/Dungeon/WotlkDungeonActionContext.h\nsrc/Ai/Dungeon/WotlkDungeonTriggerContext.h\n</code></pre> src/Ai/Raid/ (all files) <pre><code>src/Ai/Raid/Aq20/Action/RaidAq20Actions.cpp\nsrc/Ai/Raid/Aq20/Action/RaidAq20Actions.h\nsrc/Ai/Raid/Aq20/RaidAq20ActionContext.h\nsrc/Ai/Raid/Aq20/RaidAq20TriggerContext.h\nsrc/Ai/Raid/Aq20/Strategy/RaidAq20Strategy.cpp\nsrc/Ai/Raid/Aq20/Strategy/RaidAq20Strategy.h\nsrc/Ai/Raid/Aq20/Trigger/RaidAq20Triggers.cpp\nsrc/Ai/Raid/Aq20/Trigger/RaidAq20Triggers.h\nsrc/Ai/Raid/Aq20/Util/RaidAq20Utils.cpp\nsrc/Ai/Raid/Aq20/Util/RaidAq20Utils.h\nsrc/Ai/Raid/BlackwingLair/Action/RaidBwlActions.cpp\nsrc/Ai/Raid/BlackwingLair/Action/RaidBwlActions.h\nsrc/Ai/Raid/BlackwingLair/RaidBwlActionContext.h\nsrc/Ai/Raid/BlackwingLair/RaidBwlTriggerContext.h\nsrc/Ai/Raid/BlackwingLair/Strategy/RaidBwlStrategy.cpp\nsrc/Ai/Raid/BlackwingLair/Strategy/RaidBwlStrategy.h\nsrc/Ai/Raid/BlackwingLair/Trigger/RaidBwlTriggers.cpp\nsrc/Ai/Raid/BlackwingLair/Trigger/RaidBwlTriggers.h\nsrc/Ai/Raid/EyeOfEternity/Action/RaidEoEActions.cpp\nsrc/Ai/Raid/EyeOfEternity/Action/RaidEoEActions.h\nsrc/Ai/Raid/EyeOfEternity/Multiplier/RaidEoEMultipliers.cpp\nsrc/Ai/Raid/EyeOfEternity/Multiplier/RaidEoEMultipliers.h\nsrc/Ai/Raid/EyeOfEternity/RaidEoEActionContext.h\nsrc/Ai/Raid/EyeOfEternity/RaidEoETriggerContext.h\nsrc/Ai/Raid/EyeOfEternity/Strategy/RaidEoEStrategy.cpp\nsrc/Ai/Raid/EyeOfEternity/Strategy/RaidEoEStrategy.h\nsrc/Ai/Raid/EyeOfEternity/Trigger/RaidEoETriggers.cpp\nsrc/Ai/Raid/EyeOfEternity/Trigger/RaidEoETriggers.h\nsrc/Ai/Raid/GruulsLair/Action/RaidGruulsLairActions.cpp\nsrc/Ai/Raid/GruulsLair/Action/RaidGruulsLairActions.h\nsrc/Ai/Raid/GruulsLair/Multiplier/RaidGruulsLairMultipliers.cpp\nsrc/Ai/Raid/GruulsLair/Multiplier/RaidGruulsLairMultipliers.h\nsrc/Ai/Raid/GruulsLair/RaidGruulsLairActionContext.h\nsrc/Ai/Raid/GruulsLair/RaidGruulsLairTriggerContext.h\nsrc/Ai/Raid/GruulsLair/Strategy/RaidGruulsLairStrategy.cpp\nsrc/Ai/Raid/GruulsLair/Strategy/RaidGruulsLairStrategy.h\nsrc/Ai/Raid/GruulsLair/Trigger/RaidGruulsLairTriggers.cpp\nsrc/Ai/Raid/GruulsLair/Trigger/RaidGruulsLairTriggers.h\nsrc/Ai/Raid/GruulsLair/Util/RaidGruulsLairHelpers.cpp\nsrc/Ai/Raid/GruulsLair/Util/RaidGruulsLairHelpers.h\nsrc/Ai/Raid/Icecrown/Action/RaidIccActions.cpp\nsrc/Ai/Raid/Icecrown/Action/RaidIccActions.h\nsrc/Ai/Raid/Icecrown/Multiplier/RaidIccMultipliers.cpp\nsrc/Ai/Raid/Icecrown/Multiplier/RaidIccMultipliers.h\nsrc/Ai/Raid/Icecrown/RaidIccActionContext.h\nsrc/Ai/Raid/Icecrown/RaidIccScripts.h\nsrc/Ai/Raid/Icecrown/RaidIccTriggerContext.h\nsrc/Ai/Raid/Icecrown/Strategy/RaidIccStrategy.cpp\nsrc/Ai/Raid/Icecrown/Strategy/RaidIccStrategy.h\nsrc/Ai/Raid/Icecrown/Trigger/RaidIccTriggers.cpp\nsrc/Ai/Raid/Icecrown/Trigger/RaidIccTriggers.h\nsrc/Ai/Raid/Karazhan/Action/RaidKarazhanActions.cpp\nsrc/Ai/Raid/Karazhan/Action/RaidKarazhanActions.h\nsrc/Ai/Raid/Karazhan/Multiplier/RaidKarazhanMultipliers.cpp\nsrc/Ai/Raid/Karazhan/Multiplier/RaidKarazhanMultipliers.h\nsrc/Ai/Raid/Karazhan/RaidKarazhanActionContext.h\nsrc/Ai/Raid/Karazhan/RaidKarazhanTriggerContext.h\nsrc/Ai/Raid/Karazhan/Strategy/RaidKarazhanStrategy.cpp\nsrc/Ai/Raid/Karazhan/Strategy/RaidKarazhanStrategy.h\nsrc/Ai/Raid/Karazhan/Trigger/RaidKarazhanTriggers.cpp\nsrc/Ai/Raid/Karazhan/Trigger/RaidKarazhanTriggers.h\nsrc/Ai/Raid/Karazhan/Util/RaidKarazhanHelpers.cpp\nsrc/Ai/Raid/Karazhan/Util/RaidKarazhanHelpers.h\nsrc/Ai/Raid/Magtheridon/Action/RaidMagtheridonActions.cpp\nsrc/Ai/Raid/Magtheridon/Action/RaidMagtheridonActions.h\nsrc/Ai/Raid/Magtheridon/Multiplier/RaidMagtheridonMultipliers.cpp\nsrc/Ai/Raid/Magtheridon/Multiplier/RaidMagtheridonMultipliers.h\nsrc/Ai/Raid/Magtheridon/RaidMagtheridonActionContext.h\nsrc/Ai/Raid/Magtheridon/RaidMagtheridonTriggerContext.h\nsrc/Ai/Raid/Magtheridon/Strategy/RaidMagtheridonStrategy.cpp\nsrc/Ai/Raid/Magtheridon/Strategy/RaidMagtheridonStrategy.h\nsrc/Ai/Raid/Magtheridon/Trigger/RaidMagtheridonTriggers.cpp\nsrc/Ai/Raid/Magtheridon/Trigger/RaidMagtheridonTriggers.h\nsrc/Ai/Raid/Magtheridon/Util/RaidMagtheridonHelpers.cpp\nsrc/Ai/Raid/Magtheridon/Util/RaidMagtheridonHelpers.h\nsrc/Ai/Raid/MoltenCore/Action/RaidMcActions.cpp\nsrc/Ai/Raid/MoltenCore/Action/RaidMcActions.h\nsrc/Ai/Raid/MoltenCore/Multiplier/RaidMcMultipliers.cpp\nsrc/Ai/Raid/MoltenCore/Multiplier/RaidMcMultipliers.h\nsrc/Ai/Raid/MoltenCore/RaidMcActionContext.h\nsrc/Ai/Raid/MoltenCore/RaidMcHelpers.h\nsrc/Ai/Raid/MoltenCore/RaidMcTriggerContext.h\nsrc/Ai/Raid/MoltenCore/Strategy/RaidMcStrategy.cpp\nsrc/Ai/Raid/MoltenCore/Strategy/RaidMcStrategy.h\nsrc/Ai/Raid/MoltenCore/Trigger/RaidMcTriggers.cpp\nsrc/Ai/Raid/MoltenCore/Trigger/RaidMcTriggers.h\nsrc/Ai/Raid/ObsidianSanctum/Action/RaidOsActions.cpp\nsrc/Ai/Raid/ObsidianSanctum/Action/RaidOsActions.h\nsrc/Ai/Raid/ObsidianSanctum/Multiplier/RaidOsMultipliers.cpp\nsrc/Ai/Raid/ObsidianSanctum/Multiplier/RaidOsMultipliers.h\nsrc/Ai/Raid/ObsidianSanctum/RaidOsActionContext.h\nsrc/Ai/Raid/ObsidianSanctum/RaidOsTriggerContext.h\nsrc/Ai/Raid/ObsidianSanctum/Strategy/RaidOsStrategy.cpp\nsrc/Ai/Raid/ObsidianSanctum/Strategy/RaidOsStrategy.h\nsrc/Ai/Raid/ObsidianSanctum/Trigger/RaidOsTriggers.cpp\nsrc/Ai/Raid/ObsidianSanctum/Trigger/RaidOsTriggers.h\nsrc/Ai/Raid/Onyxia/Action/RaidOnyxiaActions.cpp\nsrc/Ai/Raid/Onyxia/Action/RaidOnyxiaActions.h\nsrc/Ai/Raid/Onyxia/RaidOnyxiaActionContext.h\nsrc/Ai/Raid/Onyxia/RaidOnyxiaTriggerContext.h\nsrc/Ai/Raid/Onyxia/Strategy/RaidOnyxiaStrategy.cpp\nsrc/Ai/Raid/Onyxia/Strategy/RaidOnyxiaStrategy.h\nsrc/Ai/Raid/Onyxia/Trigger/RaidOnyxiaTriggers.cpp\nsrc/Ai/Raid/Onyxia/Trigger/RaidOnyxiaTriggers.h\nsrc/Ai/Raid/RaidStrategyContext.h\nsrc/Ai/Raid/Ulduar/Action/RaidUlduarActions.cpp\nsrc/Ai/Raid/Ulduar/Action/RaidUlduarActions.h\nsrc/Ai/Raid/Ulduar/Multiplier/RaidUlduarMultipliers.cpp\nsrc/Ai/Raid/Ulduar/Multiplier/RaidUlduarMultipliers.h\nsrc/Ai/Raid/Ulduar/RaidUlduarActionContext.h\nsrc/Ai/Raid/Ulduar/RaidUlduarBossHelper.cpp\nsrc/Ai/Raid/Ulduar/RaidUlduarBossHelper.h\nsrc/Ai/Raid/Ulduar/RaidUlduarScripts.h\nsrc/Ai/Raid/Ulduar/RaidUlduarTriggerContext.h\nsrc/Ai/Raid/Ulduar/Strategy/RaidUlduarStrategy.cpp\nsrc/Ai/Raid/Ulduar/Strategy/RaidUlduarStrategy.h\nsrc/Ai/Raid/Ulduar/Trigger/RaidUlduarTriggers.cpp\nsrc/Ai/Raid/Ulduar/Trigger/RaidUlduarTriggers.h\nsrc/Ai/Raid/VaultOfArchavon/Action/RaidVoAActions.cpp\nsrc/Ai/Raid/VaultOfArchavon/Action/RaidVoAActions.h\nsrc/Ai/Raid/VaultOfArchavon/RaidVoAActionContext.h\nsrc/Ai/Raid/VaultOfArchavon/RaidVoATriggerContext.h\nsrc/Ai/Raid/VaultOfArchavon/Strategy/RaidVoAStrategy.cpp\nsrc/Ai/Raid/VaultOfArchavon/Strategy/RaidVoAStrategy.h\nsrc/Ai/Raid/VaultOfArchavon/Trigger/RaidVoATriggers.cpp\nsrc/Ai/Raid/VaultOfArchavon/Trigger/RaidVoATriggers.h\n</code></pre> src/Ai/World/ (all files) <pre><code>src/Ai/World/Rpg/Action/NewRpgAction.cpp\nsrc/Ai/World/Rpg/Action/NewRpgAction.h\nsrc/Ai/World/Rpg/Action/NewRpgBaseAction.cpp\nsrc/Ai/World/Rpg/Action/NewRpgBaseAction.h\nsrc/Ai/World/Rpg/NewRpgInfo.cpp\nsrc/Ai/World/Rpg/NewRpgInfo.h\nsrc/Ai/World/Rpg/Strategy/NewRpgStrategy.cpp\nsrc/Ai/World/Rpg/Strategy/NewRpgStrategy.h\nsrc/Ai/World/Rpg/Trigger/NewRpgTrigger.cpp\nsrc/Ai/World/Rpg/Trigger/NewRpgTriggers.h\n</code></pre> <pre><code>flowchart TD\n  A[src/Bot] --&gt; B[PlayerbotAI / Managers]\n  B --&gt; C[src/Ai]\n  B --&gt; D[src/PlayerbotAIConfig.*]\n  B --&gt; E[src/Db]\n  B --&gt; F[src/Mgr]\n  B --&gt; G[src/Script]\n  B --&gt; H[src/Util]\n  C --&gt; C1[Base]\n  C --&gt; C2[Class]\n  C --&gt; C3[Dungeon]\n  C --&gt; C4[Raid]\n  C --&gt; C5[World]\n  B --&gt; B1[Cmd]\n  B --&gt; B2[Debug]\n  B --&gt; B3[Engine]\n  B --&gt; B4[Factory]\n  F --&gt; F1[Guild]\n  F --&gt; F2[Item]\n  F --&gt; F3[Move]\n  F --&gt; F4[Security]\n  F --&gt; F5[Talent]\n  F --&gt; F6[Text]\n  F --&gt; F7[Travel]</code></pre>"},{"location":"module-map-and-glossary/#glossary-initial","title":"Glossary (initial)","text":"<ul> <li>Random bot: Autonomous bot managed by <code>RandomPlayerbotMgr</code> (not tied to a master).</li> <li>Random bot account: An account flagged as RNDbot (account type 1) used to host random bot characters.</li> <li>AddClass account: An account flagged as AddClass (account type 2) used for AddClass bots.</li> <li>Alt bot account: An account used for master-controlled \u201calt\u201d characters, typically tied to a single real player.</li> <li>BotState: The bot AI mode that selects which engine runs (combat, non-combat, or dead).</li> <li>Combat / Non-combat / Dead engine: The three decision engines built for a bot and switched based on <code>BotState</code>.</li> <li>AiFactory: Factory that builds <code>AiObjectContext</code> and the default engines/strategies for a bot.</li> <li>PlayerbotAIConfig: Central configuration class that loads server-side settings for the playerbot system.</li> <li>PlayerbotHolder: Base container that stores and tracks active bot players.</li> <li>PlayerbotFactory: Helper that creates and configures bot characters (gear, talents, inventories, etc.).</li> <li>RandomPlayerbotFactory: Factory dedicated to creating random bot accounts/characters and balancing population.</li> <li>Strategy: A behavior bundle registered into an <code>Engine</code> (e.g., combat or non\u2011combat).</li> <li>Action: A single executable behavior chosen by the <code>Engine</code> (cast, move, loot, etc.).</li> <li>Trigger: A condition that selects which action should run.</li> <li>Value: A data provider used by triggers/actions (cached computation).</li> <li>Engine: The decision dispatcher that runs strategies, evaluates triggers, and executes actions.</li> <li>Context (AiObjectContext): Factory + registry for actions, triggers, values, and strategies.</li> <li>RPG / New RPG: Autonomous \u201croleplay\u201d logic for random bots (wandering, quests, travel, grinding).</li> <li>RPG target: The current world object or position selected for RPG behavior.</li> <li>TravelMgr: Manager that computes travel destinations and routes for bots.</li> <li>Travel target: The current destination used by travel logic (quests, flight paths, RPG locations).</li> <li>LFG: Looking For Group system integration for bot grouping and dungeon participation.</li> <li>BG (Battleground): PvP battleground participation system used by bots.</li> <li>Arena team: Random bot arena team infrastructure used to populate PvP arenas.</li> <li>AutoGear: Automated gear selection/upgrade logic for bot characters.</li> </ul>"},{"location":"module-map-and-glossary/#common-section-format-for-all-later-pages","title":"Common section format (for all later pages)","text":"<p>Use this structure for every component or subsystem page:</p> <ol> <li>Role    What the component does and when it is used.</li> <li>Key APIs / classes    The entry points and main classes/functions.</li> <li>Managed data    State, caches, DB tables, or configuration it owns.</li> <li>Extension points    Where new logic can be added safely.</li> <li>Risks / pitfalls    Common mistakes, performance costs, or side effects.</li> </ol>"},{"location":"roadmap/","title":"TODO Roadmap","text":"<p>This page tracks the remaining phases and expected outputs.</p>"},{"location":"roadmap/#quick-contribution-guide","title":"Quick contribution guide","text":"<p>Deliverable: a \"first patch\" guide.</p> <ol> <li>Where to make a safe small change</li> <li>Where not to modify first</li> <li>How to test locally</li> <li>\"PR-ready\" checklist</li> </ol>"}]}